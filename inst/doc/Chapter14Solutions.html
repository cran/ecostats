<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-06-28" />

<title>Chapter 14 – Multivariate abundances – inference about environmental associations – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 14 – Multivariate abundances –
inference about environmental associations – Exercise solutions and Code
Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-06-28</h4>



<div id="exercise-14.1-revegetation-and-invertebrate-counts" class="section level2">
<h2>Exercise 14.1: Revegetation and invertebrate counts</h2>
<p><em>In Anthony’s revegetation study (Exercise 10.3), he classified
anything that fell into his pitfall traps to Order, and thus counted the
abundance of each of 24 invertebrate Orders across ten sites. He wants
to know: Is there evidence of a change in invertebrate communities due
to revegetation efforts?</em></p>
<p><em>What type of response variable(s) does he have? How should
Anthony analyse his data?</em></p>
<p>He has a multivariate abundance dataset, with 24 correlated counts of
invertebrates in different Orders. He needs to use some GLM approach
that can handle correlation and many responses, like
<code>manyglm</code> from the <code>mvabund</code> package.</p>
</div>
<div id="exercise-14.2-invertebrates-settling-on-seaweed" class="section level2">
<h2>Exercise 14.2: Invertebrates settling on seaweed</h2>
<p><em>In Exercise 1.13, David and Alistair looked at invertebrate
epifauna settling on algal beds (seaweed) with different levels of
isolation (0, 2, or 10 metre buffer) from each other, at two sampling
times (5 and 10 weeks). They observed presence/absence patterns of 16
different types of invertebrate (across 10 replicates). They would like
to know if there is any evidence of a difference in invertebrate
presence/absence patterns with Distance of Isolation.</em></p>
<p><em>How should they analyse the data?</em></p>
<p>They have a multivariate abundance dataset, with 16 correlated
presence/absence measurements of invertebrates. They need to use some
GLM approach that can handle correlation and many responses, like
<code>manyglm</code> from the <code>mvabund</code> package.</p>
</div>
<div id="exercise-14.3-do-offshore-wind-farms-affect-fish-communities" class="section level2">
<h2>Exercise 14.3: Do offshore wind farms affect fish communities?</h2>
<p><em>As in Exercise 10.2, Lena studied the effects of an offshore wind
farm on fish communities, by collecting paired data before and after
wind farm construction, at 36 stations in each of three zones (wind
farm, North, or South). She counted how many fish were caught at each
station, classified into 16 different taxa. Lena wants to know if there
is any evidence of a change in fish communities at wind farm stations,
as compared to others, following construction of the wind farm.</em></p>
<p><em>How should she analyse the data?</em></p>
<p>She has a multivariate abundance dataset, with 16 correlated counts
of different fish species. She needs to use some GLM approach that can
handle correlation and many responses, like <code>manyglm</code> from
the <code>mvabund</code> package.</p>
</div>
<div id="code-box-14.1-using-mvabund-to-test-for-an-effect-of-revegetation-in-exercise-12.2" class="section level2">
<h2>Code Box 14.1: Using mvabund to test for an effect of revegetation
in Exercise 12.2</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(reveg)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>reveg<span class="sc">$</span>abundMV<span class="ot">=</span><span class="fu">mvabund</span>(reveg<span class="sc">$</span>abund)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>ft_reveg<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">data=</span>reveg) <span class="co"># offset included as in Exercise 10.9</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_reveg)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 6 sec</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: abundMV ~ treatment + offset(log(pitfalls))</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                         </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 78.25    0.025 *</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="exercise-14.4-testing-for-an-effect-of-isolation-on-invertebrates-in-seaweed" class="section level2">
<h2>Exercise 14.4: Testing for an effect of isolation on invertebrates
in seaweed</h2>
<p><em>Consider the <code>seaweed</code> dataset from David’s and
Alistair’s study of invertebrate epifauna settling on algal beds with
different levels of isolation (0, 2 or 10 metre buffer) at different
sampling times (5 and 10 weeks), with varying seaweed biomass in each
patch.</em></p>
<p><em>What sort of model is appropriate for this dataset? Fit this
model and call it <code>ft_epiAlt</code> and run
<code>anova(ft_epiAlt)</code>. (This might take a couple of minutes to
run.)</em></p>
<p>Previous experience suggests anything beyond second-order
interactions does not seem to matter – you could fit more but it would
take longer. Because of the warning that this will take a long time to
run I will set <code>nBoot=99</code> for a quicker, rough answer:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(seaweed)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>Dist <span class="ot">=</span> <span class="fu">as.factor</span>(seaweed<span class="sc">$</span>Dist)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set up presence-absence response:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>PA <span class="ot">=</span> <span class="fu">mvabund</span>(seaweed[,<span class="dv">6</span><span class="sc">:</span><span class="dv">21</span>])</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>PA[seaweed<span class="sc">$</span>PA<span class="sc">&gt;</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ft_epiAlt <span class="ot">=</span> <span class="fu">manyglm</span>(PA<span class="sc">~</span>(Wmass<span class="sc">+</span>Size<span class="sc">+</span>Time)<span class="sc">*</span>Dist,<span class="at">family=</span><span class="st">&quot;cloglog&quot;</span>, <span class="at">data=</span>seaweed)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_epiAlt,<span class="at">nBoot=</span><span class="dv">99</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 13 sec</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: PA ~ (Wmass + Size + Time) * Dist</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)   </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     56                          </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Wmass           55       1  6.66     0.91   </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Size            54       1 36.98     0.01 **</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time            53       1 32.35     0.02 * </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dist            51       2 28.26     0.73   </span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Wmass:Dist      49       2 33.29     0.19   </span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Size:Dist       47       2 26.77     0.05 * </span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Dist       45       2 32.56     0.08 . </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 99 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>Now fit a model under the null hypothesis that there is no effect
of Distance of isolation, and call it <code>ft_epiNull</code>. Run
<code>anova(ft_epiNull, ft_epiAlt)</code>. This second anova took much
less time to fit – why? Is there evidence of an effect of distance of
isolation on presence/absence patterns in the invertebrate
community?</em></p>
<p>To see if there is an effect of <code>Dist</code> I guess we could
remove it from the model entirely and see if that does anything:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ft_epiNull <span class="ot">=</span> <span class="fu">manyglm</span>(PA<span class="sc">~</span>Wmass<span class="sc">+</span>Size<span class="sc">+</span>Time,<span class="at">family=</span><span class="st">&quot;cloglog&quot;</span>, <span class="at">data=</span>seaweed)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_epiNull, ft_epiAlt, <span class="at">nBoot=</span><span class="dv">99</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 2 sec</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_epiNull: PA ~ Wmass + Size + Time</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_epiAlt: PA ~ (Wmass + Size + Time) * Dist</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Res.Df Df.diff   Dev Pr(&gt;Dev)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_epiNull     53                       </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_epiAlt      45       8 115.2     0.47</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 99 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>This second <code>anova</code> took much less time to fit –
why?</em></p>
<p>Because it only has to test one hypothesis, not seven, so took about
a seventh of the time!</p>
<p><em>Is there evidence of an effect of distance of isolation on
presence/absence patterns in the invertebrate community?</em></p>
<p>No :(</p>
</div>
<div id="code-box-14.2-checking-assumptions-for-the-revegetation-model-of-code-box-14.1" class="section level2">
<h2>Code Box 14.2: Checking assumptions for the revegetation model of
Code Box 14.1</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ft_reveg<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment,<span class="at">offset=</span><span class="fu">log</span>(pitfalls),<span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_reveg, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>What do you reckon?</em></p>
<p>Assumptions seem reasonable here.</p>
</div>
<div id="code-box-14.3-checking-mean-variance-assumptions-for-a-poisson-revegetation-model" class="section level2">
<h2>Code Box 14.3: Checking mean-variance assumptions for a Poisson
revegetation model</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ft_revegP<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment, <span class="at">offset=</span><span class="fu">log</span>(pitfalls), <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_revegP, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sim.method=</span><span class="st">&quot;stand.norm&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">meanvar.plot</span>(reveg<span class="sc">$</span>abundMV<span class="sc">~</span>reveg<span class="sc">$</span>treatment)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; START SECTION 2 </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plotting if overlay is TRUE</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable reveg$treatment 7 mean values were 0 and could </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      not be included in the log-plot</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable reveg$treatment 10 variance values were 0 and could not </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      be included in the log-plot</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FINISHED SECTION 2</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk code14.3MV</p>
</div>
<p><em>How’s the Poisson assumption looking?</em></p>
<p>It is in all sorts of trouble, there is a very strong fan-shape on
the residuals vs fits plot, points drift well outside the simulation
envelope on the nromal quantile plot (with many residuals larger than 5
or less than -5) and a strong increasing trend on the residual vs fits
plot. These are all symptomatic of overdispersion, confirmed by the
sample mean-variance plot, where points tend to fall above the
one-to-one line at large means.</p>
</div>
<div id="exercise-14.5-checking-assumptions-for-the-habitat-configuration-data" class="section level2">
<h2>Exercise 14.5: Checking assumptions for the habitat configuration
data</h2>
<p><em>What assumptions were made?</em></p>
<p>We assumed:</p>
<ul>
<li>observations are conditionally independent</li>
<li>data are Bernoulli</li>
<li>the cloglog of the mean is a linear function of predictors</li>
<li>residuals have constant correlation</li>
</ul>
<p><em>Where possible, check these assumptions.</em></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ft_epiAlt <span class="ot">=</span> <span class="fu">manyglm</span>(PA<span class="sc">~</span>(Wmass<span class="sc">+</span>Size<span class="sc">+</span>Time)<span class="sc">*</span>Dist,<span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;cloglog&quot;</span>), <span class="at">data=</span>seaweed)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_epiAlt, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>Do assumptions seem reasonable?</em></p>
<p>Yes it all looks good to me. This is not unexpected because
presence-absence data are by definition Bernoulli, the only potential
issues could be if there were higher order interactions or violations of
te independence assumption.</p>
</div>
<div id="exercise-14.6-checking-assumptions-for-the-wind-farm-data" class="section level2">
<h2>Exercise 14.6: Checking assumptions for the wind farm data</h2>
<p><em>Consider Lena’s offshore wind farm study (Exercise 14.3). Fit an
appropriate model to the data. Make sure you include a Station main
effect (to account for the paired sampling design).</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(windFarms)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ft_wind<span class="ot">=</span><span class="fu">manyglm</span>(<span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund)<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span></code></pre></div>
<p><em>What assumptions were made?</em></p>
<p>We assumed:</p>
<ul>
<li>observations are conditionally independent</li>
<li>data are Poisson</li>
<li>the log of the mean is a linear function of predictors</li>
<li>residuals have constant correlation</li>
</ul>
<p><em>Where possible, check these assumptions.</em></p>
<p>Used “stand.norm” because this model takes a while to fit.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_wind, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sim.method=</span><span class="st">&quot;stand.norm&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>Do assumptions seem reasonable? In particular, think about
whether there is evidence that the counts are overdispersed compared to
the Poisson.</em></p>
<p>Things generally look OK, but there is a downward trend on the
scale-location plot, weakly suggestive of under-dispersion. Note the sim
envelope was constructed using <code>&quot;stand.norm&quot;</code>, meaning we
compared the smoother to what would be expected for a bunch of standard
normal residuals. But the kink could be a weird artifact of the model
being fitted (which has loads of parameters) so let’s repeat using
<code>&quot;refit&quot;</code>, but with a smaller value of <code>n.sim</code> so
it doesn’t take too long (it will take a few minutes though):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_wind, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">59</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error : inner loop 1; cannot correct step size</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error : inner loop 1; cannot correct step size</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p>(You can ignore any error messages - these seem to happen because
predicted values were numerically zero.)</p>
<p>Anyway, the downward trend in the scale-location plot happened in
simulated data too, so it is nothing really to worry about. It seems to
be an artifact, probably because of overfitting of the data by including
a <code>Station</code> term in the model – this means that there is a
parameter for every two observations in the data! (If a random effect
were used instead, this effect would have been weaker. But it isn’t
really a problem.)</p>
</div>
<div id="code-box-14.4-a-manyglm-analysis-of-the-revegetation-data-using-a-statistic-accounting-for-correlation" class="section level2">
<h2>Code Box 14.4: A manyglm analysis of the revegetation data, using a
statistic accounting for correlation</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_reveg,<span class="at">test=</span><span class="st">&quot;wald&quot;</span>,<span class="at">cor.type=</span><span class="st">&quot;shrink&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 4 sec</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: abundMV ~ treatment</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff  wald Pr(&gt;wald)  </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                          </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 8.698     0.048 *</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming correlated response via ridge regularization </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="exercise-14.7-testing-for-an-effect-of-offshore-wind-farms-slowly" class="section level2">
<h2>Exercise 14.7: Testing for an effect of offshore wind farms
(slowly)</h2>
<p><em>Fit models [to Lena’s windfarm data] under the null and
alternative hypotheses of interest. Run an anova to compare these two
models, with just 19 bootstrap resamples, to estimate computation
time.</em></p>
<p>The null model in this case has no <code>Year:Zone</code> term… there
could still be year-to-year variation, but it should not affect
different Zones in different ways.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>windMV <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ft_wind<span class="ot">=</span><span class="fu">manyglm</span>(windMV<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ft_windNull<span class="ot">=</span><span class="fu">manyglm</span>(windMV<span class="sc">~</span>Station<span class="sc">+</span>Year, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_windNull, ft_wind, <span class="at">nBoot=</span><span class="dv">19</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 12 sec</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull: windMV ~ Station + Year</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind: windMV ~ Station + Year + Year:Zone</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull     70                         </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind         68       2 81.83     0.05 *</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 19 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p>This took 12 seconds for me.</p>
<p><em>Remove zerotons and singletons from the dataset using:
<code>windMV = mvabund( windFarms$abund[,colSums(windFarms$abund&gt;0)&gt;1] )</code>
Now fit a model to this new response variable, again with just 19
bootstrap resamples.</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>windMV1 <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund[,<span class="fu">colSums</span>(windFarms<span class="sc">$</span>abund<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">&gt;</span><span class="dv">1</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ft_wind1<span class="ot">=</span><span class="fu">manyglm</span>(windMV1<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ft_windNull1<span class="ot">=</span><span class="fu">manyglm</span>(windMV1<span class="sc">~</span>Station<span class="sc">+</span>Year, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_windNull1, ft_wind1, <span class="at">nBoot=</span><span class="dv">19</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 10 sec</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull1: windMV1 ~ Station + Year</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind1: windMV1 ~ Station + Year + Year:Zone</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull1     70                         </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind1         68       2 81.83     0.05 *</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 19 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>Did this run take less time?</em> Yes, but not much less, it took
10 seconds for me.</p>
<p><em>How do results compare?</em> Results were almost identical, with
the same test statistic (to two decimal places).</p>
<p><em>How long do you think it would take to fit a model with 999
bootstrap resamples, for an accurate 𝑃-value?</em></p>
<p>As a rough estimate, multiply the time you just got by 50. For me
this is about 500 seconds, so I would expect it to take about eight
minutes.</p>
<p>It is curious that this didn’t change computation time all that much.
Looking at number of non-zero values in <code>windMV</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(windFarms<span class="sc">$</span>abund<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Bergvar         Oxsimpa         Piggvar      Roodspotta       Rootsimpa     Sandskaadda </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               0              51               1               3              30               5 </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Sjurygg   Skrubbskaadda     Skaaggsimpa    Skaarsnultra     Stensnultra Svart.smoorbult </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               6              22               6               4              37               3 </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Torsk        Tanglake     Aakta.tunga              AL </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             134             136               0              61</span></span></code></pre></div>
<p>we see that only three of the 16 species had one or less presence. A
couple more had three counts, removing these as well:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>windMV3 <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund[,<span class="fu">colSums</span>(windFarms<span class="sc">$</span>abund<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">&gt;</span><span class="dv">3</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ft_wind3<span class="ot">=</span><span class="fu">manyglm</span>(windMV3<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ft_windNull3<span class="ot">=</span><span class="fu">manyglm</span>(windMV3<span class="sc">~</span>Station<span class="sc">+</span>Year, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_windNull3, ft_wind3, <span class="at">nBoot=</span><span class="dv">19</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 8 sec</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull3: windMV3 ~ Station + Year</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind3: windMV3 ~ Station + Year + Year:Zone</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_windNull3     70                         </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wind3         68       2 74.19     0.05 *</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 19 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p>This is only slightly quicker, which is a tad surprising. The test
statistic is only slightly smaller, so we can see clearly that the
action is happening for the more abundant species – this is not
surprising, there is not enough information in any of the rare species
to detect an interaction!</p>
</div>
<div id="code-box-14.5-analysing-ordinal-data-from-the-habitat-configuration-study-using-manyany" class="section level2">
<h2>Code Box 14.5: Analysing ordinal data from the habitat configuration
study using manyany</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>habOrd <span class="ot">=</span> counts <span class="ot">=</span> <span class="fu">as.matrix</span>( <span class="fu">round</span>(seaweed[,<span class="dv">6</span><span class="sc">:</span><span class="dv">21</span>]<span class="sc">*</span>seaweed<span class="sc">$</span>Wmass))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> habOrd[counts<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> counts<span class="sc">&lt;</span><span class="dv">10</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>habOrd[counts<span class="sc">&gt;=</span><span class="dv">10</span>] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;ordinal&#39;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:VGAM&#39;:</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     dgumbel, dlgamma, pgumbel, plgamma, qgumbel, rgumbel, wine</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:glmmTMB&#39;:</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ranef, VarCorr</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:nlme&#39;:</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ranef, VarCorr</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:lme4&#39;:</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ranef, VarCorr</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(habOrd) <span class="co"># Amphipods are all &quot;2&quot; which would return an error in clm</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Amph        Cope            Poly            Anem             Iso            Bival      </span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :2   Min.   :0.000   Min.   :0.000   Min.   :0.0000   Min.   :0.000   Min.   :0.000  </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:2   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:0.0000   1st Qu.:2.000   1st Qu.:0.000  </span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :2   Median :2.000   Median :2.000   Median :0.0000   Median :2.000   Median :2.000  </span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :2   Mean   :1.895   Mean   :1.772   Mean   :0.2456   Mean   :1.877   Mean   :1.351  </span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:0.0000   3rd Qu.:2.000   3rd Qu.:2.000  </span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :2   Max.   :2.000   Max.   :2.000   Max.   :2.0000   Max.   :2.000   Max.   :2.000  </span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Gast            Turb             Prawn            Urchin             Fish       </span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :1.000   Min.   :0.00000   Min.   :0.0000   Min.   :0.00000   Min.   :0.0000  </span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:2.000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.0000  </span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :2.000   Median :0.00000   Median :0.0000   Median :0.00000   Median :0.0000  </span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.947   Mean   :0.08772   Mean   :0.5263   Mean   :0.07018   Mean   :0.1754  </span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2.000   3rd Qu.:0.00000   3rd Qu.:2.0000   3rd Qu.:0.00000   3rd Qu.:0.0000  </span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :2.000   Max.   :2.00000   Max.   :2.0000   Max.   :2.00000   Max.   :2.0000  </span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Crab            Caddis             Opi              Ost            Bstar       </span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.0000   Min.   :0.00000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  </span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000  </span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :0.0000   Median :0.00000   Median :0.0000   Median :2.000   Median :0.0000  </span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :0.5965   Mean   :0.03509   Mean   :0.1404   Mean   :1.404   Mean   :0.2105  </span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2.0000   3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:2.000   3rd Qu.:0.0000  </span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :2.0000   Max.   :2.00000   Max.   :2.0000   Max.   :2.000   Max.   :2.0000</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>habOrd<span class="ot">=</span>habOrd[,<span class="sc">-</span><span class="dv">1</span>] <span class="co">#remove Amphipods</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>manyOrd<span class="ot">=</span><span class="fu">manyany</span>(habOrd<span class="sc">~</span>Dist<span class="sc">*</span>Time<span class="sc">*</span>Size,<span class="st">&quot;clm&quot;</span>,<span class="at">data=</span>seaweed)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>manyOrdNull<span class="ot">=</span><span class="fu">manyany</span>(habOrd<span class="sc">~</span>Time<span class="sc">*</span>Size,<span class="st">&quot;clm&quot;</span>,<span class="at">data=</span>seaweed)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(manyOrdNull, manyOrd)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              LR Pr(&gt;LR)  </span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sum-of-LR 101.1    0.05 *</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><em>What hypothesis has been tested here? Is there any evidence
against it?</em></p>
<p>We tested for an effect of distance on abundance, when classified
into a three-level ordinal factor. There is no evidence of a
<code>Dist</code> effect.</p>
<p>The <code>ordinal</code> package has a bug in it (in version 2019.12)
so it conflicts with <code>lme4</code> (specifically it overwrites the
<code>ranef</code> function), [issue posted on Github] (<a href="https://github.com/runehaubo/ordinal/issues/48" class="uri">https://github.com/runehaubo/ordinal/issues/48</a>). So if
you are running analyses using both packages, you need to <em>detach the
<code>ordinal</code> package</em> before continuing…</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:ordinal&quot;</span>, <span class="at">unload=</span><span class="cn">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: &#39;ordinal&#39; namespace cannot be unloaded:</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   namespace &#39;ordinal&#39; is imported by &#39;ecoCopula&#39; so cannot be unloaded</span></span></code></pre></div>
</div>
<div id="code-box-14.6-a-compositional-analysis-of-anthonys-revegetation" class="section level2">
<h2>Code Box 14.6: A compositional analysis of Anthony’s
revegetation</h2>
<p>data</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ft_comp<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)), <span class="at">data=</span>reveg, <span class="at">composition=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_comp,<span class="at">nBoot=</span><span class="dv">99</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 18 sec</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: abundMV ~ cols + treatment + offset(log(pitfalls)) + rows + cols:(treatment + offset(log(pitfalls)))</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Res.Df Df.diff   Dev Pr(&gt;Dev)   </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       239                          </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cols              216      23 361.2     0.01 **</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment         215       1  14.1     0.01 **</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rows              206       9  25.5     0.03 * </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cols:treatment    184      23  56.7     0.01 **</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 99 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>Which term measures the effect of treatment on relative
abundance? Is there evidence of an effect on relative
abundance?</em></p>
<p><code>cols:treatment</code>. There is evidence of an effect of
relative abundance.</p>
</div>
<div id="code-box-14.7-a-faster-compositional-analysis-of-anthonys-revegetation-data" class="section level2">
<h2>Code Box 14.7: A faster compositional analysis of Anthony’s
revegetation data</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ft_null <span class="ot">=</span> <span class="fu">manyglm</span>(abundMV<span class="sc">~</span>cols<span class="sc">+</span>rows<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span>ft_comp<span class="sc">$</span>data)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ft_alt <span class="ot">=</span> <span class="fu">manyglm</span>(abundMV<span class="sc">~</span>cols<span class="sc">+</span>rows<span class="sc">+</span>treatment<span class="sc">:</span>cols</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)), <span class="at">data=</span>ft_comp<span class="sc">$</span>data)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_null,ft_alt,<span class="at">nBoot=</span><span class="dv">99</span>,<span class="at">block=</span>ft_comp<span class="sc">$</span>rows)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 5 sec</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_null: abundMV ~ cols + rows + offset(log(pitfalls))</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_alt: abundMV ~ cols + rows + treatment:cols + offset(log(pitfalls))</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Res.Df Df.diff   Dev Pr(&gt;Dev)   </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_null    207                          </span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_alt     184      23 56.74     0.01 **</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 99 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="code-box-14.8-quick-and-dirty-compositional-analysis-of-anthonys-revegetation-data" class="section level2">
<h2>Code Box 14.8: Quick-and-dirty compositional analysis of Anthony’s
revegetation data</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ft_reveg0 <span class="ot">=</span> <span class="fu">manyglm</span>(abundMV<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)), <span class="at">data=</span>reveg)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>QDrows0 <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">rowSums</span>(reveg<span class="sc">$</span>abundMV)) <span class="sc">-</span> <span class="fu">log</span>( <span class="fu">rowSums</span>(<span class="fu">fitted</span>(ft_reveg0)) )</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ft_row0<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls))<span class="sc">+</span><span class="fu">offset</span>(QDrows0), <span class="at">data=</span>reveg)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ft_reveg <span class="ot">=</span> <span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)), <span class="at">data=</span>reveg)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>QDrows <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">rowSums</span>(reveg<span class="sc">$</span>abundMV)) <span class="sc">-</span> <span class="fu">log</span>( <span class="fu">rowSums</span>(<span class="fu">fitted</span>(ft_reveg)) )</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ft_row<span class="ot">=</span><span class="fu">manyglm</span>(abundMV<span class="sc">~</span>treatment<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls))<span class="sc">+</span><span class="fu">offset</span>(QDrows), <span class="at">data=</span>reveg)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_row0,ft_row)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 8 sec</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_row0: abundMV ~ 1 + offset(log(pitfalls)) + offset(QDrows0)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_row: abundMV ~ treatment + offset(log(pitfalls)) + offset(QDrows)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_row0      9                         </span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_row       8       1 50.26    0.077 .</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>This was over ten times quicker than Code Box 14.7 (note that it
used ten times as many resamples), but results are slightly different –
the test statistic is slightly smaller, and the <span class="math inline">\(P\)</span>-value larger. Why do you think this
might be the case?</em></p>
<p>The quick-and-dirty offset approach only roughly approximates the row
effect, so it would be expected to lose some efficiency (leading to a
smaller test statistic and a larger <span class="math inline">\(P\)</span>-value).</p>
</div>
<div id="code-box-14.9-posthoc-testing-for-the-bush-regeneration-data" class="section level2">
<h2>Code Box 14.9: Posthoc testing for the bush regeneration data</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>an_reveg <span class="ot">=</span> <span class="fu">anova</span>(ft_reveg,<span class="at">p.uni=</span><span class="st">&quot;adjusted&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 6 sec</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>an_reveg</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: abundMV ~ treatment + offset(log(pitfalls))</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                         </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 78.25    0.024 *</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Univariate Tests:</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Acarina          Amphipoda          Araneae          Blattodea          Coleoptera</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Dev Pr(&gt;Dev)       Dev Pr(&gt;Dev)     Dev Pr(&gt;Dev)       Dev Pr(&gt;Dev)        Dev</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                   </span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment     8.538    0.190     9.363    0.157   0.493    0.980    10.679    0.113      9.741</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Collembola          Dermaptera          Diotocardia          Diplura         </span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Pr(&gt;Dev)        Dev Pr(&gt;Dev)        Dev Pr(&gt;Dev)         Dev Pr(&gt;Dev)     Dev Pr(&gt;Dev)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                       </span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment      0.137      6.786    0.295      0.196    0.980           0    0.980    2.24    0.851</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Diptera          Formicidae          Haplotaxida          Hemiptera         </span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Dev Pr(&gt;Dev)        Dev Pr(&gt;Dev)         Dev Pr(&gt;Dev)       Dev Pr(&gt;Dev)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                             </span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment      5.93    0.365      0.831    0.980       2.889    0.765     1.302    0.967</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Hymenoptera          Isopoda          Larvae          Lepidoptera          Polydesmida</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dev Pr(&gt;Dev)     Dev Pr(&gt;Dev)    Dev Pr(&gt;Dev)         Dev Pr(&gt;Dev)         Dev</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                       </span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment         4.254    0.554   1.096    0.980  0.463    0.980       0.913    0.980       1.451</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Pseudoscorpionida          Scolopendrida          Seolifera         </span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Pr(&gt;Dev)               Dev Pr(&gt;Dev)           Dev Pr(&gt;Dev)       Dev Pr(&gt;Dev)</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                              </span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment      0.961             1.056    0.980         0.913    0.980      1.03    0.980</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Soleolifera          Thysanoptera          Tricladida         </span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dev Pr(&gt;Dev)          Dev Pr(&gt;Dev)        Dev Pr(&gt;Dev)</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                               </span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment         4.223    0.554        1.056    0.980      2.804    0.766</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="code-box-14.10-exploring-indicator-taxa-most-strongly-associated-with-the-treatment-effect-in-anthonys-revegetation-data" class="section level2">
<h2>Code Box 14.10: Exploring indicator taxa most strongly associated
with the treatment effect in Anthony’s revegetation data</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sortedRevegStats <span class="ot">=</span> <span class="fu">sort</span>(an_reveg<span class="sc">$</span>uni.test[<span class="dv">2</span>,],<span class="at">decreasing=</span>T,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="at">index.return=</span>T)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sortedRevegStats<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Blattodea Coleoptera  Amphipoda    Acarina Collembola </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  10.679374   9.741038   9.362519   8.537903   6.785946</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sortedRevegStats<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])<span class="sc">/</span>an_reveg<span class="sc">$</span>table[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5764636</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(ft_reveg)[,sortedRevegStats<span class="sc">$</span>ix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Blattodea Coleoptera Amphipoda  Acarina Collembola</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     -0.3566749  -1.609438 -16.42495 1.064711   5.056246</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentImpact -3.3068867   5.009950  19.42990 2.518570   2.045361</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>ft_reveg<span class="sc">$</span>stderr[,sortedRevegStats<span class="sc">$</span>ix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Blattodea Coleoptera Amphipoda   Acarina Collembola</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     0.3779645   1.004969  707.1068 0.5171539  0.4879159</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentImpact 1.0690450   1.066918  707.1069 0.5713194  0.5453801</span></span></code></pre></div>
</div>
<div id="exercise-14.8-indicator-species-for-offshore-wind-farms" class="section level2">
<h2>Exercise 14.8: Indicator species for offshore wind farms?</h2>
<p><em>Which fish species are most strongly associated with offshore
wind farms, in Lena’s study? Reanalyse the data to obtain univariate
test statistics and univariate <span class="math inline">\(P\)</span>-values that have been adjusted for
multiple testing.</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(windFarms)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>windMV1 <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund[,<span class="fu">colSums</span>(windFarms<span class="sc">$</span>abund<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">&gt;</span><span class="dv">1</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ft_wind1<span class="ot">=</span><span class="fu">manyglm</span>(windMV1<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>an_wind1 <span class="ot">=</span> <span class="fu">anova</span>(ft_wind1,<span class="at">p.uni=</span><span class="st">&quot;adjusted&quot;</span>,<span class="at">nBoot=</span><span class="dv">99</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 51 min 49 sec</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>sortedWindStats <span class="ot">=</span> <span class="fu">sort</span>(an_wind1<span class="sc">$</span>uni.test[<span class="dv">4</span>,], <span class="at">decreasing=</span>T, <span class="at">index.return=</span>T)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sortedWindStats<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Tanglake     Torsk   Oxsimpa Rootsimpa        AL </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29.019951 22.296044  6.899955  6.801339  4.819447</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>an_wind1<span class="sc">$</span>uni.p[<span class="dv">4</span>,sortedWindStats<span class="sc">$</span>ix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Tanglake     Torsk   Oxsimpa Rootsimpa        AL </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.01      0.01      0.04      0.04      0.17</span></span></code></pre></div>
<p><em>Is there evidence that any species clearly have a Zone:Year
interaction, after adjusting for multiple testing?</em></p>
<p>Yes it looks like we have evidence of an effect in
<code>Tanglake</code> (Viviparous Eelpout) and <code>Torsk</code>
(cod).</p>
<p><em>What proportion of the total <code>Zone:Year</code> effect is
attributable to these potential indicator species?</em></p>
<p><em>(These code chunk has not been run as it is reliant on the
previous code chunk.)</em></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sortedWindStats<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">/</span>an_wind1<span class="sc">$</span>table[<span class="dv">4</span>,<span class="dv">3</span>]</span></code></pre></div>
<p>So 63% of the <code>Zone:Year</code> effect is just these two
species.</p>
<p><em>Plot the abundance of each potential indicator species against
Zone and Year.</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(windMV1<span class="sc">~</span><span class="fu">interaction</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Zone,windFarms<span class="sc">$</span>X<span class="sc">$</span>Year),<span class="at">var.subset=</span>sortedWindStats<span class="sc">$</span>ix[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<p><em>What is the nature of the wind farm effect for each species? Do
you think these species are good indicators of an effect of wind
farms?</em></p>
<p>It is hard to say. I guess there has been a big increase in Ellpout
in 2010, perhaps more so in wind farms than in North Zone. Cod numbers
seemed to increase in 2010 for South Zone and not wind farms.
Interaction plots might be a better way to see this…</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
