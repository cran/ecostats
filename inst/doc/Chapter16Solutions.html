<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-08-24" />

<title>Chapter 16 – Understanding variation in environmental response across taxa – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 16 – Understanding variation in
environmental response across taxa – Exercise solutions and Code
Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-08-24</h4>



<div id="exercise-16.1-understanding-how-spiders-vary-in-environmental-response" class="section level2">
<h2>Exercise 16.1: Understanding how spiders vary in environmental
response</h2>
<p><em>Consider again Petrus’s hunting spider data of Exercise 15.2. He
established (e.g. in Code Box 15.7) that different species respond
differently to environmental gradients, especially so for soil dryness,
herb layer and reflectance. He would like to know what the main types of
environmental response were, across species.</em></p>
<p><em>What approach should he use to answer this question?</em></p>
<p>He wants to understand <em>how</em> taxa vary in environmental
response, so he could use a Species Archetype Model to classify species
according to type of environmental response.</p>
</div>
<div id="code-box-16.1-fitting-a-species-archetype-model-to-petruss-spider-data" class="section level2">
<h2>Code Box 16.1: Fitting a Species Archetype Model to Petrus’s spider
data</h2>
<p>Run the below lines to install <code>ecomix</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;skiptoniam/ecomix&quot;</span>)</span></code></pre></div>
<p>Code to fit <code>ecomix</code> will only be run if it is installed
(the if statement is included because CRAN policies require vignettes to
be able to be run only using packages that can be installed from
CRAN)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>is_ecomix_installed <span class="ot">=</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;ecomix&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">data</span>(spider)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>SpiderDF<span class="ot">=</span>spider<span class="sc">$</span>x</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>SpiderDF<span class="sc">$</span>abund<span class="ot">=</span><span class="fu">as.matrix</span>(spider<span class="sc">$</span>abund)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>spiderFormula <span class="ot">=</span> abund <span class="sc">~</span> soil.dry <span class="sc">+</span> bare.sand <span class="sc">+</span> fallen.leaves <span class="sc">+</span> moss <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>herb.layer <span class="sc">+</span> reflection</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="cf">if</span>(is_ecomix_installed)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>{</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  ft_Mix <span class="ot">=</span> ecomix<span class="sc">::</span><span class="fu">species_mix</span>(spiderFormula, <span class="at">data=</span>SpiderDF, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">nArchetypes=</span><span class="dv">2</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">init_method=</span><span class="st">&#39;kmeans&#39;</span>,<span class="at">ecm_refit=</span><span class="dv">5</span>, <span class="at">ecm_steps=</span><span class="dv">2</span>) )</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="fu">coef</span>(ft_Mix)<span class="sc">$</span>beta</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; SAM modelling</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; There are 2 archetypes to group the species into</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; There are 28 site observations for 12 species</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; The model for the archetype (grouping) is ~soil.dry + bare.sand + fallen.leaves + moss + herb.layer + reflection</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; The model for the species is ~1</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; You are implementing a negative.binomial Species Archetype Model.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; Using ECM algorithm to find starting values; using 5 refits</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; ECM restart 1 of 5</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -1041.731 | Ratio loglik 0</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -834.997 | Ratio loglik 0.801548</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; ECM restart 2 of 5</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -1041.731 | Ratio loglik 0</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -834.997 | Ratio loglik 0.801548</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; ECM restart 3 of 5</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -1041.731 | Ratio loglik 0</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -834.997 | Ratio loglik 0.801548</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt; ECM restart 4 of 5</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -1041.731 | Ratio loglik 0</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -834.997 | Ratio loglik 0.801548</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="co">#&gt; ECM restart 5 of 5</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -1041.731 | Ratio loglik 0</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -834.997 | Ratio loglik 0.801548</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co">#&gt; initial  value 834.997322 </span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co">#&gt; iter  10 value 822.933991</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="co">#&gt; iter  20 value 818.054221</span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co">#&gt; iter  30 value 816.602567</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="co">#&gt; iter  40 value 812.844421</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="co">#&gt; iter  50 value 793.214165</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co">#&gt; iter  60 value 791.057454</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="co">#&gt; iter  70 value 786.683339</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="co">#&gt; iter  80 value 778.413169</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="co">#&gt; iter  90 value 777.956005</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="co">#&gt; final  value 777.933344 </span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a><span class="co">#&gt;              soil.dry   bare.sand fallen.leaves       moss herb.layer reflection</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#&gt; Archetype1  1.5629184 -0.05470042    -0.2784744 -0.1449658  0.7081518 -0.4730736</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="co">#&gt; Archetype2 -0.1069941  0.22420728    -0.2855582  0.4186874  0.5894873  0.4759734</span></span></code></pre></div>
<p><em>Which predictors vary the most across archetypes (hence across
taxa)? Is this what you saw in Code Box 15.7?</em></p>
<p><code>soil.dry</code> had the biggest change, jumping from
<code>2.15</code> to <code>0.10</code>. The next biggest changes were in
<code>herb.layer</code> and <code>reflection</code>. This is pretty much
what was happening in Code Box 15.7 as well.</p>
</div>
<div id="code-box-16.2-minding-your-ps-and-qs-for-petruss-species-archetype-model" class="section level2">
<h2>Code Box 16.2: Minding your P’s and Q’s for Petrus’s Species
Archetype Model</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span>(is_ecomix_installed)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">plot</span>(ft_Mix, <span class="at">type=</span><span class="st">&quot;link&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Infinite residuals removed from residual plots: 82 in total.</span></span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk code16.2" />
<div class="figcaption">plot of chunk code16.2</div>
</div>
<p><em>Do model assumptions seem reasonable here?</em></p>
<p>This generally looks good, no fan-shape in residual vs fits plot,
points close(ish) to a straight line on normal quanitle plot.</p>
</div>
<div id="exercise-16.2-archetypal-revegetation-response" class="section level2">
<h2>Exercise 16.2: Archetypal revegetation response</h2>
<p><em>Consider again Anthony’s revegetation study. We would like to
better characterise how different invertebrate orders respond to the
revegetation treatment. Fit a Species Archetype Model with two
archetypes.</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(reveg)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>revegDF<span class="ot">=</span><span class="fu">data.frame</span>(reveg)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>revegDF<span class="sc">$</span>abundMat<span class="ot">=</span><span class="fu">as.matrix</span>(reveg<span class="sc">$</span>abund)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="cf">if</span>(is_ecomix_installed)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>{</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  ft_revegMix <span class="ot">=</span> ecomix<span class="sc">::</span><span class="fu">species_mix</span>(abundMat<span class="sc">~</span>treatment, <span class="at">data=</span>revegDF, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">nArchetypes=</span><span class="dv">2</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">init_method=</span><span class="st">&#39;kmeans&#39;</span>,<span class="at">ecm_refit=</span><span class="dv">5</span>, <span class="at">ecm_steps=</span><span class="dv">2</span>) )</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">coef</span>(ft_revegMix)<span class="sc">$</span>beta</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>}</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; SAM modelling</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; There are 2 archetypes to group the species into</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; There are 10 site observations for 24 species</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; The model for the archetype (grouping) is ~treatment</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; The model for the species is ~1</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; You are implementing a negative.binomial Species Archetype Model.</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Using ECM algorithm to find starting values; using 5 refits</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; ECM restart 1 of 5</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -932.547 | Ratio loglik 0</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -745.016 | Ratio loglik 0.798905</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; ECM restart 2 of 5</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -932.547 | Ratio loglik 0</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -745.016 | Ratio loglik 0.798905</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; ECM restart 3 of 5</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -932.547 | Ratio loglik 0</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -745.016 | Ratio loglik 0.798905</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; ECM restart 4 of 5</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -932.547 | Ratio loglik 0</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -745.016 | Ratio loglik 0.798905</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt; ECM restart 5 of 5</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; Initialising starting values</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt; Initial groups parameter estimates by K-means clustering</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; Iteration: 1 | New loglik -932.547 | Ratio loglik 0</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt; Iteration: 2 | New loglik -745.016 | Ratio loglik 0.798905</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; initial  value 745.015688 </span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co">#&gt; final  value 745.015688 </span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="co">#&gt;            treatmentImpact</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co">#&gt; Archetype1        5.350399</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="co">#&gt; Archetype2        1.441362</span></span></code></pre></div>
<p><em>Explain what the main two types of response to revegetation were,
across invertebrate taxa.</em></p>
<p>Oh that’s odd – the estimated trend is almost identical for these two
groups.</p>
<p><em>Look at the posterior probabilities for each Order, identify a
few taxa that characterise each response type, and plot the raw data for
these taxa. Does the Species Archetype Model seem to capture the main
trends in response to revegetation treatment?</em></p>
<p>This doesn’t seem worthwhile when there are no differences in
response across these archetypes!!</p>
</div>
<div id="code-box-16.3-choosing-the-number-of-archetypes-for-petruss-spider-data" class="section level2">
<h2>Code Box 16.3: Choosing the number of archetypes for Petrus’s spider
data</h2>
<p><em>This code chunk has not been run, as it takes a minute or so to
complete</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="cf">if</span>(is_ecomix_installed)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>{</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  nClust<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  bics <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(nClust))</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="cf">for</span>(iClust <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(nClust))</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  {</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    fti_Mix <span class="ot">=</span> ecomix<span class="sc">::</span><span class="fu">species_mix</span>(spiderFormula, <span class="at">data=</span>SpiderDF,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>      <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">nArchetypes=</span>nClust[iClust],</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>      <span class="at">control=</span><span class="fu">list</span>(<span class="at">init_method=</span><span class="st">&#39;kmeans&#39;</span>,<span class="at">ecm_refit=</span><span class="dv">5</span>, <span class="at">ecm_steps=</span><span class="dv">2</span>))</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    bics[iClust] <span class="ot">=</span> <span class="fu">BIC</span>(fti_Mix)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="fu">plot</span>(bics<span class="sc">~</span>nClust, <span class="at">ylab=</span><span class="st">&quot;BIC&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;# archetypes&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>}</span></code></pre></div>
<p><em>How many archetypes would you use?</em></p>
<p>I guess I’d go for four archetypes, that looks like the winner
here.</p>
<p><em>Note that repeat runs didn’t always give the same BIC. Why did
this happen?</em></p>
<p>As in Maths Box 16.1, mixture model likelihoods can be messy with
multiple maxima. Hence it’s a good idea to run multiple times and keep
the best solution.</p>
</div>
<div id="exercise-16.3-how-many-revegetation-archetypes" class="section level2">
<h2>Exercise 16.3: How many revegetation archetypes?</h2>
<p><em>Consider again a Species Archetype Model for Anthony’s
revegetation data. In Exercise 16.2 we assumed there were only two
archetypes. How many archetypes should be used for Anthony’s data?
Answer this question using the model selection technique of your
choice.</em></p>
<p>OK I’m going for BIC as above.</p>
<p><em>This code chunk has not been run, as it takes a minute or so to
complete</em></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="cf">if</span>(is_ecomix_installed)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  nClust<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  bics <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(nClust))</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="cf">for</span>(iClust <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(nClust))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  {</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    fti_Mix <span class="ot">=</span> ecomix<span class="sc">::</span><span class="fu">species_mix</span>(abundMat<span class="sc">~</span>treatment, <span class="at">data=</span>revegDF, </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>      <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">nArchetypes=</span>nClust[iClust])</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    bics[iClust] <span class="ot">=</span> <span class="fu">BIC</span>(fti_Mix)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  }</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">plot</span>(bics<span class="sc">~</span>nClust, <span class="at">ylab=</span><span class="st">&quot;BIC&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;# archetypes&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Well it looks like there should be two archetypes (presumably, one of
these is increasing with revegetation, the other not).</p>
</div>
<div id="exercise-16.4-understanding-why-spiders-vary-in-environmental-response" class="section level2">
<h2>Exercise 16.4: Understanding why spiders vary in environmental
response</h2>
<p><em>Consider again Petrus’s hunting spider data of Exercise 15.2… He
wants to know the extent to which species traits explain interspecific
variation in environmental response. What approach should he use to
answer this question?</em></p>
<p>He wants to know <em>why</em> species vary in their environmental
response, so a good idea would be to include predictors on species
(species traits) and to use a fourth corner model to understand the
extent to which interspecific variation in environmental response can be
explained by these traits.</p>
</div>
<div id="code-box-16.4-a-fourth-corner-model-for-spider-data-using-traitglm" class="section level2">
<h2>Code Box 16.4: A fourth corner model for spider data using
traitglm</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(gllvm)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;gllvm&#39;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:VGAM&#39;:</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;     AICc, nobs, predict, vcov</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats4&#39;:</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt;     nobs, vcov</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:vegan&#39;:</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;     ordiplot</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:mvabund&#39;:</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt;     coefplot</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;     nobs, predict, simulate, vcov</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="fu">data</span>(spider)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>X <span class="ot">=</span> spider<span class="sc">$</span>x[,<span class="fu">c</span>(<span class="st">&quot;soil.dry&quot;</span>,<span class="st">&quot;herb.layer&quot;</span>)]</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>ft_trait <span class="ot">=</span> <span class="fu">gllvm</span>(spider<span class="sc">$</span>abund, X, spider<span class="sc">$</span>trait, <span class="at">randomX=</span><span class="sc">~</span>soil.dry<span class="sc">+</span>herb.layer, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="fu">logLik</span>(ft_trait)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -711.2906 (df=60)</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">max</span>( <span class="fu">abs</span>(ft_trait<span class="sc">$</span>fourth.corner) )</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>colort <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>plot<span class="fl">.4</span>th <span class="ot">=</span> <span class="fu">levelplot</span>(ft_trait<span class="sc">$</span>fourth.corner, <span class="at">col.regions=</span><span class="fu">colort</span>(<span class="dv">100</span>),</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>           <span class="at">at=</span><span class="fu">seq</span>(<span class="sc">-</span>a, a, <span class="at">length=</span><span class="dv">100</span>), <span class="at">scales =</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">list</span>(<span class="at">rot =</span> <span class="dv">45</span>)) )</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="fu">print</span>(plot<span class="fl">.4</span>th)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk code16.4" />
<div class="figcaption">plot of chunk code16.4</div>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">coefplot</span>(ft_trait)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk code16.4" />
<div class="figcaption">plot of chunk code16.4</div>
</div>
</div>
<div id="exercise-16.5-heloises-ants" class="section level2">
<h2>Exercise 16.5: Heloise’s ants</h2>
<p><em>Heloise collected counts of 41 species of ants at 30 sites across
south-eastern Australia, stored as <code>antTraits</code> in the
<code>mvabund</code> package. She also recorded five environmental
variables at each site, and five functional traits for each species. She
would like to know if these traits explain why ant species differ in
environmental response. Fit a fourth corner model to this
dataset.</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">data</span>(antTraits)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>envMat <span class="ot">=</span> <span class="fu">as.matrix</span>(antTraits<span class="sc">$</span>env)</span></code></pre></div>
<p><em>(The below code chunk takes about a minute to run.)</em></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ft_anttrait <span class="ot">=</span> <span class="fu">gllvm</span>(antTraits<span class="sc">$</span>abund, envMat, antTraits<span class="sc">$</span>traits, <span class="at">randomX=</span><span class="sc">~</span>envMat, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">starting.val=</span><span class="st">&quot;zero&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">logLik</span>(ft_anttrait)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -1919.352 (df=223)</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">max</span>( <span class="fu">abs</span>(ft_anttrait<span class="sc">$</span>fourth.corner) )</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>colort <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>plot_4th <span class="ot">=</span> <span class="fu">levelplot</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(ft_anttrait<span class="sc">$</span>fourth.corner)),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">col.regions=</span><span class="fu">colort</span>(<span class="dv">100</span>), <span class="at">at=</span><span class="fu">seq</span>(<span class="sc">-</span>a, a, <span class="at">length=</span><span class="dv">100</span>),</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">scales =</span> <span class="fu">list</span>( <span class="at">x=</span> <span class="fu">list</span>(<span class="at">rot =</span> <span class="dv">45</span>)) )</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">print</span>(plot_4th)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk ex16.5" />
<div class="figcaption">plot of chunk ex16.5</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">coefplot</span>(ft_anttrait)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk ex16.5" />
<div class="figcaption">plot of chunk ex16.5</div>
</div>
<p>This doesn’t always produce a <code>coefplot</code> because of
infinite values – this is symptomatic of non-convergence. Make sure you
end up with a <code>logLik</code> value of about <code>-2300</code> or
better, if this doesn’t happen then re-run. I ended up using
<code>starting.val=&quot;zero&quot;</code> which usually gave better fits (it
doesn’t always but did this time around).</p>
<p><em>What are the key traits that capture why (and how) ants differ in
environment response?</em></p>
<p>A big one seems to be <code>Canopy.cover:polymorphism</code>.
<code>Canopy.cover:Pilosity</code> also seemed to be very negative in
most runs, but with a fairly large standard error.</p>
<p><em>Don’t forget to check your P’s and Q’s!</em></p>
<p><em>The below code chunk has not been evaluated because it is a
function of the previous one</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plot</span>(ft_anttrait, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p>This looks good to me. The points on the normal quantile plot don’t
all stay in the envelope (which is pointwise not global, so is tighter
than it should be), but the violations we have are not of the alarming
kind – residuals are smaller in magnitude than expected, rather than too
large. This is often symptomatic of overfitting rather than lack-of-fit
– the model does have a lot of parameters in it!</p>
</div>
<div id="code-box-16.5-a-fourth-corner-interaction-plot-for-petruss-spider-data" class="section level2">
<h2>Code Box 16.5: A fourth corner interaction plot for Petrus’s spider
data</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>nVars <span class="ot">=</span> <span class="fu">dim</span>(spider<span class="sc">$</span>abund)[<span class="dv">2</span>]</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>newTraits <span class="ot">=</span> spider<span class="sc">$</span>trait</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co"># set factors not of interest here to be a constant value</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>newTraits<span class="sc">$</span>length<span class="ot">=</span> <span class="fu">mean</span>(spider<span class="sc">$</span>trait<span class="sc">$</span>length) <span class="co">#set length to its mean</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>newTraits<span class="sc">$</span>colour<span class="ot">=</span><span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">levels</span>(spider<span class="sc">$</span>trait<span class="sc">$</span>colour)[<span class="dv">1</span>],nVars),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>   <span class="at">levels=</span><span class="fu">levels</span>(spider<span class="sc">$</span>trait<span class="sc">$</span>colour)) <span class="co">#set to first level of factor</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># set starting rows of ’marks’ to take all possible values</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>nMarks <span class="ot">=</span> <span class="fu">nlevels</span>(spider<span class="sc">$</span>trait<span class="sc">$</span>marks)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>newTraits<span class="sc">$</span>marks[<span class="dv">1</span><span class="sc">:</span>nMarks]<span class="ot">=</span><span class="fu">levels</span>(spider<span class="sc">$</span>trait<span class="sc">$</span>marks)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># create a new env dataset where the only thing that varies is soil:</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>newEnv <span class="ot">=</span> spider<span class="sc">$</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="fu">c</span>(<span class="st">&quot;soil.dry&quot;</span>,<span class="st">&quot;herb.layer&quot;</span>)]</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>newEnv[,<span class="st">&quot;soil.dry&quot;</span>]<span class="ot">=</span><span class="fu">range</span>(<span class="fu">scale</span>(spider<span class="sc">$</span>x[,<span class="st">&quot;soil.dry&quot;</span>]))</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>newEnv[,<span class="st">&quot;herb.layer&quot;</span>]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#make predictions and plot:</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>newPreds <span class="ot">=</span> <span class="fu">predict</span>(ft_trait,<span class="at">newX=</span>newEnv,<span class="at">newTR=</span>newTraits,<span class="at">type=</span><span class="st">&quot;response&quot;</span>, <span class="at">level=</span><span class="dv">0</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">matplot</span>(newEnv[,<span class="dv">1</span>], newPreds[,<span class="dv">1</span><span class="sc">:</span>nMarks],<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">levels</span>(newTraits<span class="sc">$</span>marks),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span>nMarks,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span>nMarks)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk code16.5" />
<div class="figcaption">plot of chunk code16.5</div>
</div>
</div>
<div id="exercise-16.6-a-fourth-corner-interaction-plot-for-heloises-ants" class="section level2">
<h2>Exercise 16.6: A fourth corner interaction plot for Heloise’s
ants</h2>
<p><em>Recall that fourth corner model you fitted to Heloise’s data in
Exercise 16.5. For an interaction of your choice, construct a plot to
visualise how the environment-abundance association changes for
different values of the functional trait.</em></p>
<p>I’m going with <code>Canopy.cover:Polymorphism</code>, as the one
with the biggest (and only significant) interaction term:</p>
<p><em>The below code chunk has not been evaluated because it is a
function of the previous one</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>nVars <span class="ot">=</span> <span class="fu">dim</span>(antTraits<span class="sc">$</span>abund)[<span class="dv">2</span>]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>newTraits <span class="ot">=</span> antTraits<span class="sc">$</span>traits</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#set length vars to their mean</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>newTraits<span class="sc">$</span>Femur.length<span class="ot">=</span> <span class="fu">mean</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Femur.length) </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>newTraits<span class="sc">$</span>Webers.length<span class="ot">=</span> <span class="fu">mean</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Webers.length)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># set factors not of interest here to be a constant value</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>newTraits<span class="sc">$</span>No.spines<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,nVars)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>newTraits<span class="sc">$</span>Pilosity <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">levels</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Pilosity)[<span class="dv">1</span>],nVars),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># set first few levels of Polymorphism to all possible values</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="at">levels=</span><span class="fu">levels</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Pilosity)) <span class="co">#set to first level of factor</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>nPoly <span class="ot">=</span> <span class="fu">nlevels</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Polymorphism)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>newTraits<span class="sc">$</span>Polymorphism[<span class="dv">1</span><span class="sc">:</span>nPoly]<span class="ot">=</span><span class="fu">levels</span>(antTraits<span class="sc">$</span>traits<span class="sc">$</span>Polymorphism)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co"># create a new env dataset where the only thing that varies is Canopy.cover:</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>newEnv <span class="ot">=</span> antTraits<span class="sc">$</span>env</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>newEnv<span class="sc">$</span>Canopy.cover<span class="ot">=</span><span class="fu">range</span>(<span class="fu">scale</span>(newEnv<span class="sc">$</span>Canopy.cover))</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>newEnv<span class="sc">$</span>Bare.ground <span class="ot">=</span> <span class="fu">mean</span>(newEnv<span class="sc">$</span>Bare.ground)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>newEnv<span class="sc">$</span>Shrub.cover <span class="ot">=</span> <span class="fu">mean</span>(newEnv<span class="sc">$</span>Shrub.cover)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>newEnv<span class="sc">$</span>Volume.lying.CWD <span class="ot">=</span> <span class="fu">mean</span>(newEnv<span class="sc">$</span>Volume.lying.CWD)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>newEnv<span class="sc">$</span>Feral.mammal.dung <span class="ot">=</span> <span class="fu">mean</span>(newEnv<span class="sc">$</span>Feral.mammal.dung)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>newEnv<span class="ot">=</span><span class="fu">as.matrix</span>(newEnv)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#make predictions and plot:</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>newPreds <span class="ot">=</span> <span class="fu">predict</span>(ft_anttrait,<span class="at">newX=</span>newEnv,<span class="at">newTR=</span>newTraits,<span class="at">type=</span><span class="st">&quot;response&quot;</span>, <span class="at">level=</span><span class="dv">0</span>)</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="fu">matplot</span>(newEnv[,<span class="st">&quot;Canopy.cover&quot;</span>], newPreds[,<span class="dv">1</span><span class="sc">:</span>nPoly],<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Mean abundance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Canopy cover&quot;</span>, <span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">levels</span>(newTraits<span class="sc">$</span>Polymorphism),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span>nPoly,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span>nPoly)</span></code></pre></div>
<p>We can see there that when there is no polymorphism, abundance is
relatively high with low canopy cover.</p>
</div>
<div id="code-box-16.6-quantifying-how-effectively-traits-explain-𝛽-diversity" class="section level2">
<h2>Code Box 16.6: Quantifying how effectively traits explain
𝛽-diversity</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ft_spp <span class="ot">=</span> <span class="fu">gllvm</span>(spider<span class="sc">$</span>abund, X, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>ft_trait <span class="ot">=</span> <span class="fu">gllvm</span>(spider<span class="sc">$</span>abund, X, spider<span class="sc">$</span>trait, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>ft_main <span class="ot">=</span> <span class="fu">gllvm</span>(spider<span class="sc">$</span>abund, X, spider<span class="sc">$</span>trait, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">formula=</span><span class="sc">~</span>soil.dry<span class="sc">+</span>herb.layer)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>an_spider4th <span class="ot">=</span> <span class="fu">anova</span>(ft_main, ft_trait, ft_spp)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Model  1 :  ~ soil.dry + herb.layer </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Model  2 :  y ~ soil.dry + herb.layer + (soil.dry + herb.layer):(length + colour + marks) </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Model  3 :  y ~ X</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>an_spider4th</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;   Resid.Df        D Df.diff     P.value</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; 1      287  0.00000       0            </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 2      279 40.12996       8 3.02999e-06</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; 3      265 76.84430      14 1.08408e-10</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>an_spider4th<span class="sc">$</span>D[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(an_spider4th<span class="sc">$</span>D)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; [1] 0.3430666</span></span></code></pre></div>
</div>
<div id="exercise-16.7-variation-explained-by-traits-for-heloises-ants" class="section level2">
<h2>Exercise 16.7: Variation explained by traits for Heloise’s ants</h2>
<p><em>Consider again Heloise’s ant data. What proportion of the
variation in environmental response is explained by the measured species
traits?</em></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>ft_antspp <span class="ot">=</span> <span class="fu">gllvm</span>(antTraits<span class="sc">$</span>abund, envMat, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>ft_anttrait <span class="ot">=</span> <span class="fu">gllvm</span>(antTraits<span class="sc">$</span>abund, envMat, antTraits<span class="sc">$</span>traits, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>mainFormula<span class="ot">=</span><span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(<span class="fu">colnames</span>(envMat),<span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>ft_antmain <span class="ot">=</span> <span class="fu">gllvm</span>(antTraits<span class="sc">$</span>abund, envMat, antTraits<span class="sc">$</span>traits, <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">formula=</span>mainFormula)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>an_ant4th <span class="ot">=</span> <span class="fu">anova</span>(ft_antmain, ft_anttrait, ft_antspp)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; Warning in anova.gllvm(ft_antmain, ft_anttrait, ft_antspp): This test was not designed for tests with a df.diff larger than 20 so the P-value should be treated as approximate.</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; Model  1 :  ~ Bare.ground + Canopy.cover + Shrub.cover + Volume.lying.CWD + Feral.mammal.dung </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; Model  2 :  y ~ Bare.ground + Canopy.cover + Shrub.cover + Volume.lying.CWD + Feral.mammal.dung + (Bare.ground + Canopy.cover + Shrub.cover + Volume.lying.CWD + Feral.mammal.dung):(Femur.length + No.spines + Pilosity + Polymorphism + Webers.length) </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; Model  3 :  y ~ X</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>an_ant4th</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;   Resid.Df         D Df.diff     P.value</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; 1     1062   0.00000       0            </span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; 2     1022  75.73794      40 0.000548758</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; 3      862 271.85048     160 8.23701e-08</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>an_ant4th<span class="sc">$</span>D[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(an_ant4th<span class="sc">$</span>D)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; [1] 0.2178955</span></span></code></pre></div>
<p>So it looks like about a quarter of interspecific variation can be
explained by traits, which is not super, especially considering that the
trait model uses a quarter as many parameters. This suggests we are not
really onto a winner here…</p>
<p>#remove this chunk once gllvm has been updated on CRAN:</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
