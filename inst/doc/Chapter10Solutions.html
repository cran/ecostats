<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-06-28" />

<title>Chapter 10 – Analysing discrete data – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 10 – Analysing discrete data –
Exercise solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-06-28</h4>



<div id="exercise-10.1-crabs-on-seaweed" class="section level2">
<h2>Exercise 10.1: Crabs on seaweed</h2>
<p><em>David and Alistair… observed the following presence
(<code>+</code>) / absence (<code>-</code>)} patterns for crabs (across
10 replicates):</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Time</th>
<th align="left">Distance (m)</th>
<th align="left">Crabs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">+</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">+</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">2</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2</td>
<td align="left">+</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">2</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">10</td>
<td align="left">+</td>
</tr>
</tbody>
</table>
<p><em>They would like to know if there is any evidence of a difference
in crab presence patterns with Distance of Isolation. How should they
analyse the data?</em></p>
<p>They are looking for evidence of a difference at different values of
<code>Dist</code> so will be wanting to do a hypothesis test. Because
they have presence-absence data they should be thinking of a generalised
linear model with binomial response, as in Code Box 10.1.</p>
</div>
<div id="exercise-10.2-do-offshore-wind-farms-affect-fish-communities" class="section level2">
<h2>Exercise 10.2: Do offshore wind farms affect fish communities?</h2>
<p><em>Lena and colleagues… [were] collecting paired data before and
after wind farm construction, at 36 stations in each of three zones
(<code>Wind Farm</code>, <code>North</code>, or
<code>South</code>):</em></p>
<table>
<thead>
<tr class="header">
<th align="left">Zone</th>
<th align="left">Impact</th>
<th align="left">Station</th>
<th align="left">Abundance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Wind Farm</td>
<td align="left">Before</td>
<td align="left">WF1</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Wind Farm</td>
<td align="left">After</td>
<td align="left">WF1</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">South</td>
<td align="left">Before</td>
<td align="left">S1</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">South</td>
<td align="left">After</td>
<td align="left">S1</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">North</td>
<td align="left">Before</td>
<td align="left">N1</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">North</td>
<td align="left">After</td>
<td align="left">N1</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Wind Farm</td>
<td align="left">Before</td>
<td align="left">WF2</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Wind Farm</td>
<td align="left">After</td>
<td align="left">WF2</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left">North</td>
<td align="left">After</td>
<td align="left">N36</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p><em>Lena wants to know if there is any evidence of a change in eel
abundance at wind farm stations, as compared to others, following
construction of the wind farm. How should she analyse the data?</em></p>
<p>She is looking for evidence of a difference across different values
of <code>Zone</code> when <code>Impact=After</code> so will be wanting
to do a hypothesis test. This is a BACI design, so she would be
particularly interested in the <code>Zone:Impact</code> interaction.
Because she has count data with plenty of zeros, this should be analysed
using a generalised linear model (assuming a negative binomial or
Poisson response, as in Code Box 10.1).</p>
</div>
<div id="exercise-10.3-invertebrate-response-to-bush-regeneration" class="section level2">
<h2>Exercise 10.3: Invertebrate response to bush regeneration}</h2>
<p><em>Anthony wants to evaluate how well invertebrate communities are
re-establishing following bush regeneration efforts.</em></p>
<table>
<thead>
<tr class="header">
<th>Treatment</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>C</td>
<td>0</td>
</tr>
<tr class="even">
<td>R</td>
<td>3</td>
</tr>
<tr class="odd">
<td>R</td>
<td>1</td>
</tr>
<tr class="even">
<td>R</td>
<td>3</td>
</tr>
<tr class="odd">
<td>C</td>
<td>1</td>
</tr>
<tr class="even">
<td>R</td>
<td>2</td>
</tr>
<tr class="odd">
<td>R</td>
<td>12</td>
</tr>
<tr class="even">
<td>R</td>
<td>1</td>
</tr>
<tr class="odd">
<td>R</td>
<td>18</td>
</tr>
<tr class="even">
<td>R</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><em>He wants to know if there is any evidence that bush regeneration
is working. How should he analyse the data?</em></p>
<p>He is looking for evidence of an effect of revegetation so will be
wanting to do a hypothesis test for a <code>Treatment</code> effect.
Because he has count data, with zeros, this should be analysed using a
generalised linear model (assuming a negative binomial or Poisson
response, as in Code Box 10.1).</p>
</div>
<div id="code-box-10.1-example-glm-fits-for-exercises-10.1-3." class="section level2">
<h2>Code Box 10.1: Example GLM fits for Exercises 10.1-3.}</h2>
<p>For Exercise 10.1:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(seaweed)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>CrabPres <span class="ot">=</span> seaweed<span class="sc">$</span>Crab<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ft_crab <span class="ot">=</span> <span class="fu">glm</span>(CrabPres<span class="sc">~</span>Time<span class="sc">*</span>Dist, <span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;cloglog&quot;</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>seaweed)</span></code></pre></div>
<p>For Exercise 10.2: \begin{verbatim}</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(windFarms)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>eels <span class="ot">=</span> windFarms<span class="sc">$</span>abund[,<span class="dv">16</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ft_eels <span class="ot">=</span> <span class="fu">glm</span>(eels<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">*</span>Zone,<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted rates numerically 0 occurred</span></span></code></pre></div>
<p>For Exercise 10.3:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(reveg)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Haplotaxida<span class="ot">=</span>reveg<span class="sc">$</span>abund[,<span class="dv">12</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>worms <span class="ot">=</span> reveg<span class="sc">$</span>abund<span class="sc">$</span>Haplotaxida</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ft_worms <span class="ot">=</span> <span class="fu">manyglm</span>(worms<span class="sc">~</span>treatment,<span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">data=</span>reveg)</span></code></pre></div>
</div>
<div id="code-for-fig.-10.5" class="section level2">
<h2>Code for Fig. 10.5</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(reveg)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>revegMV<span class="ot">=</span><span class="fu">mvabund</span>(reveg<span class="sc">$</span>abund)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>treatment<span class="ot">=</span>reveg<span class="sc">$</span>treatment</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">meanvar.plot</span>(revegMV<span class="sc">~</span>treatment,<span class="at">legend=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>),<span class="at">main=</span><span class="st">&quot;Poisson&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; START SECTION 2 </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plotting if overlay is TRUE</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable Poisson 7 mean values were 0 and could </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      not be included in the log-plot</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable Poisson 10 variance values were 0 and could not </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      be included in the log-plot</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FINISHED SECTION 2</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">3.8</span>,<span class="at">length=</span><span class="dv">100</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk fig10.5</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">meanvar.plot</span>(revegMV<span class="sc">~</span>treatment,<span class="at">legend=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>), <span class="at">main=</span><span class="st">&quot;Negative binomial&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; START SECTION 2 </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plotting if overlay is TRUE</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable Negative binomial 7 mean values were 0 and could </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      not be included in the log-plot</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using grouping variable Negative binomial 10 variance values were 0 and could not </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                      be included in the log-plot</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FINISHED SECTION 2</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">3.8</span>,<span class="at">length=</span><span class="dv">100</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,x<span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAA6lBMVEUAAAAAADoAAGYAAIsAOjoAOmYAOpAAZAAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmZrZmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkDqQkGaQtmaQtpCQttuQ29uQ2/+2ZgC2Zjq2kDq2kGa2tma2ttu225C227a22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb25Db27bb2//b/7bb/9vb////jAD/tmb/25D/27b//7b//9v////+2K63AAAACXBIWXMAAAsSAAALEgHS3X78AAAXzUlEQVR4nO2dC3vjtpVAaTtjb+W4O21qJem+Gnu6j+5Lyj66Saykszu1pdj8/39nCT5EUiIlkBcg8Tjns+MxRYKSeQJckABukgIISOZ+A+A3CAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRsQn0ukwe0vTt8fLpxE5v3z5kO/btsj+4f5f6bPUe5/f2kggFyq7jGYHWSrJezhzcf2YECoBMoOS+cODtP2+Ti2+ybW//kLz7n+X1c7r7Oknerd4ekyRZqOu9zXYtdNrvm+YC/ctt8uvnXInil3ffZdt/zHb5u+d0m/wiK+/px9uLshorSkWgMFACXaxygdaJQtmU/fjs9vpZvZYk13/eC/SaW5W9st9Xke+f7fdcCJT/skjLXRaZQIrPsm9VgPqu9575w9sgPoEu/6AcuXzKxPgu/Xmp/nG5SjfZJVav75a5WmXlsb5YZb/cp/t91S6ZM9mW5cWqFOg+/Sk7eHd78W/51m1y+d3uNvnmtdyjKhWBgiC7jD88Jt88qvYpR13xhdqeCfT2p3/8ZdIUaHd7rzxI9/uqIooYKNunEOhilR+cl5J5+KD+Ub2SF1KWikBB8JpXORe/7BLo5+W7//7UqoHeHq//Q716SqDslw6Brp8rgapSESgI8su4UfFJ3iwp9k3YJvki/em2KZDaU/XI9vsqslbrN5lsVRNWCtRowtoCVaUiUBDkl7Hoy6/LWHgfRBf1TPHKorjexZ7pfl9VxEEQXQrUCKLbAlWlIlAQFJdxm98M+vY2Ub3x9PXr5N336pJ/m1z8LmuEsgonWXxalubkXa/9vulxN74UKO/G/y49EqgqFYFCZafu2PxUVi8wEASqmqT7ud+HnyBQmv78IetgfUEFNAoEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiJAIlEB4XB1tsSiQ4Fhwk6ujLQgE+hz7g0CgT4c/CATadPmDQKBLpz8IBJp0+4NAoEePPwgEWvT5g0CgQ68/CAQa9PuDQKABAoGEE/6IBXpd9q79hkCBcMofuUBf/aEvdw0ChUHDn5ubm8NX5QKpdZM7V6hFoCBo+lN+NzEhUL3g9rBjwQOa7Zc9gcYdC+7Tin9sCGTpWHCDg/jZQgxk6VhwgpP9rwKxQLvbfGRsRxiNQL6j4Y9YoLfHohO/Pc4lgUCeo+OPsSC6I5hGIL/R8ocaCHrQ80ceAxVZh4mBQkPTH3ph0ImuPwgEnUwr0LrzcSoC+Yu2PwgEHej7Y0CgIopeNI7Rm3YPzjLAH2ogOGKIPwgEhwzyh14YHDDMHwSCNgP9MSHQ22Ny/enL1ahjwTGG+mNAoLfH+937Z56FBcFgf0x04796ygTiaXwIDPfHWA20oQbynxH+GIqBkuTYHwTyjTH+0AuDilH+IBCUjPMHgaBgpD8IBDlj/TGwOkf56J2pzT4z2h95DZT14kcfC44w3h8TNxI7nmLoHgtOIPCHGAhE/iAQiPxBoOiR+YNAsSP0B4EiR+oPAsWN2B8Eihq5PwgUMwb8QaCIMeEPAkUMAoEEI/4gULSY8QeBYsWQPwgUKab8QaA4MeYPAkWJOX8QKEYM+mMi1cGDmlnIxEJ/MOmPkYXG1fpSu/dMbfYEo/6YSHXw9mFFqgN/MOuPvAnLqp/tfZpuF0evIJCLGPbHQBC9Tg5WaR1wLEyNaX/ohcWFcX8QKCrM+2OiG0+2Hm9wUCDyhXmEBX9MdONbP4ccC9Niwx9qoHiw4o88BiJjoSfY8YdeWCxY8geBIsGWP2YEIluP61jzB4GiwJ4/JlYoI2Oh41xZ9IcaKHxs6oNA4WPXH3phoWPZHwQKHNv+mBCIjIUO44FAZCx0GOv+mOjGk7HQWez7Y6wGImOhg0zgj6EYiImFLjKFP/TCwmUSfxAoWKbxB4FCZSJ/EChQpvJHPqiejIUuMpk/8hqIjIUOMp0/Jm4kkrHQNSb0hxgoQKb0B4HCY1J/ECg4pvUHgYIDgUDCxP4gUGBM7Q8ChcXk/iBQUEzvDwKFxAz+IFBAzOEPAoXDLP4gUDDM4w8ChcJM/iBQIMzlDwKFwWz+IFAQzOcPAoXAjP4YWWhcjYtmYuF8dPrz8vIyyckNCJRPi999MfxYMEOXQC/lt3UMCJRnu2RxhdnoroBSXwRaXvz775/ImTof3QGQNwLlayss0i2pDmaiL4D2JQaydCzoYXUFXy0QyGdm18eAQGQsnA8H/BELRL6w+XDBHyM3Eps/hxwLIpzwhxrIW9zwRx4DkbFwHhzxh16Yp7jiDwL5iTP+mBGIbD0T444/COQlQQlExsLJccgfaiAPcckfBPIPp/yhF+YdbvmDQL7hmD8mBCJj4YS45o+REYlkLJwM5/wx0Y0nY+FkuOePsRqIjIUT4KA/hmIgJhZOgYv+0AvzByf9QaA5ubm50d/ZTX8QaEZuym8tHPUHgWZkiECu+mNgajMZC8cyQCBn/ZHXQGQsHI92DOSuPyZuJJKx0DYO+0MM5AEu+4NADnLQsjntDwK5x2FsjUAwiAOB3PYHgdyjLZDj/iCQgzRjINf9QSC3cd4fBHIa9/1BIJfxwB8Echgf/EEgd/HCHwRylfkX8NUDgdzEE30QyFG88QeBnMQffxDIRTzyB4FcBIHEx8ZK/hjsqvmL65gRaHd3vEw0Ag0nfxB/1fxlxjejB7MyXEL5ctX8JXyBMoMydaiBzKDar5vGLzEIpBS6/ohAAhqxzs3VTed2dzESA+1uO1JlIJAmzZrGp/5XgYZA+zCnM6XK6KKhpCGQf/5oCbRffKxjGbLxRUNJLZCH/sibMFJeiqliHR/90RSobyFWEs4ZxEt/9ATqXYiVlJfm8NMfPYF6F2KlBjKGp/4MqYE6FmJNSXlpCF/90Y+BOhdilRQNDbz1h6fxbhC5QKR7EuKvP4PuRPfeh0YgGU1/vHgA1sDAEnekvBTS8if14RF8A5qw2Wm1X4EKtKEJs0Y7/glToNcvV9tFulmc3ndg0ZBzGD8HGQO9fvVUfJksGhQe978K9O5Ef1hlX53jVlNSXkrw3h/NGChzZ5sk3UvSk/JSg56GyX9/THTjSXl5lp7QOAB/DAhEysvzdAsUgj+aAm2Th3Rz0ZMTg5SXZ+kUKAh/tLvxac/00/FFR0VHDBSGP7rjgdSdws4RieOLjpxA/NFswvLnXYPm9JwvOm5C8YfxQPMQjD8srjAL4fij+zD1+nmTJJ2PTEl5OZyA/NHuhWVfPb0wUl4OJSR/tB+mZnUQ3XgzBOWP9nigi9W2uwkbXXSshOUPvbCpCcwfBJqY0PxBoGkJzh8EskD/qNTw/EEg8/SPiw/QH81u/HLECncIdEiI/mjWQGt1t3mzGPY8HoHaBOmP9o3E/L/fs0aiDuEOgO5Ad32gVD0Q+/ieGmg0YfqjG0Sv1fT31+Wge9EI1CRQf+iFTUSo/iDQNATrD0vcTUK4/gwLohlUP46A/RnWjWc80ChC9kdeA+1uk/s1y/yeIGh/xDGQmjK2Vinnjm8RIVBO2P7IZ2Vk7dr2nlQHvQTuj1igKtUBNVA3ofsjX+a3uD29IQbqJHh/uJFolfD90aqByFg4kgj8GdSEdTZiZCzsJQZ/jAXRrJF4RBT+GOnGN38OOTZs4vCHGsgWkfgj74WRsbCTWPyhG2+HaPzRfxbWk/Z7fNEhE48/2k/j+9J+55Ctp01E/miPB+pL+52DQC1i8mdIDdQzIpGMhQdE5Y+ZMdHUQA3i8sdMLwyBaiLzh268YWLzR1Ogk8lWRhYdJNH5o73Mb9qfbIWMhTUI1PnyyWQrZCzc83L1MvdbmBy9JuxUshUyFla8ZPVPdAbJg2gyFlao9guBBr2cQ8bCgrz9QqDOl7cjlkiMRaCXl0Kaq/qfMaG5yObALAc6RQdCVe3E1/8qGLC4guGiA6EUKFZ/hqzSarjoQCgEitafQetEd8VAZCzMAp+reP2R98LIWBhx9ZOa6MZHn7Ewan80BdrQje8lbn+0H6ZuF+lmcXrfgUUHQuT+aHfjiy+TRQcCAmm8/PZhlX2RdLeD2P3RjIEyd7ZJMvBmUAwCRe8PQ1pF4A8CScAfzRXKvu+/Ez2+aP/Bn5QaSAD+KHgaPxb8ydHtxpsv2nPwp0D6NH580X6DPyXEQKPAnwoEGkiekhl/9vA0fhh5Unj8qeFp/DCUQPjTgKfxw1Dt183cb8IlxE/jd7eJWrYjmqnNN/jTQvo0Xq27oIZFRyNQ0X7loTSk8l5YIc56EYtApT/lN5hKdbD57Lh9C1GgMn5GoD06T+OXp9Yme13mLVtHysIABar6Xwi0R3OBqWRgF16jaA+p++/EQBW6Tdh26G3EAAXi/k8H+jHQ67JToXgyFuJPF7oC9egTUb4w/OlENwbqa8CiyViIP91Ie2Gx1ED404N4OEccGQvxpw/GA+mAP70gkAb4048RgULP1oNA/SDQeUz7E9RqwAZWKAs9Y6Fxf9KQ1iOnBjqH8fYLgY4IWKDjBVjFDRACmSnaC46rHwOXnxjISNE+0NF8hVV/yDEgULgZC7vCHwRqIxcopIyF7calO3wOqgGSY6AbH07Gwnbtwu1DHUzVQEFkLGwJhD9amImBAslY2BQIf/SgF9akjm/wRxME6gR/dEGgLvBHGwTqAH/0Ec+N9ydjofZkQPwZgLgG8iZjofZ0ZPwZgoEbiZ5kLNQVCH8GEU8MpCkQ/gwjHoFOxUD1S/gzkIgE6qeunPBnKAiU1gLFnP99LAiU7gVCnxEgkILl50eDQBX4MwoEKsGfcSBQCQKNA4EK8GckCJSDP2NBIAX+jAaB+u8fMoFHAwTqrX6YQqgDAvU2XwikQ/QC9Yc/CKRD7AKdCp+JgTSIXCC6X1LiFqjlDxl4xhC1QG1/UnKAjSCiaT1HtNsvBBpFPNN6jjiIfxBoFPFM6znkKH4mBhpDtDEQ/S8zxCoQ/hhCLJCfKS/xxxRSgfxMOIc/xhB3431MeYk/5oixBsIfg4hjIP9SXuKPSaLrhTF92SyxCYQ+hjEikD/pnvDHNHEJhD/GMfAszJ+Ul/hjnphqIPyxQEQC4Y8NQu+FDct+wTD6wQQu0H5qjtbtHybyDMeAQC6nvKyU0Gu+EGg4coGcTnlZKqEZ/iDQcAx0451OeZlHNdrhMzHQYEzVQA6nvOTpl03MxEAup7xEH6sE3gvDH9uELhD+WCZwgfDHNmELhD/WCXpuPP7YJ+S58fgzAeHOjef2zyQEGwOhzzSEKhD+TESgAuHPVAQpEOHPdIQoEPpMSIAC4c+UhCcQ/kyKpwL1r2d4dX4XMIifArVWVG2ZctW5C1jDf4Faplx17gL2CEugq+5dwB5+CtRstmpT2rd/iIEmwVOBmlSm0P2agwAEKsGfWQhGIPyZh0AE4unXXAQgUBYDoc9siAWaPdVBFkFf0d+aDf8XGr/Jmi8Emg3xrIzZUx2o5guBZsP7GuiKO4azIo6BZk51QPg8M373wui9z47XAqHP/PjcjccfB/A3iKb5cgJfu/Ho4wie1kDo4wp+dOMPb/XgjzN40Qs7HJ6KP+7go0D44xBGBLKdractEP64hBcCNWMgul9uYWCFsikzFqKPa/hRA1Wgj3N4JRD+uIcXvbACmi8X8Ucg9HESAwJNk7EQf9xELtAkGQtpvlzFQDd+goyF6GOXRMCZks+ffIKMhfhjGcGlMhMDWc1YSPNlnXkFsnFsDfpMQMACoc8UBCsQ1c80BCpQrY+BfO7tIkgQ32JGgSxmLKxrn5fyW0C7CAMFBkVxqV7/6qgn1LHpYLO4BrKVsbDZeiGQZYpLtXt/ZEvHpoPNBm4kWslY2Ap+EMgy+aVSj6Q+/uXXl0/bfHjXJvtvuSn5zWNyn+abd79aFpufm4eeKVnyrkZyEDwTA9llXwPtPl/l1cv6oXi6UGxSX+8/FpvvnorN7UPPlCx5V2Og8zUxtUCZGVsV0t6rOesXq2JT/vVTvjn759uHldsCoc/ktAXKhydvL5+y4KQp0KLcx3WB0Gd6WgJlDdbb40Om0bZVA33MNzsvENXPHJTd+OW1CnSKaPl1mfzF8qHYVDhUBNG5QNlmN4No9JmHUO5Eo89MhCEQ1c9sBCEQ+sxHCALhz4z4LxDN16z4LhD6zIznAqHP3HgtENXP/HgsEPq4gL8CNfK8kzJlPjovlZqu1V52pTU+sXweNqtAjeqHNO9zsr9UjXFSaqjpwWDB1vhEBwRqtl4INCfVpWqO1MwF+d//UyMT7+uBiPmQxWLT7AK1oh8EmpMugYphQakagvjlaj8QMR+yeFcOFWoeeqZkybvq5jB6JgaakRMCqR/rehhQNeIs39Q89EzJknfVBZ0vp+iKgUpBbAs0al4Y+jhG16XKg+jl/b69qgUy24QNnxeGPs7RealU3XCfT+95qAci5kMWq029h54p+eA8w+aFoY+D+HMjEX2cxBuB0MdN5hRoSM5U/HGUGQUakLHw6opbPY4y5/IuujlTM31SbjY7ivs1kAqeEchZ9peq8TygZ2WXHJPrA+nkTC36XgjkLNWlal6iUwJNO7V533XncZerdAtUrQy0y36WCwblnabLH9xfHwgmpUegamWgalmFLNBVt403C+M10KbrcQYCeUN3DFQtq6AeX2zqBYNSC01YSyCbKS/BCl2X6lCg/YJBqW2BBh4L83NGoMaCQaoJ2xaPVPsPPVOy5F2Bk5wRKA+iiwWD8iD6yez6QNMknAOLnL5Upzr0BgSaJOEcWGVWgaZIOAd2mXU4xwQJ58Ay844Hsp1wDqzjzYAycBMEAhEIBCIcFQhiQCjQiYmF2mVIsX0C38ufsy2QTCzUL0OI7xfY+z+Q7NS9EwsHlCHD9wvs/R/I8qm9//v4Xj4CzXwC38tHoJlP4Hv5CDTzCXwv33eBIGIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEjBRod9ceXva6LKdtHL5gpvj6DPsTWSrfzCfoL18tWfrQdYipE2xPDf2zwDiBtgdvUq2Dt1l0vDCOjlLKM+xPZKl8M5+gv3w1tkrlw7F2AmWW/A80gFECrS/+Vf0fkDl/Wa/Aqd56+YKQg+LzObHlGaoT2SrfyCc4UX6eIWctrYJOfYDUVCugiaQJW99XsqvJ1cXARYNNWFV8/vcpz1CfyE75qcEmrKd8E+//9Ancr4GKD6DebjljXq28YFqgsvhtPqL/vjxDfSI75Rv6BKfKPz/GXHaC3e2FXFB9JAKp+RoXq3WSLGzUQGXx1mqgzvINfYIT5b8uDfhz8gMYqeK0kQhUr9dRN8AGBaqKNx4DnSg/NShQZ/m7WwN9sNMfwECQNQBhDFSuGqSq5aLlNRsD1YsSlWeoT2Sn/NScQJ3lG/Kn/wSG2nh9JAJldWjV3Nq4D9Qovj6DwftAneUbFKir/E0esMgl6v8AmyTxIQYCKEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABALtbvPpxv0z4rfJ9UfNgfb7AflvjyaWUPABBNp9/uvn9PW3/YpsF9ozNRr7TTk3a04QaHf316t09zfFVE9VDxUrsOze/305/6YUqHw1+/Hut/m8mXIhlWJyTXlQvR8CxcLu7r8e0h/VchfFYgX5Cix3T7vbatpeKVA5jU/9yCdeqamg5YIz2+tP5UH7UhAoGnZ3f/zi7fd/vHtqLBaR/cjnIectUiGQeiXbQ/14+5ALVMz/rFut4qCqFASKhd3dD//06W/Vpa8WK1irtulQIPXvzBy1hkEhkGq1VNv1vpgoWx1UlYJAsZBd9G//+b6sY1IV0zxUwpysgRRZm1bsUx9ULXmAQLGg1g27WNVRTm7O56tDgY5iIPVL9q1ioKwVrA+q9kOgSCgqjrL/pNTYJMm7rx+OBKp7Yb8oaqB1sxdWH1SWgkBQsj1cTkbrrhACQcm2uaDM26PW8inciQbQAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBDx/7AU1ECHrU6RAAAAAElFTkSuQmCC" alt />
<p class="caption">plot of chunk fig10.5</p>
</div>
</div>
<div id="code-box-10.2-a-summary-of-a-glm-fit-to-the-crab-presence-absence-data-of-exercise-10.1" class="section level2">
<h2>Code Box 10.2: A summary of a GLM fit to the crab presence-absence
data of Exercise 10.1</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>Dist <span class="ot">=</span> <span class="fu">as.factor</span>(seaweed<span class="sc">$</span>Dist)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ft_crab <span class="ot">=</span> <span class="fu">glm</span>(CrabPres<span class="sc">~</span>Time<span class="sc">*</span>Dist, <span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;cloglog&quot;</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>seaweed)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_crab)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = CrabPres ~ Time * Dist, family = binomial(&quot;cloglog&quot;), </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = seaweed)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.3537  -0.6681  -0.6681   1.0108   2.1460  </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -2.3282     1.5046  -1.547    0.122</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time          0.1656     0.1741   0.952    0.341</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dist2        -1.5921     2.5709  -0.619    0.536</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dist10       -0.5843     2.1097  -0.277    0.782</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Dist2    0.1683     0.2899   0.581    0.561</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Dist10   0.1169     0.2399   0.487    0.626</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 71.097  on 56  degrees of freedom</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 62.999  on 51  degrees of freedom</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 74.999</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
</div>
<div id="code-box-10.3-dunn-smyth-residual-plots-for-the-crab-data-using-the-mvabund-package" class="section level2">
<h2>Code Box 10.3: Dunn-Smyth residual plots for the crab data, using
the <code>mvabund</code> package</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ftMany_crab <span class="ot">=</span> <span class="fu">manyglm</span>(CrabPres<span class="sc">~</span>Time<span class="sc">*</span>Dist,<span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;cloglog&quot;</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>seaweed)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ftMany_crab, <span class="at">which=</span><span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
</div>
<div id="code-for-figure-10.8" class="section level2">
<h2>Code for Figure 10.8</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ftMany_crab, <span class="at">which=</span><span class="dv">1</span>, <span class="at">n.sim=</span><span class="dv">39</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ftMany_crab, <span class="at">which=</span><span class="dv">1</span>, <span class="at">n.sim=</span><span class="dv">39</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p>(Note that <code>plotenvelope</code> was run with just
<code>39</code> iterations, to speed up computation time.)</p>
</div>
<div id="exercise-10.4-counts-of-ostracods-in-habitat-configuration-experiment." class="section level2">
<h2>Exercise 10.4: Counts of Ostracods in habitat configuration
experiment.</h2>
<p><em>What sort of model would you use for Ostracod counts?</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(seaweed,<span class="fu">boxplot</span>(Ost<span class="sc">~</span>Dist))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk ex10.4</p>
</div>
<p>As this is a count variable with plenty of small counts (and zeros in
each category), I am thinking a GLM. To start with we could consider a
Poisson regression, if there were no overdispersion, or negative
binomial regression.</p>
<p>The terms to add to the model I guess are <code>Time</code> and
<code>Dist</code>, as orthogonal factors. As previously
<code>Wmass</code> might also be useful.</p>
<p><em>How would you check assumptions?</em></p>
<p>Look for a fan-shape on a residual plot to check the mean-variance
assumption, as in Code Box 10.4.</p>
</div>
<div id="code-box-10.4-assumption-checking-for-ostracod-counts-of-exercise-10.4." class="section level2">
<h2>Code Box 10.4: Assumption checking for Ostracod counts of Exercise
10.4.}</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>seaweed<span class="sc">$</span>logWmass <span class="ot">=</span> <span class="fu">log</span>(seaweed<span class="sc">$</span>Wmass)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ft_countOst<span class="ot">=</span><span class="fu">manyglm</span>(Ost<span class="sc">~</span>logWmass<span class="sc">+</span>Time<span class="sc">*</span>Dist,<span class="at">data=</span>seaweed,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_countOst, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>) <span class="co"># for a scale-location plot as well</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p>(Note that <code>plotenvelope</code> was run with just
<code>99</code> iterations, to speed up computation time.)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co">#this line is currently needed to deal with a bug but prob redundant soon</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ft.countOstNB<span class="ot">=</span><span class="fu">manyglm</span>(Ost<span class="sc">~</span>logWmass<span class="sc">+</span>Time<span class="sc">*</span>Dist,<span class="at">data=</span>seaweed)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft.countOstNB, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
</div>
<div id="exercise-10.5-checking-the-poisson-assumption-on-the-wind-farm-data." class="section level2">
<h2>Exercise 10.5: Checking the Poisson assumption on the wind farm
data.</h2>
<p><em>Refit the model using the <code>manyglm</code> function, and
hence construct a residual plot</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(windFarms)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>eels <span class="ot">=</span> windFarms<span class="sc">$</span>abund[,<span class="dv">16</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ft_eels <span class="ot">=</span> <span class="fu">manyglm</span>(eels<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">*</span>Zone,<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_eels, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  : </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NA/NaN/Inf in &#39;x&#39;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>Does the Poisson assumption look reasonable?</em></p>
<p>There is no evidence of a fan shape, residuals are close to a
straight line on the normal quantile plot, so it looks pretty good to
me.</p>
</div>
<div id="exercise-10.6-checking-the-poisson-assumption-for-the-worm-counts." class="section level2">
<h2>Exercise 10.6: Checking the Poisson assumption for the worm
counts.}</h2>
<p><em>Refit the model using the <code>manyglm</code> function under the
Poisson assumption, and hence construct a residual plot.</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(reveg)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Haplotaxida<span class="ot">=</span>reveg<span class="sc">$</span>abund[,<span class="dv">12</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>worms <span class="ot">=</span> reveg<span class="sc">$</span>abund<span class="sc">$</span>Haplotaxida</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ft_worms <span class="ot">=</span> <span class="fu">manyglm</span>(worms<span class="sc">~</span>treatment,<span class="at">family=</span><span class="fu">poisson</span>(), <span class="at">data=</span>reveg)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_worms, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>Also fit a negative binomial to the data and construct a residual
plot.</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ft_wormsNB <span class="ot">=</span> <span class="fu">manyglm</span>(worms<span class="sc">~</span>treatment,<span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_wormsNB, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p><em>Can you see any differences between plots?</em></p>
<p>The Poisson model fans out more and has a couple of residuals that
are unusually large (see normal quantile plot). It also may have a trend
line on the residual vs fits plots that slips outside its simulation
envelope.</p>
<p><em>Compare BIC for the two models, using the <code>BIC</code>
function.</em></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_worms, ft_wormsNB)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            df      BIC</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_worms    2 80.55508</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_wormsNB  3 53.93523</span></span></code></pre></div>
<p><em>Which model has the better fit to the worm counts?</em></p>
<p>Well BIC suggests the negative binomial model is way better,
corroborating the result from the normal quantile plots.</p>
</div>
<div id="code-box-10.5-r-code-using-the-anova-function-to-test-the-key-hypotheses-of-interest-to-david-and-alistair-in-exercise-10.1." class="section level2">
<h2>Code Box 10.5: <code>R</code> code using the <code>anova</code>
function to test the key hypotheses of interest to David and Alistair in
Exercise 10.1.</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_crab, <span class="at">test=</span><span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: binomial, link: cloglog</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: CrabPres</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)   </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                         56     71.097            </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time       1   6.6701        55     64.427 0.009804 **</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dist       2   1.0265        53     63.400 0.598553   </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Dist  2   0.4012        51     62.999 0.818257   </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><em>Any evidence of an effect of Isolation distance on
crabs?</em></p>
<p>Nope :(</p>
<p><em>Note the <code>Time</code> effect is significant here but not in
Code Box 10.2. Why do you think that might be?</em></p>
<p>Code Box 10.2 uses a Wald test, which is known to give wacky answers
for separable models, see Maths Box 10.6 for details.</p>
</div>
<div id="exercise-10.7-testing-if-there-a-wind-farm-effect" class="section level2">
<h2>Exercise 10.7: Testing if there a wind farm effect</h2>
<p><em>What model should be fitted, to handle the pairing
structure?</em></p>
<p>We can fit a <code>glm</code> as previously but need to include
<code>Station</code> as one of the predictors, to handle
station-to-station variation in eel abundance:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ft_eelsSt <span class="ot">=</span> <span class="fu">glm</span>(eels<span class="sc">~</span>Station<span class="sc">+</span>Year<span class="sc">+</span>Year<span class="sc">:</span>Zone,<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>windFarms<span class="sc">$</span>X)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted rates numerically 0 occurred</span></span></code></pre></div>
<p>It would be OK to write <code>Year*Zone</code> but the
<code>Zone</code> main effect is redundant because of the
<code>Station</code> main effect. You could also use a mixed model with
a random intercept for <code>Station</code>.</p>
<p><em>Fit the appropriate model and test for an effect of wind
farm.</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_eelsSt,<span class="at">test=</span><span class="st">&#39;Chisq&#39;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: poisson, link: log</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: eels</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                         178    246.714              </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Station   107  169.443        71     77.270 0.0001145 ***</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Year        1    1.906        70     75.365 0.1674431    </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Year:Zone   2    4.821        68     70.544 0.0897813 .  </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>There is marginal evidence of a Year-Zone interaction.</p>
</div>
<div id="code-box-10.6-model-based-inference-for-anthonys-worm-counts-from-exercise-10.3." class="section level2">
<h2>Code Box 10.6: Model-based inference for Anthony’s worm counts from
Exercise 10.3.</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ftmany_Hap<span class="ot">=</span><span class="fu">manyglm</span>(Haplotaxida<span class="sc">~</span>treatment,<span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>reveg)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftmany_Hap)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 0 sec</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: Haplotaxida ~ treatment</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                       </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 2.811    0.156</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="code-box-10.7-design-based-inference-for-davids-and-alistairs-crab-data-using-mvabund." class="section level2">
<h2>Code Box 10.7: Design-based inference for David’s and Alistair’s
crab data using <code>mvabund</code>.</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ftMany_crab <span class="ot">=</span> <span class="fu">manyglm</span>(CrabPres<span class="sc">~</span>Time<span class="sc">*</span>Dist, <span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;cloglog&quot;</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>seaweed)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftMany_crab)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 6 sec</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: CrabPres ~ Time * Dist</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)  </span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     56                         </span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time            55       1 6.670    0.016 *</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dist            53       2 1.026    0.614  </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Dist       51       2 0.401    0.857  </span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>Any important differences from results David and Alistair
previously obtained in Code Box 10.5?</em></p>
<p>Nope, looks very similar actually! I guess the <code>Time</code>
effect is slightly less significant now but the conclusion doesn’t
really change, there is still reasonable evidence of a <code>Time</code>
effect.</p>
</div>
<div id="code-box-10.8-getting-the-wrong-answer-by-ignoring-overdispersion-in-anthonys-worm-counts-from-exercise-10.3." class="section level2">
<h2>Code Box 10.8: Getting the wrong answer by ignoring overdispersion
in Anthony’s worm counts from Exercise 10.3.</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ft_wormPois <span class="ot">=</span> <span class="fu">glm</span>(Haplotaxida<span class="sc">~</span>treatment, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_wormPois,<span class="at">test=</span><span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: poisson, link: log</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: Haplotaxida</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                          9     63.946              </span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment  1   11.668         8     52.278 0.0006359 ***</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ft_wormmanyPois <span class="ot">=</span> <span class="fu">manyglm</span>(Haplotaxida<span class="sc">~</span>treatment,<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>reveg)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_wormmanyPois)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 0 sec</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: Haplotaxida ~ treatment</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                       </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 11.67    0.224</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="code-box-10.9-using-an-observation-level-random-effect-for-a-binomial-response" class="section level2">
<h2>Code Box 10.9: Using an observation-level random effect for a
binomial response</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(seedsTemp)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>seedsTemp<span class="sc">$</span>propGerm <span class="ot">=</span> seedsTemp<span class="sc">$</span>NumGerm <span class="sc">/</span> seedsTemp<span class="sc">$</span>NumSown</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(propGerm<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>propGerm)<span class="sc">~</span>Test.Temp,<span class="at">data=</span>seedsTemp,<span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in xy.coords(x, y, xlabel, ylabel, log): 5 y values &lt;= 0 omitted from logarithmic plot</span></span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk box10.9Load</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>seedsTemp<span class="sc">$</span>ID <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(seedsTemp<span class="sc">$</span>NumGerm)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ft_temp <span class="ot">=</span> <span class="fu">glmer</span>(<span class="fu">cbind</span>(NumGerm,NumSown<span class="sc">-</span>NumGerm)<span class="sc">~</span><span class="fu">poly</span>(Test.Temp,<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>               (<span class="dv">1</span><span class="sc">|</span>ID),<span class="at">data=</span>seedsTemp,<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_temp)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: binomial  ( logit )</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: cbind(NumGerm, NumSown - NumGerm) ~ poly(Test.Temp, 2) + (1 |      ID)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: seedsTemp</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    212.7    218.1   -102.3    204.7       25 </span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.10831 -0.00896  0.06063  0.13519  0.33025 </span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ID     (Intercept) 2.961    1.721   </span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 29, groups:  ID, 29</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          -0.5896     0.3428  -1.720   0.0854 .</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(Test.Temp, 2)1   2.8770     1.9395   1.483   0.1380  </span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(Test.Temp, 2)2  -3.6910     1.9227  -1.920   0.0549 .</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             (Intr) p(T.T,2)1</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ply(T.T,2)1 -0.060          </span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ply(T.T,2)2  0.066 -0.147</span></span></code></pre></div>
</div>
<div id="exercise-10.8-anthonys-ant-data." class="section level2">
<h2>Exercise 10.8: Anthony’s ant data.</h2>
<p><em>Which model do you think is more appropriate for this dataset – a
Poisson or negative binomial?</em></p>
<p>This is a hard question to answer without fitting a model.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ants <span class="ot">=</span> reveg<span class="sc">$</span>abund<span class="sc">$</span>Formicidae</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ants_Poisson <span class="ot">=</span> <span class="fu">glm</span>(ants<span class="sc">~</span>treatment,<span class="at">data=</span>reveg,<span class="at">family=</span><span class="fu">poisson</span>())</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ants_Poisson, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p>OK so a Poisson fit is <strong>spectacularly</strong> bad. Neither
smoother stays in its envelope, and the data on the normal quantile plot
do not stay anywhere near their envelope.</p>
<p><em>Plot the data – does there seem to be evidence of a treatment
effect?</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(reveg,<span class="fu">boxplot</span>(abund<span class="sc">$</span>Formicidae<span class="sc">~</span>treatment))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk ex10.8plot</p>
</div>
<p>Not really! The ant counts in the control sites are similar to the
middle of those from the revegetated sites.</p>
<p><em>Use the <code>glm</code> function to fit a Poisson log-linear
model, and use this to test for a treatment effect. Did you get what you
expected?</em></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ants_Poisson,<span class="at">test=</span><span class="st">&#39;Chisq&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: poisson, link: log</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: ants</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                          9     985.74              </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment  1   62.345         8     923.39 2.882e-15 ***</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Whoah we are being told there is strongly significant evidence of a
treatment effect, a claim that should be treated with suspicion (no such
evidence on the boxplot above!)</p>
<p><em>Now use negative binomial regression to test for a treatment
effect.</em></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ants <span class="ot">=</span> reveg<span class="sc">$</span>abund<span class="sc">$</span>Formicidae</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ants_NB <span class="ot">=</span> <span class="fu">manyglm</span>(ants<span class="sc">~</span>treatment,<span class="at">data=</span>reveg,<span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ants_NB)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 0 sec</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: ants ~ treatment</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                       </span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 0.765     0.56</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p><em>Notice you have got a very different answer.</em></p>
<p>Yeah, like completely the opposite!!!</p>
<p><em>Which answer is more likely to be correct in this case?</em></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ants_NB,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span></code></pre></div>
<p>Whereas the diagnostic plots for the Poisson model showed serious
problems, we have no such issues here. So the negative binomial
regression is a much better fit to the data. It produced (much!) larger
<span class="math inline">\(P\)</span>-values because there is a lot of
overdispersion in the data, which a Poisson model is unable to account
for.</p>
<p>(Note that the simulation envelopes cover a broad range! This is
because of the small sample size. When comparing these plots to those
for the Poisson fit, notice that the y-axis scale on the negative
binomial plot is much smaller – the envelopes actually have similar
width in both sets of plots, they look different mostly because the axes
have different scales.)</p>
</div>
<div id="exercise-10.9-worm-counts-with-different-numbers-of-pitfall-traps" class="section level2">
<h2>Exercise 10.9: Worm counts with different numbers of pitfall
traps</h2>
<p><em>How can we account for the different sampling effort at different
sites in our model?</em></p>
<p>Use an offset for <code>log(pitfalls)</code> as in Code Box 10.9.</p>
</div>
<div id="code-box-10.10-adding-an-offset-to-the-model-for-worm-counts." class="section level2">
<h2>Code Box 10.10: Adding an offset to the model for worm counts.</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ftmany_hapoffset <span class="ot">=</span> <span class="fu">manyglm</span>(Haplotaxida<span class="sc">~</span>treatment<span class="sc">+</span><span class="fu">offset</span>(<span class="fu">log</span>(pitfalls)),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family=</span><span class="st">&quot;negative.binomial&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftmany_hapoffset)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 0 sec</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: Haplotaxida ~ treatment + offset(log(pitfalls))</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                       </span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 2.889    0.157</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
</div>
<div id="exercise-10.10-anthonys-cockroaches" class="section level2">
<h2>Exercise 10.10: Anthony’s cockroaches</h2>
<p><em>How should he analyse the data?</em></p>
<p>This looks like Exercise 10.9 and so could be analysed a similar way,
assuming assumptions are all satisfied. The main difference here is that
we have many zeros in the dataset (70%)…</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>roaches <span class="ot">=</span> reveg<span class="sc">$</span>abund<span class="sc">$</span>Blattodea</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ftMany_roaches <span class="ot">=</span> <span class="fu">manyglm</span>(roaches<span class="sc">~</span>treatment,<span class="at">offset=</span><span class="fu">log</span>(pitfalls), <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">data=</span>reveg)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ftMany_roaches, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n.sim=</span><span class="dv">99</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in matrix(NA, nPred, n.sim): object &#39;n.sim&#39; not found</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftMany_roaches)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 0 sec</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: roaches ~ treatment</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)   </span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      9                          </span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment        8       1 16.68    0.006 **</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p>Although we have many zeros in the dataset, they are all in the
treatment group, meaning that our observed predictor explains these
well. A Poisson model seems to fit the reasonably data well, and we can
conclude that there is very strong evidence of an effect of revegetation
on cockroaches (they disappeared from revegetated plots).</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
