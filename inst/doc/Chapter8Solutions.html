<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2025-06-06" />

<title>Chapter 8 – Wiggly Models – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 8 – Wiggly Models – Exercise
solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2025-06-06</h4>



<div id="code-box-8.1-fitting-a-spline-smoother-to-the-mauna-loa-annual-data-of-exercise-8.1-on-r." class="section level2">
<h2>Code Box 8.1: Fitting a spline smoother to the Mauna Loa annual data
of Exercise 8.1 on <code>R</code>.</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: nlme</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;nlme&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:lme4&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt;     lmList</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; This is mgcv 1.9-3. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">data</span>(maunaloa)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>maunaJan <span class="ot">=</span> maunaloa[maunaloa<span class="sc">$</span>month<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>ft_maunagam<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year), <span class="at">data=</span>maunaJan)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">summary</span>(ft_maunagam)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; co2 ~ s(year)</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; (Intercept) 356.68048    0.05378    6632   &lt;2e-16 ***</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co">#&gt;           edf Ref.df     F p-value    </span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#&gt; s(year) 8.427  8.908 33847  &lt;2e-16 ***</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =      1   Deviance explained =  100%</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="co">#&gt; GCV = 0.2143  Scale est. = 0.18223   n = 63</span></span></code></pre></div>
</div>
<div id="code-box-8.2-residual-plot-from-a-gam-of-the-annual-mauna-loa-data-of-exercise-8.1" class="section level2">
<h2>Code Box 8.2: Residual plot from a GAM of the annual Mauna Loa data
of Exercise 8.1</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_maunagam)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>Do you think assumptions are satisfied?</em></p>
<p>It generally looks good, although there are a couple of lines of
points fanning out on the residuals vs fits plot for
<code>co2&lt;320</code>. (The method of taking measurements actually
changed in 1974, at about <code>co2=330</code>, so it is possible that
this could be artefacts due to changes in the measurement or recording
process for data in the 1950’s and 1960’s.)</p>
<p>Note the simulation envelope around the trend line in the residual vs
fits plot is hard to see – this is because it falls very close to the
horizontal line at zero. This happens because of the way the smoother
against year is fitted – it is done in such a way that the residual
trend is (nearly) completely removed.</p>
</div>
<div id="code-box-8.3-comparing-curves-for-the-mauna-loa-data." class="section level2">
<h2>Code Box 8.3: Comparing curves for the Mauna Loa data.</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>maunaJan<span class="sc">$</span>year00 <span class="ot">=</span> <span class="fu">pmax</span>(<span class="dv">2000</span>,maunaJan<span class="sc">$</span>year)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ft_maunaPiece <span class="ot">=</span> <span class="fu">lm</span>(co2<span class="sc">~</span>year<span class="sc">+</span>year00,<span class="at">data=</span>maunaJan)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>ft_maunagam20 <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year,<span class="at">k=</span><span class="dv">20</span>), <span class="at">data=</span>maunaJan)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">summary</span>(ft_maunagam20)<span class="sc">$</span>edf <span class="co"># this gam added about 6 extra knots:</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; [1] 15.01983</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">BIC</span>(ft_maunaPiece,ft_maunagam,ft_maunagam20)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;                     df      BIC</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; ft_maunaPiece  4.00000 252.2672</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; ft_maunagam   10.42712 104.5190</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; ft_maunagam20 17.01983 104.7728</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>isTrain <span class="ot">=</span> <span class="fu">which</span>(maunaJan<span class="sc">$</span>year<span class="sc">&lt;=</span><span class="dv">2006</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>datTrain <span class="ot">=</span> maunaJan[isTrain,]</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>datTest <span class="ot">=</span> maunaJan[<span class="sc">-</span>isTrain,]</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>ft_piece <span class="ot">=</span> <span class="fu">lm</span>(co2<span class="sc">~</span>year<span class="sc">+</span>year00,<span class="at">dat=</span>datTrain)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>ft_gam <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year),<span class="at">dat=</span>datTrain)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>ft_gam20 <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year,<span class="at">k=</span><span class="dv">20</span>),<span class="at">dat=</span>datTrain)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>pr_piece <span class="ot">=</span> <span class="fu">predict</span>(ft_piece,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>pr_gam <span class="ot">=</span> <span class="fu">predict</span>(ft_gam,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>pr_gam20 <span class="ot">=</span> <span class="fu">predict</span>(ft_gam20,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">cbind</span>( <span class="fu">predict</span>(ft_piece,<span class="at">newdata=</span>datTest),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="fu">predict</span>(ft_gam,<span class="at">newdata=</span>datTest), <span class="fu">predict</span>(ft_gam20,<span class="at">newdata=</span>datTest) )</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">apply</span>((datTest<span class="sc">$</span>co2<span class="sc">-</span>preds)<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>,sum)) <span class="co"># getting SS by column</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; [1] 233.36905  99.43189  15.72148</span></span></code></pre></div>
</div>
<div id="exercise-8.2-eucalypt-richness-as-a-function-of-the-environment" class="section level2">
<h2>Exercise 8.2: Eucalypt richness as a function of the
environment</h2>
<p><em>How does species richness vary from one area to the next, and
what are the main environmental correlates of richness? [Ian] thinks
species richness could respond to temperature and rainfall in a
non-linear fashion, and may interact. What sort of model should Ian
consider using?</em></p>
<p>He could try a GAM, as in Code Box 8.4. Note that this doesn’t allow
him to account for spatial autocorrelation at the same time, maybe he
could try <code>gamm</code> as a way forward.</p>
</div>
<div id="code-box-8.4-handling-interactions-in-a-gam-when-modelling-ians-richness-data-as-a-function-of-minimum-temperature-and-rainfall-for-exercise-8.2" class="section level2">
<h2>Code Box 8.4: Handling interactions in a GAM, when modelling Ian’s
richness data as a function of minimum temperature and rainfall, for
Exercise 8.2</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>ft_tmprain<span class="ot">=</span><span class="fu">gam</span>(<span class="fu">log</span>(richness<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span><span class="fu">te</span>(TMP_MIN,RAIN_ANN),<span class="at">data=</span>Myrtaceae)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">vis.gam</span>(ft_tmprain,<span class="at">theta=</span><span class="sc">-</span><span class="dv">135</span>) <span class="co">#rotating the plot to find a nice view</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">summary</span>(ft_tmprain)<span class="sc">$</span>edf</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; [1] 14.89171</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>ft_tmprain2<span class="ot">=</span><span class="fu">gam</span>(<span class="fu">log</span>(richness<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span><span class="fu">s</span>(TMP_MIN)<span class="sc">+</span><span class="fu">s</span>(RAIN_ANN)<span class="sc">+</span>TMP_MIN<span class="sc">*</span>RAIN_ANN,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>      <span class="at">data=</span>Myrtaceae)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">summary</span>(ft_tmprain2)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; log(richness + 1) ~ s(TMP_MIN) + s(RAIN_ANN) + TMP_MIN * RAIN_ANN</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)      6.970e-02  3.268e-02   2.133   0.0332 *  </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; TMP_MIN          2.045e-02  7.029e-02   0.291   0.7712    </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; RAIN_ANN         1.333e-03  1.501e-04   8.883   &lt;2e-16 ***</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; TMP_MIN:RAIN_ANN 1.415e-05  4.060e-05   0.348   0.7276    </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;               edf Ref.df     F p-value    </span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; s(TMP_MIN)  3.945  5.054 2.838  0.0145 *  </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; s(RAIN_ANN) 5.295  6.459 9.695  &lt;2e-16 ***</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; Rank: 20/22</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =   0.12   Deviance explained = 12.9%</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; GCV = 0.15261  Scale est. = 0.15076   n = 1000</span></span></code></pre></div>
</div>
<div id="exercise-8.3-smoothers-for-climate-effects-on-plant-height" class="section level2">
<h2>Exercise 8.3: Smoothers for climate effects on plant height</h2>
<p><em>[Angela] would like to know how plant height relates to climate –
in particular, are there interactions between predictors, and is the
relationship non-linear?</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>ft_1temprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain, <span class="at">dat=</span>globalPlants) <span class="co">#linear model</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>ft_2tempPlusrain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">poly</span>(temp,<span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(rain,<span class="dv">2</span>), <span class="at">dat=</span>globalPlants) <span class="co">#quadratic, no interaction</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>ft_2temprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">poly</span>(temp,<span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(rain,<span class="dv">2</span>)<span class="sc">+</span>rain<span class="sc">:</span>temp, <span class="at">dat=</span>globalPlants) <span class="co">#quadratic, interactions</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>ft_stempPlusrain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">s</span>(temp)<span class="sc">+</span><span class="fu">s</span>(rain), <span class="at">dat=</span>globalPlants) <span class="co">#smoother+no interaction</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>ft_stemprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">s</span>(temp)<span class="sc">+</span><span class="fu">s</span>(rain)<span class="sc">+</span>rain<span class="sc">:</span>temp, <span class="at">dat=</span>globalPlants) <span class="co">#smoother+interaction</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="fu">BIC</span>(ft_1temprain,ft_2tempPlusrain,ft_2temprain,ft_stempPlusrain,ft_stemprain)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;                        df      BIC</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; ft_1temprain     4.000000 482.6809</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; ft_2tempPlusrain 6.000000 489.5603</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; ft_2temprain     7.000000 494.0549</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; ft_stempPlusrain 4.495239 483.6918</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; ft_stemprain     5.000000 484.6240</span></span></code></pre></div>
<p>And the winner is a linear model.</p>
</div>
<div id="code-box-8.5-residual-plot-with-a-smoother-to-diagnose-a-model." class="section level2">
<h2>Code Box 8.5: Residual plot with a smoother to diagnose a
model.</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>globalPlants<span class="sc">$</span>logHt <span class="ot">=</span> <span class="fu">log</span>(globalPlants<span class="sc">$</span>height)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>ft_heightlm <span class="ot">=</span> <span class="fu">lm</span>(logHt<span class="sc">~</span>lat,<span class="at">dat=</span>globalPlants)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">plot</span>(ft_heightlm,<span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ft_temp <span class="ot">=</span> <span class="fu">gam</span>(logHt<span class="sc">~</span><span class="fu">s</span>(temp), <span class="at">dat=</span>globalPlants)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>ecostats<span class="sc">::</span><span class="fu">plotenvelope</span>(ft_temp, <span class="at">which=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-8.4-nonlinear-predictors-of-species-richness" class="section level2">
<h2>Exercise 8.4: Nonlinear predictors of species richness?</h2>
<p><em>Refit the model using smoothers for each environmental variable
and compare to a model with additive quadratic terms (assume conditional
independence for the moment).</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>), <span class="at">data=</span>Myrtaceae)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>ft_richSmooth <span class="ot">=</span> <span class="fu">gam</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">s</span>(TMP_MAX)<span class="sc">+</span><span class="fu">s</span>(TMP_MIN)<span class="sc">+</span><span class="fu">s</span>(RAIN_ANN),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                    <span class="at">data=</span>Myrtaceae)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAdd,ft_richSmooth)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt;                     df      BIC</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; ft_richAdd    16.00000 1002.806</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; ft_richSmooth 21.89962 1013.921</span></span></code></pre></div>
<p>It looks like the model with additive terms is a better fit.</p>
<p><em>We could try refitting the model to account for this, using the
<code>gamm</code> function in the <code>mgcv</code> package. Do you
think this would make any difference to our conclusion? Justify your
argument.</em></p>
<p>I’m not going to try refitting, I don’t think it would make any
difference. The main thing that happens if you have spatial structure in
your data that you haven’t accounted for is that you get <em>false
confidence</em>: standard errors and <em>P</em>-values are too small. In
a model selection context, this means that you can end up saying terms
should be in the model that you don’t actually need in there, so you end
up with an overly complicated model. But in this case, we have already
concluded that we don’t need the more complicated model, with the extra
smoother terms in it.</p>
</div>
<div id="exercise-8.5-carbon-dioxide-measurements-at-mauna-loa-observatory" class="section level2">
<h2>Exercise 8.5: Carbon dioxide measurements at Mauna Loa
observatory</h2>
<p><em>We would like to model the dataset to characterise the key trends
within as well as across years, taking into account that carbon dioxide
does not follow a linear trend over time, and that there is a periodic
seasonal oscillation… What sort of model would you use?</em></p>
<p>We can fit an additive model with a smoother for the long-term trend,
and harmonics (sin/cos terms) for the seasonal trend.</p>
</div>
<div id="code-box-8.6-a-simple-model-for-the-mauna-loa-monthly-data-with-a-cyclical-predictor" class="section level2">
<h2>Code Box 8.6: A simple model for the Mauna Loa monthly data with a
cyclical predictor</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">data</span>(maunaloa)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>ft_cyclic<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">data=</span>maunaloa)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">plot</span>(maunaloa<span class="sc">$</span>co2<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">expression</span>(CO[<span class="dv">2</span>]),<span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">predict</span>(ft_cyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-8.7-residual-plots-across-time-and-season-for-the-mauna-loa-monthly-data" class="section level2">
<h2>Code Box 8.7: Residual plots across time and season for the Mauna
Loa monthly data</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here is some code to produce a simulated dataset from this model, for
comparison:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>maunaloa<span class="sc">$</span>simCO2 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">simulate</span>(ft_cyclic))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>ft_simCyclic<span class="ot">=</span><span class="fu">gam</span>(simCO2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">data=</span>maunaloa)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_simCyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_simCyclic)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-8.8-another-model-for-the-mauna-loa-monthly-data-with-an-extra-sine-curve-in-there-to-better-handle-irregularities-in-the-seasonal-effect" class="section level2">
<h2>Code Box 8.8: Another model for the Mauna Loa monthly data, with an
extra sine curve in there to better handle irregularities in the
seasonal effect}</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ft_cyclic2<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi),<span class="at">data=</span>maunaloa)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic2)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic2)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-8.9-mauna-loa-model-with-autocorrelation" class="section level2">
<h2>Code Box 8.9: Mauna Loa model with autocorrelation}</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>ft_gamm <span class="ot">=</span> <span class="fu">gamm</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi),<span class="at">correlation=</span><span class="fu">corAR1</span>(),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                <span class="at">data=</span>maunaloa)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gamm<span class="sc">$</span>gam))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gamm<span class="sc">$</span>lme,<span class="at">type=</span><span class="st">&quot;normalized&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-8.6-mauna-loa-monthly-data-an-extra-term-in-seasonal-trend" class="section level2">
<h2>Exercise 8.6: Mauna Loa monthly data – an extra term in seasonal
trend?</h2>
<p><em>We tried modelling the trend by fitting sine curves with two
frequencies… Is this sufficient, or should we add another frequency too,
like <code>month/12*6*pi</code> (for curves with three cycles a
year)?</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>ft_cyclic3<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>       <span class="sc">+</span> <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi), <span class="at">data=</span>maunaloa)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>ft_cyclic4<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>       <span class="sc">+</span> <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>         <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">8</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">8</span><span class="sc">*</span>pi), <span class="at">data=</span>maunaloa)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic4)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic4)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">BIC</span>(ft_cyclic,ft_cyclic2,ft_cyclic3,ft_cyclic4)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt;                  df      BIC</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; ft_cyclic  12.85033 1773.254</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; ft_cyclic2 14.93624 1135.151</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; ft_cyclic3 16.93686 1138.438</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; ft_cyclic4 18.93753 1141.922</span></span></code></pre></div>
<p>According to BIC, 2 harmonics is the winner, there isn’t much to gain
from adding a third or fourth.</p>
</div>
<div id="exercise-8.7-mauna-loa-annual-data-temporal-autocorrelation" class="section level2">
<h2>Exercise 8.7: Mauna Loa annual data – temporal
autocorrelation?}</h2>
<p><em>Consider the annual Mauna Loa monthly data of Code Box 8.1, which
uses the measurements from January only… Is there evidence of temporal
autocorrelation in this dataset?</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>maunaJan <span class="ot">=</span> maunaloa[maunaloa<span class="sc">$</span>month<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>ft_gammJan <span class="ot">=</span> <span class="fu">gamm</span>(co2<span class="sc">~</span><span class="fu">s</span>(year),<span class="at">correlation=</span><span class="fu">corAR1</span>(), <span class="at">data=</span>maunaJan)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gammJan<span class="sc">$</span>gam))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gammJan<span class="sc">$</span>lme,<span class="at">type=</span><span class="st">&quot;normalized&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>ft_gammJan<span class="sc">$</span>lme</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#&gt; Linear mixed-effects model fit by maximum likelihood</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt;   Data: strip.offset(mf) </span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;   Log-likelihood: -51.70909</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt;   Fixed: y ~ X - 1 </span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; X(Intercept)  Xs(year)Fx1 </span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;     356.6783      29.9981 </span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;  Formula: ~Xr - 1 | g</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;  Structure: pdIdnot</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;              Xr1      Xr2      Xr3      Xr4      Xr5      Xr6      Xr7      Xr8</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; StdDev: 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;          Residual</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; StdDev: 0.4428823</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt; Correlation Structure: AR(1)</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt;  Formula: ~1 | g </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;       Phi </span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt; 0.2638297 </span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; Number of Observations: 63</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; Number of Groups: 1</span></span></code></pre></div>
<p>There isn’t really an autocorrelation signal here – the lags
represent years now rather than months, and consecutive years (lag 1)
have a correlation of less than 0.1 so it looks like not much is
happening. The mixed effects model doesn’t really do much here. The
estimated autocorrelation is surprisingly large given this (0.26) but it
is much smaller than in the monthly analysis (0.76) and decays to
negligible levels quickly (correlation at two years is 0.26^2=0.07).</p>
</div>
<div id="exercise-8.8-aspect-as-a-predictor-of-species-richness" class="section level2">
<h2>Exercise 8.8: Aspect as a predictor of species richness</h2>
<p><em>Consider Ian’s species richness data… How would you enter
<code>aspect</code> into the model?</em> This is a cyclical variable so
we would add <code>cos</code> and <code>sin</code> terms to the
model.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">summary</span>(Myrtaceae<span class="sc">$</span>aspect)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt;   0.06518  91.07251 176.07360 181.51909 271.80242 359.89480</span></span></code></pre></div>
<p>It seems to have been entered in degrees so has period 360. Maybe we
can consider two harmonics to try to account for non-sinusoidal
response. We will keep soil, temperature and rainfall variables from
previously:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>ft_richAsp <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>               <span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>     <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>), <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAsp,ft_richAdd)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt;            df      BIC</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; ft_richAsp 20 1026.860</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; ft_richAdd 16 1002.806</span></span></code></pre></div>
<p>It looks like there isn’t really an <code>aspect</code> signal in the
data, BIC is much smaller without any aspect terms being in the
model.</p>
<p><em>Recall that species richness had some spatial structure to it.
Refit the model using the <code>gls</code> function from the
<code>nlme</code> package to account for spatially structured
correlation. Did this change your inferences about <code>aspect</code>
in any appreciable way?</em></p>
<p>Well it won’t change our inferences because ignoring spatial
correlation risks giving you false confidence in the importance of
terms, but we already decided that <code>aspect</code> is not important.
But anyway. We decided last time around that an exponential model with a
nugget effect did OK:</p>
<p><em>This code chunk is not run, because it will take several
minutes:</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>ft_richNugg <span class="ot">=</span> <span class="fu">gls</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>       <span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),<span class="at">data=</span>Myrtaceae,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>         <span class="at">correlation=</span><span class="fu">corExp</span>(<span class="at">form=</span><span class="sc">~</span>X<span class="sc">+</span>Y,<span class="at">nugget=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>ft_richAspNugg <span class="ot">=</span> <span class="fu">gls</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>       <span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span> <span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>),<span class="at">data=</span>Myrtaceae,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>         <span class="at">correlation=</span><span class="fu">corExp</span>(<span class="at">form=</span><span class="sc">~</span>X<span class="sc">+</span>Y,<span class="at">nugget=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="fu">BIC</span>(ft_richNugg)</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAspNugg)</span></code></pre></div>
<p>As expected, this did not change inference in any appreciable
way!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
