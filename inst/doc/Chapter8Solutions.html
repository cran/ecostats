<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-05-30" />

<title>Chapter 8 – Wiggly Models – Exercise solutions and Code Boxes</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Chapter 8 – Wiggly Models – Exercise solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-05-30</h4>



<div id="code-box-8.1-fitting-a-spline-smoother-to-the-mauna-loa-annual-data-of-exercise-8.1-on-r." class="section level2">
<h2>Code Box 8.1: Fitting a spline smoother to the Mauna Loa annual data of Exercise 8.1 on <code>R</code>.</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; This is mgcv 1.8-40. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;mgcv&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:VGAM&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     s</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(maunaloa)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>maunaJan <span class="ot">=</span> maunaloa[maunaloa<span class="sc">$</span>month<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>ft_maunagam<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year), <span class="at">data=</span>maunaJan)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_maunagam)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; co2 ~ s(year)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 356.68048    0.05378    6632   &lt;2e-16 ***</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           edf Ref.df     F p-value    </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(year) 8.427  8.908 33847  &lt;2e-16 ***</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =      1   Deviance explained =  100%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GCV = 0.2143  Scale est. = 0.18223   n = 63</span></span></code></pre></div>
</div>
<div id="code-box-8.2-residual-plot-from-a-gam-of-the-annual-mauna-loa-data-of-exercise-8.1" class="section level2">
<h2>Code Box 8.2: Residual plot from a GAM of the annual Mauna Loa data of Exercise 8.1</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_maunagam)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYLDgQ6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv9rjiOQOgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbkJDbtmbbtpDb25Db27bb29vb/7bb///w8+n/tmb/25D/27b//7b//9v///9nHdJZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANiklEQVR4nO2dCWPbthXHac/erGw9UinZ1TWSu9PM1i5buC3LatKR9P0/0gA8nCSBRwLgIff9W9uKBOL46eHhIAAWZ1JQxdIZWLsIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhygOoLIo9+3PcFXejrz3dF7eP+h8fflkUxedvHkNXOFf/9T3E4ESjVRWgL961EjJXI8oGiKedDOj4Whbo5t2wiz+9vh4EqLh66AEkrkaUDRA3oVRA7KUSnnOZsAqIAOpFWA5IJh8glpYCxOvJT75+FBm8+uPr4vp79sGHz4qrN+d/vShuHkQYbixfPDglY8W54rXrw4ui2Kr8s0i3dnge51/eFiKaUrD8p2VBJ/bJ1VeaQwUIPu2YCamEdO7KId9EPkCsGBJQpb4z9fL2h538Hj9TeWp6LJ+9uhLweETsPRuQCa+tgr3uADpCQjeq1BIQh6oAmdzNCuj6VywpAPT0gqdeCSNgv2/fnf/H8709/4fl5w18wDL7s0cecmsBsmpoCcXXgKzwPALmoipjZJYPYv9+J4PZgD7u2F8IYeduzip2/R3LFZRQJiv+VLp5g6/39tFk/+PfmD3dWYCcgrmArPAyThb4rgNIhq10wbs+yM7drIDesy/9zzurwKKMFVQaIKcNjBXi9C3keyggE17GaX0ZBhCLwVRFB5Cqy07u5gXEMvdTnmlVURr+RfsA8fbq5g8fdw4g5cK+4sXQX3A7fAhQU/QDunqp+kFO7uYFBJkZaEFgLEcXEDhp9ubVrwtTG9rhEQvaOxmrLARLWxC0IB0f1A+oUX7EdtLQzLPuG7SJ8uKmcMOHAHU6Yh1AC/ogsOdOK+a1oNvHT/euD1KNtNVH2J55ICe8A6hqOZdSEN5ZyNuAenI3GyBevk4/yO+DOk76LI1HeI2vRVlATngHUNPfD9Ll7gKyc9fM2Q/i6TSF1ZP+HWQw0Ird/KnS3RNVCBis/ga60k+M18vvd254BxDvON/83XIun75ll77UI7keQFbuxNXIqG+l0x2nt18OHtBPq5UCWo8IECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQosyAiovRUoDyRjeBJBsCZKm2tKkhkwTIksOHAeK5JEBGNQEKqiZAYdWbzYZ8kF/caGqbELVijiQbixC8T4CkCFBYNQEKSrGx+BAgS9It263YQoDGjwHnUN0r+IwsyMeHACl5+BAgKR8fAgTy8iFAQn4+8YCOu604SSJpp99KAAGKVvueCqjk287vzuX4A256o1tSkk/t9hClDiLIeEDH3f7cFOxn4Mk9SHRLyvDpEjoAn0hAJd9TfPGAaj+gwyGlit0dd/zsgouvYn5Ah0QnLQ4hSuKzBkAaR9sHHQ5pTjqL1gSo1YodUluxLFoeULfZss2HAGF4IgFZx64MPaAvFN1y8vCx/wEBJ7Eg3tdGjkxZFlC/9zk4fCYHVMGRm/v06LLL8KlN+9XCk9bMI1WMA5JoKs+QbUFAtcNH/W7jSRuLVXfnpxce2zgDIPm5b0CyHKC6D1DHfBIA8dI3/PAq/3B+xRbkIFCA+vCkANqfn37xXvx4BJXw7qzcdSi6edViAD6oF088oNM9M49XDyFAZzkeYQ2Zh89CgFw6rAVjP/3mk+KD+DC+3Iaq2Kjo5lOf9fjMJwUQnyo77tL6iUsA6phP3e+c0wGNkW/WaH5ALfPZCOfcN9U6L6B2LEvdWe2YD9SuKQDp4dgFjcXckhvzCfFJtaC0KeklAW1k16f/Xka+Kha8q6FODF3HYLVTv1jtQswnA6CQCVWq/+PtCM0JqEVnkPlkABS4q8H7kirU8kMNp3ax/w4DzCcio+2Aobsa1iTH4oPVVu1i5rMJm09sRjutWKAjvSILstCA8zmAkw5CicroqBJV6kD0hX2QU7W4DrKNH4IGNFFHETWzWQBZVct0fWT9GhrHM560d1zPRuMZaDlKERYE1abBT3nPkm6sWk0Xa7xgemMcnrj5IGi+Vj3d4TZdbu0aF1PcjCLXqpe/2E2X6PqoVmx0THEzilzlei1ImY6eNFQNV0RcUT6Im1C1Wh/keGZwzuMaLkcxzbxoytKWKE4IyKpbpnbF4nmGixccOmZgER3fMwNk4REdZ8knIcZnBajYGMe8kV2fzSYxznEBj7vtaqdcbeuppfkk1C2p52NBtQ1H4EmqWkrPBpCsWgrTIckzW4oAtMqtCLVlPPJ2cp6IIwCtbyuCNSOm8WTi8yy2IughqZw0jB1V9CoOUPRWhAnurJpRRQ2zPhnpnOOq2Kq2ItS16fdkrl1CUU56NVsRamfgxaecM+O58GbeOJ8axqXZ8VwyoNasBphPhpy1FDndcftY+hbXZU7Xo/b9nI3Z4ZVXMRNmVw8Vd9JJhNIA2fcraj3uSorSp7gpVz5hv+COQ2c+nv8/gXNWiusHcUCLdRTd+1111oFFV/EWtMikfW1L1a7pzOec4IOq1vPIp0rXVu3yEQt5s0z6BBQ9aZ92UyMGUN2SWaealBNEF9MP6uCRk2JTtV5KCYD+PZ+TbtOp5ZRznWfWMKTRgCo5GX26D+8Xy7njsMd41ELDxCl5XGMB8UUdvP1qCu8+lbw7DvvgiLZd/J5+lchIQGIQz0pdBZ10rv1ivXDUYg3+t1gdIGEbp/vPi+BkR44dhx23o0ddousj7GcGPuMB8WKXgeoFoVItqItHrYOq5UJDhmeWHR9xgJBOdOKOwx46FiC1FGpoxhMVBwifTYzdcdgPRwEyS6GGZjtZUwGKSdfPRrtnwDN13wfLaCDgNID8ZmPNGNbydnI9cdc5lFE84OhlwOEdhwEytZkOgwZMLpKfF8/SY7EwH7ijU+spZ1hpmDcfAzOaM+CY6ILWU9eKjpwU29RTj0y9Gc0ZMByLe2cVsR4AJLaXys0Es/OZCtDAHYcBPrJZN+tUp5/ZCGQ0Z0CuoTsOQ4BqecNiYzZvj8lCLk0CaPB+sSAg6YfM1v8ROcinSQAN3nHY45f1rva6fTTCiAxk1HosaOP8SOvpnLk2u6byQdKEhvsgdZaP71SoMcnn1ESt2MAdh0FAhzXwWU9HsQ1oHXimBWS5Ik90fh/Uc6LhMloPILsVO6yGz5oAGfUd+LiUVgio90DMxbQooKLniIj2oVnjk82rJVuxQj+0yle7ftyACthDEDKf5fmsClDPkXR5E43MaOaAg6NrA+o7sS9vopEZzRxweHSOD+o90TBvmlFadKhh7h2rx3ysT8uOxZRWi2dBQJYOh+5T3tejhQDFJIFmYfIIpro2UxIEKDULBGjpCKa6NlMSBCg1CwRo6QimujZTEgQoNQvPHdBliwAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEaHpAYvtCeDNs6LmKDXpcRvipjAOSD2pyQKd7Vr4quJ36uPPvUeMb+sNPaghdPSj5sCYHBPvIQ8c2NYHNMbBYK7QVMnT1oOQRzeSDAkbQFFv/oU5o+YJXD0ke00yAymAhAoB+/hD8PHz1wOSDmgeQfx85fOzNP3z1YQPAASHJBzULoAZxkhMDwpIPag5A6Bc4bRVLsZ9pAVXQA6l8GaxUDyXBSQevlqkseDLkEA04Ns5fRLyZxwAlnlo3Rz8I/wIDRcQ7imFAQ5IPanJAFSzoinazFTrUCAIaknxQNFhFRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBE0wHST1q4/ofvWVJtNfv+506ZNxv8PruMxPsAq5Ga1oJg/dPQvHrDqQ/g4WfhBRsq7I8SkFxIJZ9QFQ57WYB++6IQ65jMmjJ4cXz1e77KGd5+YoFuf9ipcHzRVFmI62Rh9SOXyjt4S/zSYb5hdXqvIxGfqfT4u5ELqeYBxFe7yx9RQZqCl4AXk59Mrd7WroO/wWnwlWXwem9iO4sVQRqQCQMJqEjEg3VlxMLkmjhC8wDainohn5F4/R4W1jW8NFv96EQoNPyApRxfPUB9koD0SrMGOPD3rTAqEQ1IR5zy9OHZfBD7BQVkhQAnIktz1m+rstk+pimKICA3jKCiAVkRr3UheQuQbPclIFmas35bA1JViT+68ztjQb1VzAnTAqQihi0/a/ZBtgWdVTPkWpAMZ1uQ+GtVMeOk+WPfIU43TJ8FKZVx6xTnBKRbXssH7a0Gue2DhOtoTBUTzfzp/va/wqGDy3HDuIDclj6y3Z8TkGhVxDdpWjHRqMu39UMm+Run+zswjGJrylYKQvyhDIzTI3u1d8NIz2y3YjxiYUqRO35mBST6JcJfqn6QfOamfLts9YPEEuBSGpqQdCssMB/JfAM+yIQR7X6rHwQmFr0S+DIHq2/Tnmk+RpcJaEYRIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAjR/wHlTrEUNQXZKwAAAABJRU5ErkJggg==" /><!-- --></p>
<p><em>Do you think assumptions are satisfied?</em></p>
<p>It generally looks good, although there are a couple of lines of points fanning out on the residuals vs fits plot for <code>co2&lt;320</code>. (The method of taking measurements actually changed in 1974, at about <code>co2=330</code>, so it is possible that this could be artefacts due to changes in the measurement or recording process for data in the 1950’s and 1960’s.)</p>
<p>Note the simulation envelope around the trend line in the residual vs fits plot is hard to see – this is because it falls very close to the horizontal line at zero. The smoother against year was actually fitted such that the residual trend would be a horizontal line at zero.</p>
</div>
<div id="code-box-8.3-comparing-curves-for-the-mauna-loa-data." class="section level2">
<h2>Code Box 8.3: Comparing curves for the Mauna Loa data.</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>maunaJan<span class="sc">$</span>year00 <span class="ot">=</span> <span class="fu">pmax</span>(<span class="dv">2000</span>,maunaJan<span class="sc">$</span>year)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ft_maunaPiece <span class="ot">=</span> <span class="fu">lm</span>(co2<span class="sc">~</span>year<span class="sc">+</span>year00,<span class="at">data=</span>maunaJan)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ft_maunagam20 <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year,<span class="at">k=</span><span class="dv">20</span>), <span class="at">data=</span>maunaJan)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_maunagam20)<span class="sc">$</span>edf <span class="co"># this gam added about 6 extra knots:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 15.01983</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_maunaPiece,ft_maunagam,ft_maunagam20)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     df      BIC</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_maunaPiece  4.00000 252.2672</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_maunagam   10.42712 104.5190</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_maunagam20 17.01983 104.7728</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>isTrain <span class="ot">=</span> <span class="fu">which</span>(maunaJan<span class="sc">$</span>year<span class="sc">&lt;=</span><span class="dv">2006</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>datTrain <span class="ot">=</span> maunaJan[isTrain,]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>datTest <span class="ot">=</span> maunaJan[<span class="sc">-</span>isTrain,]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ft_piece <span class="ot">=</span> <span class="fu">lm</span>(co2<span class="sc">~</span>year<span class="sc">+</span>year00,<span class="at">dat=</span>datTrain)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ft_gam <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year),<span class="at">dat=</span>datTrain)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ft_gam20 <span class="ot">=</span> <span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(year,<span class="at">k=</span><span class="dv">20</span>),<span class="at">dat=</span>datTrain)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>pr_piece <span class="ot">=</span> <span class="fu">predict</span>(ft_piece,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>pr_gam <span class="ot">=</span> <span class="fu">predict</span>(ft_gam,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>pr_gam20 <span class="ot">=</span> <span class="fu">predict</span>(ft_gam20,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">cbind</span>( <span class="fu">predict</span>(ft_piece,<span class="at">newdata=</span>datTest),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(ft_gam,<span class="at">newdata=</span>datTest), <span class="fu">predict</span>(ft_gam20,<span class="at">newdata=</span>datTest) )</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">apply</span>((datTest<span class="sc">$</span>co2<span class="sc">-</span>preds)<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>,sum)) <span class="co"># getting SS by column</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 233.36905  99.43189  15.72148</span></span></code></pre></div>
</div>
<div id="exercise-8.2-eucalypt-richness-as-a-function-of-the-environment" class="section level2">
<h2>Exercise 8.2: Eucalypt richness as a function of the environment</h2>
<p><em>How does  species richness vary from one area to the next, and what are the main environmental correlates of richness? [Ian] thinks species richness could respond to temperature and rainfall in a non-linear fashion, and may interact. What sort of model should Ian consider using?</em></p>
<p>He could try a GAM, as in Code Box 8.4. Note that this doesn’t allow him to account for spatial autocorrelation at the same time, maybe he could try <code>gamm</code> as a way forward.</p>
</div>
<div id="code-box-8.4-handling-interactions-in-a-gam-when-modelling-ians-richness-data-as-a-function-of-minimum-temperature-and-rainfall-for-exercise-8.2" class="section level2">
<h2>Code Box 8.4: Handling interactions in a GAM, when modelling Ian’s richness data as a function of minimum temperature and rainfall, for Exercise 8.2</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ft_tmprain<span class="ot">=</span><span class="fu">gam</span>(<span class="fu">log</span>(richness<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span><span class="fu">te</span>(TMP_MIN,RAIN_ANN),<span class="at">data=</span>Myrtaceae)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vis.gam</span>(ft_tmprain,<span class="at">theta=</span><span class="sc">-</span><span class="dv">135</span>) <span class="co">#rotating the plot to find a nice view</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_tmprain)<span class="sc">$</span>edf</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 14.89171</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ft_tmprain2<span class="ot">=</span><span class="fu">gam</span>(<span class="fu">log</span>(richness<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span><span class="fu">s</span>(TMP_MIN)<span class="sc">+</span><span class="fu">s</span>(RAIN_ANN)<span class="sc">+</span>TMP_MIN<span class="sc">*</span>RAIN_ANN,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>Myrtaceae)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ft_tmprain2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(richness + 1) ~ s(TMP_MIN) + s(RAIN_ANN) + TMP_MIN * RAIN_ANN</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      6.970e-02  3.268e-02   2.133   0.0332 *  </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TMP_MIN          2.045e-02  7.029e-02   0.291   0.7712    </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RAIN_ANN         1.333e-03  1.501e-04   8.883   &lt;2e-16 ***</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TMP_MIN:RAIN_ANN 1.415e-05  4.060e-05   0.348   0.7276    </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               edf Ref.df     F p-value    </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(TMP_MIN)  3.945  5.054 2.838  0.0145 *  </span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(RAIN_ANN) 5.295  6.459 9.695  &lt;2e-16 ***</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rank: 20/22</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =   0.12   Deviance explained = 12.9%</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GCV = 0.15261  Scale est. = 0.15076   n = 1000</span></span></code></pre></div>
</div>
<div id="exercise-8.3-smoothers-for-climate-effects-on-plant-height" class="section level2">
<h2>Exercise 8.3: Smoothers for climate effects on plant height</h2>
<p><em>[Angela] would like to know how plant height relates to climate – in particular, are there interactions between predictors, and is the relationship non-linear?</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ft_1temprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain, <span class="at">dat=</span>globalPlants) <span class="co">#linear model</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ft_2tempPlusrain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">poly</span>(temp,<span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(rain,<span class="dv">2</span>), <span class="at">dat=</span>globalPlants) <span class="co">#quadratic, no interaction</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ft_2temprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">poly</span>(temp,<span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(rain,<span class="dv">2</span>)<span class="sc">+</span>rain<span class="sc">:</span>temp, <span class="at">dat=</span>globalPlants) <span class="co">#quadratic, interactions</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ft_stempPlusrain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">s</span>(temp)<span class="sc">+</span><span class="fu">s</span>(rain), <span class="at">dat=</span>globalPlants) <span class="co">#smoother+no interaction</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ft_stemprain <span class="ot">=</span> <span class="fu">gam</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="fu">s</span>(temp)<span class="sc">+</span><span class="fu">s</span>(rain)<span class="sc">+</span>rain<span class="sc">:</span>temp, <span class="at">dat=</span>globalPlants) <span class="co">#smoother+interaction</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_1temprain,ft_2tempPlusrain,ft_2temprain,ft_stempPlusrain,ft_stemprain)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        df      BIC</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_1temprain     4.000000 482.6809</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_2tempPlusrain 6.000000 489.5603</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_2temprain     7.000000 494.0549</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_stempPlusrain 4.495239 483.6918</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_stemprain     5.000000 484.6240</span></span></code></pre></div>
<p>And the winner is a linear model.</p>
</div>
<div id="code-box-8.5-residual-plot-with-a-smoother-to-diagnose-a-model." class="section level2">
<h2>Code Box 8.5: Residual plot with a smoother to diagnose a model.</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>globalPlants<span class="sc">$</span>logHt <span class="ot">=</span> <span class="fu">log</span>(globalPlants<span class="sc">$</span>height)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ft_heightlm <span class="ot">=</span> <span class="fu">lm</span>(logHt<span class="sc">~</span>lat,<span class="at">dat=</span>globalPlants)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ft_heightlm,<span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAclBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQOjqQkGaQtpCQtv+Q2/+2ZgC2tma225C2/7a2//++vr7bkDrbkJDb25Db///fU2v/tmb/25D//7b//9v///8VRisPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAS/0lEQVR4nO2dC2OsphLHSZpN203bTXtvvO2ptzkm8ft/xcpTUMABwcfs/M/Z3awCg/5keIgs60moxfbOAKmuCDByEWDkIsDIRYCRiwAjFwFGLgKMXAQYuQgwchFg5CLAyEWAkYsAIxcBRi4CjFwEGLkIMHIRYOQiwMhFgJGLACMXAUYuAoxcBBi5CDByEWDkIsDIRYCRiwAjFwFGLgKMXAQYuQgwchFg5CLAyEWAkYsAIxcBRi4CjFwEGLkIMHIRYOQiwMhFgJGLACMXAUYuAoxcBBi5CDByEWDkIsDIRYCRiwAjFwFGLgKMXAQYuQgwcp0f8NcrE7p69n2+3NRf3cNbZG9QjUyb3UTYTr1c+ZI+jjAAvvCPjkVp5QJ+enfDe+IQ4LpSgNVHSAT4tNJkBYtW+eqPZ+5XFY5h48MfD2/ii3hrxE7xtwooovCPgda4yQI8hBXbBw2btBmd9MaHnCI0gMVHO5zrj+erhNWpmrN5/Db8bQFuVEgB7aa9u0ynefpn3OQCHkuwNmOS3uGwoUIDuBUFlher7vHb8F/sk2WUs2pGwJ+/vMnyOvytA4oUhr+HFOxNfsDGjEl6kwPNEwbAqqGra8PhtH++SEochwTW2S6al1DpwHVAE5gHswg3Om0bsDFjkt70gNOEAfCFn+3hjWNTPAR1iaOdAR4qzsc/ZQnWAYUG181LrLPJV4KNmZYAbyDpojve6HFPtfLKsxIsHKty0Tqg+Owe/9JtZL3JD1iboRK8hVQd3MhWk7VDeGBdB7cc8HV0rB0bAY+fv2rvbNj762BlxiRd+RDXCA3gzxfefeHnekAtCpUutHwjb+p+vT69D+73JgvvUOJ5I0sFlEk17KK+df4SfJUNLG3GJL3DYUOFBvBQs15lP1gWUMZMkdad1YEq+03WwQ9v2oHLgFKyc2RvcgAPF8DTe6P7waKwUz+YtLMIMHIRYOQiwMhFgJGLACMXAUauwoAZaSPtBbhscqSQCDByVQUsx9iLJUfKUBXAfCxXy572kJkcaYXqlOBOzjSjEry/KrlocU/OAzi9cUdap2p1cCMmFJ62BPOprzfzcWLVa2S17HpGwNK58AmVHz++qY+987RGFVvRH88/nA8wk6/uMnw2N/Wxa45WqmY3iU97KZjcFmLWu5gWbT7OKhrocGQB/nq9Wh+nFQF2NAKWTyXoj/OKALtSdbDuAESaiScRTsAfP33TXZxW9LrhmGQrGg1fXID1+EnHB0itLk5nP7wLkrosUq+OAwoTYO1em4f/DCV47OKA2sFYB9cQAbZawMJF9xpte4FFzsvTwa+M0wEW59N7UueAZRcHUoDt/m9ifjLjbaWzARbn039SZ4BVFwdSA08Aw0tl/pWxkU4GWESTZ99PWG5VrWj14B+gJ+tySiiVEcDH8N0ZgHnBaMUSI1vY9UQLAR5PKQes+X79DhlqtJkyJy1AhrxHcxDfnQG4eXrnz8nzFUo2sOuJFgRsxAHrLg5wLNkCKtEwWB5DHI/iu9MBy2cp9QPx1e164gXq4JRUQsVTNuGs/8tJBNI6N2C+KlC7C+BIKzrNeJAKG4tvxMjiNXZewINv5hNyPl8um9itoOC5NzvYUi0AwHfeOvjzRSxzcNnGbgUtA17EwwDVxGlb0dvarSAI4HhVwLcv1NFHUSXArR6jD9XUu56bpTrY+9VtZnPCZ+BbCbBc4PHSHxTwQivafLHebdjSPZ+DbypgwDMLvR4D5qsRHRTwspQT7nvfu9UbP7yqlGBrdbAJ4LNMfDfdbS/go7SQIaoC2ExUay5bluByl41VUpmzRX8RBXyrq3SVobxu0oKLNo55CLod4ILFypTU6fil/sLYfEMtrTuunIGOwfFeFqYrtWqey9frZoBLDh350powDLXAimvlcaUD5jeT+C3WdtXtpGMDBhALVdDrTU+cASTxiAPJAXyTt+N+2mUseiHFYrXwks8tC3g0N7u0AInHLsd0wLwFJWYsHgzw1k3bUAtsXVqepBaPK2o+ow7mLajmupeLjnmjbTtfoRZYRkrjO6D2j0WfB8/pJjWXSPM4PbnkeHv2QEN3f1dcW8weGctxBm6cyRmq0g+ul1zZijbPfpm61k5S3bowhNMKsBtneoYI8JbmPdeHpMokaPn3vBW9SNitLdYBNsPRe8zo2BKwv7StccfeCtay5UnXM/UgVkvofQVK8LopWSeog32W5DbYdDzPgHsEsIoxz8Rs4Dt0JfT9OLZapA7eZVbldk1lv6+YnPBok17Xqgtp6otG++nJPst56xwwzxVmPH2JVrTUPrMqN1OgMpg1dpm7Yww3vruJBpL0TgPzeAxmiuo8u6EkQJoF3GlW5VYK1fa2S51scCvK8d3ZHC7yHoPBErkB4BPPqowpMmY42x5grdIZ34GWp0mor9JzW9OwvekyUyV4qwWw/X5sRe/y6EptRZzuGMac6/F9TsdXB8NtT43ZV5WvDmYGsWcP3HxBlUqubJsr5JcjwWeF2exMzpqGOXfJoYrfCeTP9+EBx09TyI9mKhEwwKHn5YG5X93KNdQ/LwIYNukOnBwsXDhsKhCItcz0VrsSNVNtXpsD8lW2BMu1glf+VirQrl3vRHYX06qCCHhsKryXmX86H3acpXyF96cDNr/xuMXtQnW4sRZt2doDMLIfnFPdR3K6xEnvmw01Tq2m3s7KaUXL6VbRgQ79c+rBMIklOBQFXuJKtcaCFueVZSBeILYCPDfgTsaPtd2+K82yBZFVguWc2CZSglum5s12LLB+QlIdHDsxQG6lGkFOVpg9ezYOeAF/rwYrPU5+zPn3JYUzDD4yLvnjubGfs7YW8Aw58qRWNNgTLziq+XmC5sK2MLaEmO2Tx6GGdMCL6HRm0+ukDMCyKR2rga1fUO8CTzb8/Xffw19MvVLi8Nf3756XHca3P+Vl543JFz82lpi+OEYWOUY2+Ux6Fb4S+rIlWAWHeGI2LQpTc+t8tPQlVl06sxdzmroNldrXcbcGBipjuS4ekEvPe19fB0cU9WI+e+B6X9eqsyElZipKvVffqTfM9dBxMNWwWes9mPNoIyucasmAQosD1jmAPTAhN1rUTvB5YZPXPHG1Rx5i79bKQcBww9Gcp/YGEgF/vly3mbIT93dWIrNCtiJTVs5mLbvRLY/0DV82FuQFwFE+NSYzVCrBWclFYQbTWHN5x1K1vLGz2TSFzX8FVjNmMb598TO5oGMAhkOdp1H6sh8Bz320823+X2UnNh45vm+kDMB7LmU4T8Mzk6lAsuPLad9Yl5O5AnQVDKn7zwF4z6UMZ4lEBofykzXN5Bk3qxhb1W7E87oRIIALe6R0wBsvZQhqlVQpE27Svnt5bk9pIQ0ZdDGzpWvpPMCFlzIMQWSzczcLWdPp2bZno86Oed8BTK6ISMipzaLHk+OiSy9lGLpo5x7YE7JKu9QZyxitsFmFEOZh1+AsHrJqLZ3VyCq7lGHomMZTxGIhK3QeZxeN6dzOauVQo1ln1SQVJDf1E4FgucoAXNruSsBj+PWkrb7sZPjIzKiZGFGDHfOU9LvV7A7ynbryfevg4nZjgN0iEwVc4MyoJKwbf2ZHoK083qfXG9iUWD/dNbfpFvKlWrr+WPTgo5/eIb+EALQbqYMnrZIgxCK+zbhVc2lZu8Z7SW4UF7Bb20JyMwe8HD7lKDMAdw9vLW9krSIMuLZ92wMhTYkrB3g2xO+91zcB7JTe5LkmbHo9R/IIVjpgfrO3jaxCWdguNLFV6wva3TFd3cJuVNlTITNO/2hc/jVxHD57iRbSAfN+MAe86dOF8Qt7XlunZ8Z5zU50+Ea70x5bWU/4xs48Wd2oBMcm3SXaBd0LjwRJ84mh6FYSM08ZeCrX7F5oKidnJB5mkzq4XfejnJBG1iTwAmFQi2apIRuMEbVg7VzVV4O1sjZpRTO27sEGO7nlwwKEAB11gNK8BHtiRO4Blrvhsc4BBJMsGzA5uRKAE2wGCNuvJMOA3+CBa/T1pcbnVgD+f6FGFuAsljmBYUNuKzo1a+Z/OdkHnMZ63npIMMnVqslYwYWC05LTf5eteGI2wwnlAu59QyCrxCbv8MQDTghsUzxUyNvPHQtNiI2nYjTZmpFWhvUe0hhPiKH3gg8AGNDKSVr1FLpGwVHFTaShJ9wWbGRtqIXz68G5TCSlhIFb++P7xoDFAOXX68/sAo0XTe5oynIl8EhwWNMmwYaAee+3yXLPnuTuTAmwpnMNUkysqYMV4HUzKpPsHlN5rYa87p49Vr0cd2UrWgG+QGMtJHdW5Xbb1nX3smIT4AzllUQRZ0V/IbP8pwW8K8BBGvmA12gjwGNP9jj3g+so7BERAy6m4wOOnc91dWmutqiDi+ncgDcbe0u06p1UBE08PT8bJldB+/jhVfIVcQIc1D5+eIW8lyQBDmsfP5wvAoxcBPh0ZTJRd18Hn65WTdWdt6JP2C5eLwKMXFUBR34Gfk/ArRhpvQ3ZY+smd59BVQADRqz3roO7p3fxK9c/rpt5dHzVKcFqicqDlWCrEcLhdpfhjwZ7Ea7kovkqHgcEbNRe5CcHjVvV6uDm4e24gDVXa91jrKrXyGrZ9bCAOzmpbOVD7KdQxVb0x/MPM8D+ie+bq1lqIuBRzW7S12u4F7Ir4K/fuYe+C76VAYc94K6AZRWsu8O4dZeA70kEGLl2A0zaSDsBLpD8KWKdIYsFItdK/vixzpDFApFrJX/8WGfIYoHItZI/fqwzZLFA5FrJHz/WGbJYIHKt5I8f6wxZLBC5VvLHj3WGLBaIXCv548c6QxYLRK6V/PFjnSGLBSKTji8CjFwEGLkIMHIRYOQiwMhFgJGLACMXAUYuAoxcBBi5CDByEWDkqgW4s35jSz44fkmK434pbYnr4yfzDDvYlhMNbOzrlVm/dQI15sRKOTBXlQDzX3Hp9HEAn7d34jhfSlvi+nwxixSAbbnRoMa+Xoe0W00HasyNlb9kQR3Acuq0Xn8a9oOmThw3gcKWRMhxFQqwLTca2Jh8Gk79bC/YmBNrxW/C1gHs5k4/d58Qx02gsKVeLEZhzhnYlhsNbkxGlaU2wZgVK9GWrUqAhUfR56L5mQF+b8uJ4yZQ2JLUCBhqy42WZGwInXhgTqxEW7bqAJYXnrr85MIezVL2nDjOl9KWVEx9ksG23GhJxvT6NanGVKw0W442AKw2LV20BQADLU2CZQJOM2a3scDGOrfdnFURb+Gi5aalB+9LuGiYJanVLjrBWGfca4qxbuKUs9YuKA6YP2B/9TQlFhv6JRpZMEtSOY2sfg4YYqwdSSUYa6eVblZfaYNukjymxYu2QDcJaEnKBEvpJs2uC4ix1lpQAm7MjpV0YK62GOgQh7PcQigw0AG0JCNmDXTYrWigsY9nOwzUmBsr5cBc1RqqbOWAnPjd2r5hoFVRnDgtdPgwxxKXIJVoy40GPyyuh7ckY5NYCQfmim42IBcBRi4CjFwEGLkIMHIRYOQiwMhFgJGLACMXAUYuAoxcBBi5CDByEWDkIsDIRYCRiwAjFwFGLgKMXAQYuQgwchFg5CLAyEWAkYsAIxcBRi4CjFxoATfqVzpvny+3vu/Uy1XgITARA4vwAuaLHmhxZB5sBPjEIsBS+AEPuD6epbseNrV6tRr+FOcfArB6unr4Wz2jOcQQjMWbjiDSOCH4uwA8luB2wCgerebrE3XyQV31AO7TO3/KmgewAesI4iroTkj4vgB/vvDC2D1+k6W2kS6ar5gx7Pn85U0WZwuwiZC/1NzOwgtYNaIdwJ32yZKXWV7rZpZvUjE0YBPBWqPyXMIL2FeCO913am3AfAWMRtbPj3+6JdhEkIu/ns9D3xtgs8aLA7h7/GvYKdz2xEW77ewGvJLHcXRfgE0HSC1XpYB9vvzK21wceqdd9FV5ZrvQnrH/dC+Ar7KBJZDygsj/6MxyNw1fM1AWXsZD3r5en94Hp3wzEURRBq+1dCDdB+CB4NAL0v1g4Z7HfnCv+z9igaMBprwkGPtN94Nl0U5Ya+lAQguYJEWAkYsAIxcBRi4CjFwEGLkIMHJhBDwfcPp6vXlHoeSdQtlpns/omaQ0BBA3nM6l+wDcXvzDjBZg7357o5zbZc8TOYXuAnBgxk4G4MEVFMzoFkIK+OP5txfx4yDiFl8n7ujf5HijmLDTyIHKEfA/z2JGzzwlvdj6hwzQnq0IowUsftpxAMvv/PK5OPJ2MC/Jl3HCDqQEWxN5+hPeb0AL+Kp+10Lc87v28haRmH/z8GYm7Ii7+HI6ngbMNw2l9OO/KiV7Ik+f+dtFewotYHXz3tzU1RudCTueEtxJpyw9sdqoJ/KILVm/ILif7gGw+DSAhz/aCOBpSvZEnp4AH0KrSnAwJQJ8GM0Be+vgFgTYnsjTUx18CE0BA1vRnqKpUlITedTlseGRFNBdAPb2gx//9/jNHqpsAv1gPZFHBqB+8BHlnw2Z87DC+eZV3gVgPhZtSzWrM5pLNBZ9TE2HkDuW95gC3U0iHU0EGLn+BWBrNRHS6gtCAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ft_temp <span class="ot">=</span> <span class="fu">gam</span>(logHt<span class="sc">~</span><span class="fu">s</span>(temp), <span class="at">dat=</span>globalPlants)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ecostats<span class="sc">::</span><span class="fu">plotenvelope</span>(ft_temp, <span class="at">which=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-8.4-nonlinear-predictors-of-species-richness" class="section level2">
<h2>Exercise 8.4: Nonlinear predictors of species richness?</h2>
<p><em>Refit the model using smoothers for each environmental variable and compare to a model with additive quadratic terms (assume conditional independence for the moment).</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>), <span class="at">data=</span>Myrtaceae)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ft_richSmooth <span class="ot">=</span> <span class="fu">gam</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">s</span>(TMP_MAX)<span class="sc">+</span><span class="fu">s</span>(TMP_MIN)<span class="sc">+</span><span class="fu">s</span>(RAIN_ANN),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>Myrtaceae)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAdd,ft_richSmooth)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     df      BIC</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_richAdd    16.00000 1002.806</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_richSmooth 21.89962 1013.921</span></span></code></pre></div>
<p>It looks like the model with additive terms is a better fit.</p>
<p><em>We could try refitting the model to account for this, using the <code>gamm</code> function in the <code>mgcv</code> package. Do you think this would make any difference to our conclusion? Justify your argument.</em></p>
<p>I’m not going to try refitting, I don’t think it would make any difference. The main thing that happens if you have spatial structure in your data that you haven’t accounted for is that you get <em>false confidence</em>: standard errors and <em>P</em>-values are too small. In a model selection context, this means that you can end up saying terms should be in the model that you don’t actually need in there, so you end up with an overly complicated model. But in this case, we have already concluded that we don’t need the more complicated model, with the extra smoother terms in it.</p>
</div>
<div id="exercise-8.5-carbon-dioxide-measurements-at-mauna-loa-observatory" class="section level2">
<h2>Exercise 8.5: Carbon dioxide measurements at Mauna Loa observatory</h2>
<p><em>We would like to model the dataset to characterise the key trends within as well as across years, taking into account that carbon dioxide does not follow a linear trend over time, and that there is a periodic seasonal oscillation… What sort of model would you use?</em></p>
<p>We can fit an additive model with a smoother for the long-term trend, and harmonics (sin/cos terms) for the seasonal trend.</p>
</div>
<div id="code-box-8.6-a-simple-model-for-the-mauna-loa-monthly-data-with-a-cyclical-predictor" class="section level2">
<h2>Code Box 8.6: A simple model for the Mauna Loa monthly data with a cyclical predictor</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(maunaloa)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ft_cyclic<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>maunaloa)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maunaloa<span class="sc">$</span>co2<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">expression</span>(CO[<span class="dv">2</span>]),<span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">predict</span>(ft_cyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-8.7-residual-plots-across-time-and-season-for-the-mauna-loa-monthly-data" class="section level2">
<h2>Code Box 8.7: Residual plots across time and season for the Mauna Loa monthly data</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here is some code to produce a simulated dataset from this model, for comparison:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>maunaloa<span class="sc">$</span>simCO2 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">simulate</span>(ft_cyclic))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ft_simCyclic<span class="ot">=</span><span class="fu">gam</span>(simCO2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>maunaloa)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_simCyclic)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_simCyclic)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAEgCAMAAADli+DTAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmtrZmtv+QOgCQOjqQ2/+2ZgC225C2/7a2///bkDrb////tmb/25D//7b//9v///+x+g27AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2di3rbOJKFkTie3nhmk4m3W5ZtvP9zrngBUIUbcSuRlM/5uh2KBAqXqp8AQUpUGoIgMam9KwBBjywABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCcoBd1aJfO9YGKhf8dQqtgH28qB/L1udv9f2f/eoDFQn+OosWwD7+Q33EP0HHE/x1GuEaDIIEBcAgSFAEsNent9uV88/96gJVCf46gxxgk7+mq+cf+1UGqhD8dQpZwD5elvXeK9akTiH46xyygH3+XiYbFzjsFIK/ziE3RbzMtyzfnzGpP4fgr1OILHK8Pyulvv3Zry5QleCvMwjL9BAkKAAGQYICYBAkqPVZxJefHy/r09lYlTq+4K/TCCMYBAkKgEGQoAAYBAnKXIMpK8zpjy/46zTCCAZBggJgECQofB/stIK/ziB8H+ysgr9OocHfB1NQo2p7Gv7aV8U9bDbGfL8Il3SNqu44+GtX1QM25vtFcFij6jsO/tpTDYAN+X4RHNaoho6Dv3ZUC2B3LRfifbVTx0kU+yViAIAdXw8KmPoSQVAPmPu184wuan3ZQOrSOih3fGc/jPv6ABPyV6/m5bVjuah+hbbEaEPCyRv5K+bLbca/3HgBYP3qHcFE/NUpJWO2Q9OKugBijVPEvM+WleHP309vAGyABkwRx/urTyrY2FlqmbBW3LcqNdyacHJZ6s6Kubf5+vTmOSx9/w2AJTXkGmy0v7qkopv7yQ1ewy8M2wC7zlP2+ZQXk7m3qV9/7DmC3dF3okX1Aybgrx6tY8XioN0Jm+thqqJGx00DYNN3jBZPJZ++MW66JQVgY43XlyTjr3aREXGJ7V0RI5SrlbChNWpZRSy4Z3lZX1j6+RuAjTXesIoo4q8GRSebdvjYRXZiaJY11yniuNg5zH2w8RUBYFJ1qM5MB63o0R7r7TLl0jsG5iKsr8HRzbI8n7+n1dzuXzo/JGCFGSLJjguYlL8Ks/ljVny7E7Gm3K5MfkfOEtZeJdUB2MfLMp03/zbXYXNHcc5kQgAm6K+t9Ntrxey2UwdiTddxtGgvu11IbK1S8oySz7X882r89PEy9ulsYcCKcj0gYGL+SibMrOr7caz4wNE4ENly6zPp6DUgH9vqa5QYpjezTbILurfr4q5T4iMDNpq2DuNy/ook2bpfxtuxDDxsIKlnTNElidLc/gwuclkYS1papdQ8eDufdrckdfc3ZOt3bOwPE54BsJK0HYDJ+cs7XBDczB1ukLCbDZc+dj3CjWObWfywUDGa+AhXI39ArAbMnREfGLB8zlMBJuWvqsN+EkVHDjs5rJ3secNXSW7vIKHBm9qqZJ6NOulWf5lrMPtk9qvwFLEAsHzl9wEsnNKXFVm6p/KEKuGvSA23oQjHL7Zy7x6ncAk2DLrMbEcmd3APbs2u3IO+0dsJ5X1OTxSVedeE78+/vI02jQBswwsBYOWTmH0B8/f1ACbir9BXSmuVo4z7wobymseL7TVRtqXsFpbyRrF4aAT7lKk3LXtGzV+YLB5TjV1/V3FebX5g79L5O3uHASzKUhlg0W4sAGzL+kjAZPyVrGGCMt6C9TSvXA4qP2GuOpxOpRhiXqGRADOTU5ORzDmD+3fJcAyigEdANWD68/dUdu+P7EVPgvkUrv6pLBmLMcCC8fwRARPxl38p438ML3W8xGqNbhvebiGQkpYYxsjwFWCkYoxFzPAyDF6sVA/3eE1UEDUqAl2Bqh1baS4BWBiMdwIsChvfE62JithN5E9ZHwvYGKncx8h3PGikh/Vf+LLp6CWZm7DFhzXS2e47JknKyMAU1s9lJaSaorUd4tKUKp7CAea3t0RHBixetxCwWJQUAhZLNgiwoFZHByw4WaVuEq/TNt+OcnyxlIqmZyNRDDZv1PMKtoTHamYmk9aC48zldvtJSZ6RpRmmJM2MkQYXySU0r8QZvEyfB0wFewoBI2eXCsCCgb8cMOXsJjq6EDAVS98A2Hh/eW0zA048I4dCrwODf5GzWmAMMZhcOpUSL9YVrgIwFB2zjHU+8K38OOj4YMgvJFneRn/ZhMmv7VWpEDDGkPLS0blCxOgBAAuoihUpDNh4f/nzLrvuls7nxiZLiNlNrdLUyk0W13225FLE6BCnSXkqKNiSTYtTirvHtoEZVtaIrXKq47KyCcnDAR1KAaZ4iiMAlkxWC5iKFykMmIC/PMKUH53JbC6lpgOHM+uazsHxKIoMOSFj4SeOGSnV8Uyjyox0YRvoJm+Fj3nTCDbiRThB0Ljp8LrnawFGTyxjARvvL0uG/ah4tKVyEb4MKJYUzTd4Bk6WG3KcYR1NyaeBKQrNHjIxJAe9uAmqZIbecFQLuiArl/D9X1vfkC14cenOgEUZEAGMJN4HMAl/uRgmJ/8QMRLdNnL96y+CiU1Jg9SFcRw4FtdB8NtK0pq48hkmK1+UKFsMbbliTXBttp3SDdhz1hWT0t8895rvbLuTyLpnKGDepCYNmE0eAOZlZsWNA4ysrw0DbLS/eBS7UDPha5MRtEwYuvBjCDl7zhovMEgZRFE4j6T2SAovtSvB1Z+Glj01EFPWtOKQmwOkUslO97vabCxfkd3QZqIcYDQW84DZUOwHzHjfJB8OmJvP1wPW4jAjCX/5gNEmMxpsbnvZRQFkielOr0RXjCL/hIwpTetGPxgz3jAZG/hsjYK2shqZ8Y761XZJquOKerjsovmq8qkigK0hmQHMp4ROOwKjFDATCZoFr3+qSgFGi6DFRADjZ+BDADbeX7EApn2tvWjULhadq0h/WKvOPCvS5lDGj8pLTpll1dJ+VvoxTdh62Fr322ObYxpCOoRUze+4sh4WW+TYAMy22GUznlVeYnOY2BYAjA9b1somYP5Jdwsw1QeYyCJHQBifw7EYoxDS9UMHpktJ8jiwWDFeIDMAHAcJxCJAuTNCHDPe3rVCtDx6kH8KOq6wh7cvmqvM6ShgPk6NgJGZSRIw0jcMMMUqlgbMnBmVsXIswMb7i4SfH7RstDE5TTgaLypuhIUjR8JEs2ZprTu9ipggSJXAPtshNVRk39oObXn3u0GzIhMdV9bDdslp8JMB1YA5jzrAeBxkAbNXs9QvZYC5U6sZbT3ACEo+YEr7/S8M2Hh/RWKSBC5NoMmoYoLZWrAJGY+WMRv9dlSgkZtCgiVKkBLbdqWmDrsW2qigFVi9y5rid1xxDw+QD5htkak6OVUsSegZZNm1tiwLGD/l2YA2sb4fYF6dlWYFk2K6R7AhigGWII2fzG3keud9Fp7OrNmyn2mwUzjiZbP4jh3wSg5qwM4QJiyiRcR22n/jHVfcwwOUBIw0rBkwZf3prNrus1woB5jS1JWEc10CmLWpYoAxdFiRtM4hYIrljHfc/cT9tRV0LFUuC0vj0qWLoDk2bEZKiBnyyHcjlNuRK0ubEzOfKsc7rriH+1UCGB3vtwBbD3mAEauGsjsBZl3VAhhNYLsm1nH3UxywMO6sMxPHu8XKP55oFIUdt93DHy8/Za7B1lqZ6oWA2TAOASOH7OgxHDDlOBgPmKVsNGAi/opEFOnjdOxp7ScRQeVeANKhjY5/y7/V/tptBHMTJgqYYygGmHL5fcDM3yRgpPhNwHjxPmCmJbb+2i8yCpj1Hjldi/mhVEnAmkLTNKnbkrVoIzw4YM6Ed1W844p7eIDaADOjQh4wktdZTQJmg9nmaQXMGcwBZirt/J4DzI4QQn4oFfeXF03FYedvhLbaZR1B9pDTU6GF9Me6usQ7rqyHp9/au5hXTo1xmO0I1ldpwJQHmAoBU6oEMFOcA4wWXwKY+a8EMPKHVS0JmBoB2HB/bQRXYtuPQBqLwdF8ESViIUWgKyghdqyqSrrFXy7h69Pb+/MP8ot7vQ6rBUyNAswliwKmAsDMyVDbmo4ATMkCNtxfFaEmpmAwHF5AkeFUogZ/2YTTs23Tk2sDf4pZkXg1jWOA0fGmFjBVCFhYvANMeYCpPGCk9nboywOmLGDWQ6MAG++veHQJRbopUoJrNoqmWxMpOj480izV/mKAvd6cNfCnmFOArbtY5IkDphlgJMw1AYyAlAXMseO5Zwswh1arw4zG+ysSUCcWO3f7bdtuazxFg7/IFPHH9LKpj5fxU0QOmA0wzZthI7kLMG5wCzBXAmGC1k4nADO9HXfKPQCT8FfQf/dXZaGeA5JnCRKMPWrwl0v48aK+/Sn6llGxw/wAzAK27OWAaQIYG/1UD2B27DKdlgTMVcOVXA2Y18xRgA33l3o4DW9Tg7/qHVtuLjzBOIQ2AFN2wrcXYMoCRkagUsBIajHAhqgbsESucHfonLESOD9EGhHtuOIeNvr8b/MXIYoBi3dJGjCaIQSM7GD9kwKMoqLptXYnYF5FjXW/WrTsjB9KNchfKi6zoBM/mMh0VHWOafGOK+7hbYctP4ieeTwnC5iZdqUBo1S0AOYPFcxUAjAVr6gigDF7tYBFWkiqXO0wUX/F6xptxldQEBUN/qoCzL7L45p6qcd4wMhM0gPM/Y0CRsco9TUBq/OXX9GwxV0DluamWiz0ZN40nnAUT1PvrxrACt4MzOsQVln7Mze/NR5gNH0ImDnEASOpOWC0TM/bCdhjgLHuDpvnWdsTsFp/QbMyHdHgrxrA0m8GjlUhAhijYgMwNRQws6JJAfMTRyrrA8a3XMPdiOdbS2W+B2C1/gqaH+2ThM7Op45MZGKJav0lPoL5J3kTsjRwo8PEXQGLd2cIGDs1aEqUXtN7RvcErNJfuTN3ppe+khr8VXkNtp4Sy+b0S7D5A9UWYHRBz5xV+JDnKGEBHQLmRhoRwFQNYN7GPQCr9FdswlFPlu3YR4SywV91q4jmW37JR7gzgJnQs4C56GTTSQpVGjBjuxIwVwoFLIyFdTdZkqkBzDfEuoGY2PBDqYb5qwKxAnz02sDtlKdRg7/qAKsyVw+Yibo7AEYqxA9pl3MTMK8sfsvMq3Owwfx1hPtgRSSU4VJo7HRKdFxRD3/8e/HSwKezxwPmgrYdMIeAqV0AmDUUBYwNt7QsAxhtN+dKjwNMwF/98qzkjWaP9tVHgm/vZFTdw8ZhA5/O5tHrIkzHAbNE2gTseiwPGONCkZ1KBDDPGAFMu7rR0sQAG+kv2gkS0tafYQGrz3vRcP2tXawlatFgPdpxJT386ox0/SLzWMA8h8QAMzvI0JgBjA1Am4DZepH0KgaYNpkCwBzN2qUjpdc7TNBfvBcKJcKibmegzGSj+QZ/BSNYn6KAkXN5BWDLmGz3KYKGYkFsIj8OmCmRAWaDX3s5FisEMO8M0QQYK8i1bswI1qemKaLp9ch4JDT0WfM63LqnGvy1JPx4+bUHYA6kKGCLkXWTxXUUMCUHGEtfCphWKlKQbR3zVyVgMv5ioZQOMuc8Eu/J5C0yvconAY229LjatfjLAPZTHjDnmRAwE7imFW7jUIBpbUKLV+P+gEn4a4w8S112NzKPq3ShGvy1Jrw4I0MXOYJoHQSYSaFWAzHAdAQwOgAZHiwU2oymWtMqa1b3TsBc65i/aqeIIv4qi7GyZKW2NHdaupDNcl0LituStqzj2w3+sgllRrBawHQlYBFC7waYA4gDRusmBZj0NZjX0a1aW62pV3yDmpcRKTBymJnRkYRei4pbsTlkRjquuIcHSBYwTfxuXecM2Kh1WULAdBQwVjlbrsFJmfqRow6yfQAbI1Zsdbz5sVeVoVLU9cmSvIbwDypXw7J6Jzpuu4c//kPnGfxTlTYAs+HeCZix4QHGdpYCZqDQJKmzp83uMsBsSc6bmoyBowCT8Vd5pOUSaddXxi5PTk5dtODADLWoSV4V5mGBob2kZo/919mIVCzTsp4R7ONFrb+e8vm7Z1YfAKbNYDAMMBOZjrgUYKxE9z/J1gMYGaGM6RhgOgIYbUak4wok4i8aaNughWBodtRaDS1p0p0xy4GZyAeSwK+P2aWNJ8zZ1iZydds4rWh+JN5xhT18XY2UvFu7wJz7OBYwA1EOMO1y+4DZnQwwltTUvQcwd1wGMC3gr0SMBeHrx7HbGdihH0IDYRk6kiRTMe2K9FMRJp2DSDHOB0qpmIFUDSMdV9zDA1QKmK4BjITvOMD0FmDaAREBzJRiPGYrRADTdnh0ddcupz/c76FiwGjYanPe847lhjTn7lToEs/TcPbSeMa1280Su4HJtlPZsYxm9ulLtclFZNhxxT08QAKAGZJGA2bDvw4w2kxlK+pOlZQ1B9EZAEtPkwIU+FFNEq1dn7UQP+KcFh4K4NW2y5XL5lqh/bTKTiZyLXXFmSoYeEk5kY4r6+Hxb1cpAMwcagZMu3aPBsx55JCASb1dJRJ9mgNkRwYGm2ZtyocwieMghwvp5PClg92rBWrJy0y8maiN1mROwurhahXtuMIeHv92lSLAHCitgNnC3DHtcoeA0YoJAeb+pgDzO6seMIG34ZDwipBAAle7CDR53AdnKBHJXlgr2q/kkAvrYETSfMPu54hRU3niSU+Q9tA2+XPEesAE3q5C4thdjASA0egkIe0DRoKUBe/dAKP5SwGjKQcDJvE2HHqezvDgojUW0drLk45qUgKrArFot7xCwu7yeaHV5LtpdnbIt0QrSGIr7LiiHu56W0eq4VnAbApFkkYBc8bIyaYYMG+LV4wnCLptGzBa+4gDRAEb6y/Ch/0YxhjLSYZ1ekDFpK2HkjG/9hDxYZjM+CISb6zGmbqQ9LTq1L+BkWgAFXW13Rr/to4mwExGgggxFo4R5wDM3+wHbLy/lBnRedhpGtDEQ37AJiJ5jVBiJkwdnZLaI7wunpdSdYiWsT2w0s6gZxzlh0YDYOPfrmL3BYDZwHSZtgHzUoWAUfMxwEI7PmCZVh0OMJG3q5CeN0GVjG2TIR2sLtKNHb/4JFmETi/24z3loUQwNmCvxmjTeH4fc28Sy3M0ADZETYBFsrcARj8FudN24gQGqROARU8PZFsOsCEKRjDiIxppbEcUJpJAcyoMXvEKqMCwCRQW89EaMzvKN2X3a23xylRF0dmn5mMYOe3kqxExW5qw3RwDzMVmE2DhvnjDAViZeBUU74uAIhV0twtDY4JgQvfFSw9hoHscY/EKUysJu2RQzFdFm5hzQxxbPTzyCEZdtwEYzVEIWNxOJrc70A5YYOURACNOcU4iAZnoU4eCzeENg5GZJceKHovgwQ8HpuINC4ezHFzEmnKus1PmSCOyloKE5gcqJ41cpndVfVzAAnvsUMb9CVMlEvKXiy1CR5A0OohpE85me83vcnKsmLGQIRUbvXgHb/FC53muLnkx8LWdM5rBLFGVvMnShD3mKGBkV9ZOMWDx/HcBLG6PmUvk6QRsmLyhxd8fH3/DQcwMXGT08mdoufOgj876j5/L4V9Ei1Z2olqYYQ1Lx/haqpspBnUpsDhUKXNHBmzb6FcBLHUg+By75iGbTJnCg4GLFxZeXm9ZjBah/NEnm8EMwOxOrJ0r+lUsMWhkph0CU8RNnmLp5QErNhqez6Mp7gvYcH/lztDp+toTPRtf3NCRLjpTRCRbLVrUVE1GcsFm3b6Mzr2AvT69XX7o9+eR3wcj+2sBK5i5bVdkf8BKy69v53B/BeNF6pDdxWM+Mp8rx8vfxQ03wpUsKp/etM1+NoNgF2DTw9nXp7fkm6QqzQX7jwVYKkOr7g+YrL/0ZjRFYp7s2Ri+ckt/nglllhruJ3Y30E5Ny68oPGOrpmfb3v/6Z/6/p26p/QAsW1oDYJL+YofCyqai3q3ANeAVFMUGkXvKW9IYs4o4vQ5x+imwBwEsX52+pKncdwVM1l/kWGRBw22Hecwdoxa8UkfvzJe2jbDFB4Q1XINNj2W//nyUKWK+OsO1wzWYqL/cQT5ry61MmB3Z4Wv7gigy89zKIiBvxWfIMv3rj2llqmtRCoC1ltxQU0l/LQfpdX1inSHEIWe2jBWV+XQ3+YD5KzotdgZoFGAagN1F+WLJw+eFl016nU1FExYPRU2RLKnwKkwIsOkn0edl4dTX/NKAVQuA9avZX+vR4MRdYiOFV95KwsYh+DJDGNtTnHWVfbwtM+e4fPujl2/4nQSw++qugMn6yxwufCRpRJJYhl0uv2Lyb4O1j2C5n3iYFq6mv9PdFwCW171GMCF/VWqT0xabDZcVYgqGsPYpYuZXiqZbL3OSpzcAtqG7TRFl/FWr0kcO64w25pOQf+uhHbDMKXE5I+rJqdIO02cHrFbN7TyKv/oWDg+vcV+4zP1KkTmWXh0GYI1qbudx/FW0in9ahY/2F+bzPud/peiyvmrg8zd3WMmXE2oFwEp0HH9F2vA4eA0AzKxKDf3p7H5TD+SirJpXEQ/jr8DaI+Gl/eZI3mi2U/sx5vKmHstJaQm2807+ms2p2OZjCICdWo8BmDX4cHhpr68qAav6ERUAJqC6dh7RX8ai/8zDw6j3Yd+rmvxw/bb58noAJqD6dh7NX87mo/qsDzDzI8zbX3/YY8rx8Kpu50H99cjqA8zc9h/6+qJ+fZUIaFhFPKS/HlpdT3KY89yr3Bf4DmHwoGoYwQ7pr4dW36NS1/mm5GV7Tl9YBahGLddg8Nd+almmn5em+u5bwmGtaug4+GtHSd4Hu6O5r6OdOg7+ahQAO5kA2Lm0G2BQo8b6Af6SVnEPz38/Xn6WfAW90YlfIrWscU8i/hrF+LBzxUNU6A5nzuNA8DCAiegh4lnSDgDbMzUAG23nMSrk8kxvE7h0r/tmi3jk1HcHbLi/HiKeJe10Avb69Pb+/CP3IyqNOg4EDwXYcH89RDxL2ukDbHq2bXo4oO/ZtmwRD5363oCN99dDxLOknX7AXm/Oyv2ISpuOA8GjATbWXw8Rz5J2eqeIPz5ent7yP6LSpONA8EiAjffXQ8SzpJ3uRQ717Y/5ltFIHQeChwJsuL8eIp4l7Rx1mR6Cvq4AGAQJigB2m3M8vb2mv14OHUvw1xnkALt++3OZLprhsXMI/jqFLGDTV9AvmRfdQMcS/HUOsftgk8PG32iGJAR/nUPBCNb3IyrQvQR/nUP+NZh5Hwd0dMFfpxBfRVSq70eKoDsK/jqDcB8MggTFrsGg8wj+OofYKiJ0HsFf5xBZ5MB676kEf51CZAQb9ytF73/NNi7mGvz9Wan5qe9r/1W5b/u2sSyk9dr+/H2z9JNZCjfGGY8UV6Whvyq1dmp7bYKsS/WaHvVnNdi/OpM6+kdikePjZXb6660i78+34L8+vS0v655eZlXwQqsa29Nvs8+/0t5r+/P3LfNF0VqGG+OMR4rbT2unTuqoDcv6/q/WFjEz+1dnUk//CAB2Xc6qy1Nyl6e35XL88v2fZaPrRyRC2z8Wk922Z1xZLcONgcbDPfvp6obBjtrwrM0TWGZm/+rMmXv6ZzxgV/Vzbs7C+e2vPXvYoBpn2wLWb3sp4FZdYync6LPNjKf27CDTqZM6asOzXlrPGMzM/tXRvf0jch+MQqB+Xb///TJfbiykdV6cc9t2ijjEtp5+5cJaCjf6bDPjqT37yAVQe2141tf/MZeYPWb2r86ijv6RA2yFXf26TAPsNNTYcWecbXvROcT2/N5jaync6LLNjSf27KQrGVJba8OyTj8XcgvrhpBmZvavzmqsvX/kAFsXIm6AfVupHweYtT3/sNL786A4vZpFBwnAuPH4nr00HDDPbKuZ/avj5TwUYPr1dnH497//LDPW26AzbopobbvrpAG2r/MkQmiK6BmP7tlN46eIy67n+pvhMlPE5uosOuQUca3RX/8sn25VG3I979m2Kyn9ti/LJF1mkcM3Httzd13srbi+RY7ZTiRry+K4zCJHc3UWHXKRY9H8rfZfy74hK9Lc9tLgIbbNFz8klulD45E9O8p26qh1ceuXPjP7V2dRR//IAWZvLc/fC5xrNuKeqmfbXIN1256NLCWMv9EcGo8Ut6Nc6I26szvHYNOqgsiN5vbqLLYOdaPZ1Gd6PMU+abRMRS79j0r5tl8H2b4sDx7NJwTyGJa3Mcx4rLj9NHfqck+xozZr1vXepHmErc/M/tWZ1NE/+D4YBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAkKgEGQoAAYBAnqYQGbfr1+1ve/X9p/lByS1+ypfd+PJqiHBWxS+wuhoLvpOr+U4XXv919ICYBB+2p52dby6pIH1BcAbHoB4Pvz/77Mb2FcXmJz6XrnPDRQjCzrF/O2oclh88b6BqyPl8mPZ5ryfxnAblOQyzTTn17/eWFvwIN21fwq+EXWL/MrQOcPv5Y55PT/9NbFj5fJj2eaTn4ZwH5q8+fXx8vE1s7vHYeMplFqfavi6pePf/9ZXvtqfLS8ufX67c+cpP1l5jvoywD2S9s/yytAT+WmB9fnb2Vfzbr65armQYu+DH0+N/5aHHoafUnA1gX8E7np8fX6/R/nl9u12Pf/m7x1I2/6vAB2cyQAO5SyIxh0CJmJxM0p1i/OW5Nev/3BCHZMJQA7lYMeXWYVcbr0Mn6ZL72uZoZx202uwQDYgZQAbFmGethbmyfTVT29TX9/auuXyUcfL7c985g2/XGriADsQEoBNt9vwSLiQTQ/KrWc7YxfLtOO1xms9ZC9D2WTNWgAAABzSURBVAbAIAiyAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJCgABkGCAmAQJKj/B7G83ig9vuLSAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="code-box-8.8-another-model-for-the-mauna-loa-monthly-data-with-an-extra-sine-curve-in-there-to-better-handle-irregularities-in-the-seasonal-effect" class="section level2">
<h2>Code Box 8.8: Another model for the Mauna Loa monthly data, with an extra sine curve in there to better handle irregularities in the seasonal effect}</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ft_cyclic2<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi),<span class="at">data=</span>maunaloa)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic2)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic2)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-8.9-mauna-loa-model-with-autocorrelation" class="section level2">
<h2>Code Box 8.9: Mauna Loa model with autocorrelation}</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ft_gamm <span class="ot">=</span> <span class="fu">gamm</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi),<span class="at">correlation=</span><span class="fu">corAR1</span>(),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>maunaloa)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gamm<span class="sc">$</span>gam))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAzFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQOmaQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2tma2tpC225C227a229u22/+2///bkDrbkGbbtmbbtpDb25Db27bb29vb/9vb////tmb/25D/27b//7b//9v////BM79CAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKKUlEQVR4nO2da2PbNBiFlbKWpJSxkVAYW2FjY/G4s9YwBnGa+P//J3Tx3ZKPnNqJnZznw9op0mv5iS62K9siJo2IQ1dg6FAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlBQHK8vl+4Pa4K2v14JMXlya8++vREXq4dVpxQiEGd3Pvk0m8VkGW/fzYR4Gm9/dpVry/3XQognzp2qCpLV0kxeWLMfVFCoEiJVu/n9tbNcS9Yzvb/OvaoKCkVCVxVopo0gmTBXFZTNqKlc+xr8fvl6JuwNoi4oEJPnstnJdqRKbN/JtvRUVVPW6/W1OHtvap2nx39ZemSS+daab5uGmInzN3pHzd5uFmr/4w/X8tt5vMzy5fEjpSbQzfuq/hWqTZ0vTagshow5/XCldukvuTVbgrK+vnx7I6aOGHVBeruy4c11OMX5XdqyLv7Tta6lVyqbZF5Z85kdT7tyVVCU9PBlkq8QPzR57YJMPPmBTM1jJBUQIi1QS1Bb+ScZpK0xLF1s8ux9bus2cSXTL27jf02t83T1jaziv4X+8otBVGZ7PhNCVmC6Ut9YWZD88NOVKaLzlctNY2cXM/ECFa8QQ/mYq+LiuaqUJUF/A5OlO4ZjkD5/s8oavf7mwqTPJbVO02WI8/dxlSSzPV/m2EipdrE4/qjm0anJVyinXLkFFePlMeT/TYO/yI2VE+LNtdlfV4z6cdDfV2m/SAZ4bdjUK6t1mm58PnpWnW50Zns+HSJpDnFtDNq+NEWmWb60nNkfh6B0RNfpeQwj1fybteRSgjqu0dV84YhhO1Dcfnw1U+Ejke1gSVAx/f7a/PajRZA9X9Z1KoLSfiXOf/i4SAUVyjUKKsYrxPARpA4Uv5lV6pTHqAjKCgWmX2STX6UFFSbF+1dXonIckbcgS760ZeTfVkFQNjlMsy80LefdggoxfAUtIyPFEqMiSCZNvpW5PsxkrlRpVVAx3VTv+3J9k8z2fPUxyGSP1JgZ6dErH6QL5RoFFeMVYmBB6h8paD0rdvViDOeBogqhD4ruF2a6zQUV0mWgL3U/sLUge77iLKZnDDOdqEMvXd+Llfp1mvXmtFxpkE63kFGIV4iBBcmtTF5fvg1UgjWG61QjlZkMIWVBhfR32ShjEWTNl7SMIN9ONpjP882nXaxULhcUCfdxUCGGRxdLNj5ZOmLUT1b1LJbMS/cvZXF9GFsSVEg3k97j2pG0EWbLlx5J/zITj54nw48ciZ/8mc1i52/CfEjI4+tTsSS2PuYtbVSlfHGbzUAmhs8YZE5Wb10xRnS5I6p2KwvBLufSlcsd5RgjEiSblOuMUvfYp7pRTJ1ZnKSCrDFGJEj2rtLeZ4dZagSJst92j2+NMSZBm0VpXC4JkkPJrOFCnx+2GGMSdBAoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgHaC0nVF+7lPYRC0EhSm68Wj8sLxY6aNoO1NpiV86D0/o6GNoM0iW8AUnUwnYwsCtByDkibEMchBejeR+/680dCPoH2H6w8KAvQtKHTMYhTkiFLu2iPQdNguRkEgHAWBcBQEwp2qoOymc+G84HHaguTJGDpHPXFB0hC42+jUBcmzVPctW3m4ExbkF46CQDgKAuEoCISjIBCOgkA4CgLhKAiEoyAQjoJqUXhFsVU4CgLhKAiEoyAQjoJAuBFooiAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgwhAtmg9Y0nBZ0HIIKd2F0sd0jFVS4FeOB26UgEI6CQDgKAuEoCIQ7dUHrmXPOcwganqXWguACX79cxyrIk+RGwxNsQb5sFherExVkVkCvZ2gYCibLkxRkmkb+000o5qcoKEi9bBaoDa1nj05PUKs74pvekHKsgjp7pkKjoCFpai0ob0Fegppv6j0+QXGQ3cUT7PLQCXRFcfyCsompYYbyD3eEgtKD5PCBD+U4XkHJw6XA/XLwCVRHLMgH/AQqLGgglnYXtP3OOYt5HC0dvaCw+XIHPFo6bkHqlW9Nr8A77RZkroY1z2H4CVS+gg6uqfWBojDvbQWTPH4Clf3f0QtKRhd8Ku8X7vgE6eHHowV5hutCUM8KdxikAzwG+YbzFWQ3tpc2ttMspkaYh7zINT52QbHuaj1fDxq5IMlPhxNUL90bDxDUwXYpqBbF/4LZaQqqhKMgEK4zQf1ZoiCvinaZsU04CgLhKAiEoyAQjoJAOAoC4SgIhOtYUB+aDiXoE4UMan6m/4+F/iniSno1n2+5Ln767hFbUFcZ24SjIBCOgkC4PgT1UtEuM7YJR0EgHAXVooyP/QrqK5w9vm8jbMh24C7WHxTkE5+CQPwBCwrl6KbXgRz07VA7THZ7EhROlvFmoVbCugR1f1Jp+SnQSa9POd99biPILMHb3lys2IKspIs4g4sVBdnIFnEG0yEKgkX2MAYlWjaL5ruee2a4grJlrs63IO1FUHFTAxO073B4U+03eDKCdt3gfgQN5jWiQxW0p3B9QEFe7FlQ++tQh6YnQZ53HI6Ang4UPe84HAH9nmo03C82GvoQ5P18hqagQ/rMh45bEA46pM98aDkGoTsOcdAhfeZDu/LwjkMcdEif+dDLtDMkCQcQhB8nOCQJFPSAz3ygIAAFAXoRdEyM5uTpUFAQgIIAFASgIAAFASgIQEEACgJQEICCABQE6F5Q5H5Kk7lia30c6vqzO1DYgv475rx9uTZ0LiiSFY0clV1funZis9B/R2oqXGd7I7OGSni7cq3oWpC5FhLYH5rr/Gta8uCrxsJ1zKOdw7O7luVa0bWgrNK2D0PHLkRirt01FnYhW85O5TzpXJDuRY6mEnwuXA/aM4KaCrsIzu52KudJ14LMSGAfD8xLOwKrIb13TYWdG5TGdynnyz4FJTmsX/SugqJ0jB6LINza7U/N37GLmb+Bj6mL4fHSPtfvNkiHxddVjWOQbppxzX40dLG203W+rn0803zjMZvehYZBuuUBX/4uqxEdKOqb7pxVVQ/Utb+3I2lXTYVtW1KoAq3KtYInqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQYKCCAvBsh/1BQQAKAgxeULZiRv4yedXTGpcGhi5IrblSj7FWq33jqK9FQA0MXNDmq6VZumeW7wUUlFAcgyLVx/Ilentm6IJCIc7+kK0npKASqSDds9Q/bEFlUkFmAb5Ix6CQghKKLWizUMvFOYuVCMwK37lZ36snL5l09lsvi+kbGaggB/3cjtHIWATpMWiz2P+jncYiSB0NuVbp98poBB0KCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4H6KB6WYPxUOxAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gamm<span class="sc">$</span>lme,<span class="at">type=</span><span class="st">&quot;normalized&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-8.6-mauna-loa-monthly-data-an-extra-term-in-seasonal-trend" class="section level2">
<h2>Exercise 8.6: Mauna Loa monthly data – an extra term in seasonal trend?</h2>
<p><em>We tried modelling the trend by fitting sine curves with two frequencies… Is this sufficient, or should we add another frequency too, like <code>month/12*6*pi</code> (for curves with three cycles a year)?</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ft_cyclic3<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="sc">+</span> <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi), <span class="at">data=</span>maunaloa)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ft_cyclic4<span class="ot">=</span><span class="fu">gam</span>(co2<span class="sc">~</span><span class="fu">s</span>(DateNum)<span class="sc">+</span><span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       <span class="sc">+</span> <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">6</span><span class="sc">*</span>pi)<span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sin</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">8</span><span class="sc">*</span>pi)<span class="sc">+</span><span class="fu">cos</span>(month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">8</span><span class="sc">*</span>pi), <span class="at">data=</span>maunaloa)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic4)<span class="sc">~</span>maunaloa<span class="sc">$</span>Date,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(ft_cyclic4)<span class="sc">~</span><span class="fu">sin</span>(maunaloa<span class="sc">$</span>month<span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Season&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_cyclic,ft_cyclic2,ft_cyclic3,ft_cyclic4)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  df      BIC</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_cyclic  12.85033 1773.254</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_cyclic2 14.93624 1135.151</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_cyclic3 16.93686 1138.438</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_cyclic4 18.93753 1141.922</span></span></code></pre></div>
<p>According to BIC, 2 harmonics is the winner, there isn’t much to gain from adding a third or fourth.</p>
</div>
<div id="exercise-8.7-mauna-loa-annual-data-temporal-autocorrelation" class="section level2">
<h2>Exercise 8.7: Mauna Loa annual data – temporal autocorrelation?}</h2>
<p><em>Consider the annual Mauna Loa monthly data of Code Box 8.1, which uses the measurements from January only… Is there evidence of temporal autocorrelation in this dataset?</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>maunaJan <span class="ot">=</span> maunaloa[maunaloa<span class="sc">$</span>month<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ft_gammJan <span class="ot">=</span> <span class="fu">gamm</span>(co2<span class="sc">~</span><span class="fu">s</span>(year),<span class="at">correlation=</span><span class="fu">corAR1</span>(), <span class="at">data=</span>maunaJan)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gammJan<span class="sc">$</span>gam))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(ft_gammJan<span class="sc">$</span>lme,<span class="at">type=</span><span class="st">&quot;normalized&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ft_gammJan<span class="sc">$</span>lme</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear mixed-effects model fit by maximum likelihood</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Data: strip.offset(mf) </span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Log-likelihood: -51.70909</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Fixed: y ~ X - 1 </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X(Intercept)  Xs(year)Fx1 </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     356.6783      29.9981 </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Formula: ~Xr - 1 | g</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Structure: pdIdnot</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Xr1      Xr2      Xr3      Xr4      Xr5      Xr6      Xr7      Xr8</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; StdDev: 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851 14.15851</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Residual</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; StdDev: 0.4428823</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation Structure: AR(1)</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Formula: ~1 | g </span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Phi </span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.2638297 </span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Observations: 63</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Groups: 1</span></span></code></pre></div>
<p>There isn’t really an autocorrelation signal here – the lags represent years now rather than months, and consecutive years (lag 1) have a correlation of less than 0.1 so it looks like not much is happening. The mixed effects model doesn’t really do much here. The estimated autocorrelation is surprisingly large given this (0.26) but it is much smaller than in the monthly analysis (0.76) and decays to negligible levels quickly (correlation at two years is 0.26^2=0.07).</p>
</div>
<div id="exercise-8.8-aspect-as-a-predictor-of-species-richness" class="section level2">
<h2>Exercise 8.8: Aspect as a predictor of species richness</h2>
<p><em>Consider Ian’s species richness data… How would you enter <code>aspect</code> into the model?</em> This is a cyclical variable so we would add <code>cos</code> and <code>sin</code> terms to the model.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Myrtaceae<span class="sc">$</span>aspect)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.0652  91.0725 176.0736 181.5191 271.8024 359.8948</span></span></code></pre></div>
<p>It seems to have been entered in degrees so has period 360. Maybe we can consider two harmonics to try to account for non-sinusoidal response. We will keep soil, temperature and rainfall variables from previously:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ft_richAsp <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>), <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAsp,ft_richAdd)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            df      BIC</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_richAsp 20 1026.860</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ft_richAdd 16 1002.806</span></span></code></pre></div>
<p>It looks like there isn’t really an <code>aspect</code> signal in the data, BIC is much smaller without any aspect terms being in the model.</p>
<p><em>Recall that species richness had some spatial structure to it. Refit the model using the <code>gls</code> function from the <code>nlme</code> package to account for spatially structured correlation. Did this change your inferences about <code>aspect</code> in any appreciable way?</em></p>
<p>Well it won’t change our inferences because ignoring spatial correlation risks giving you false confidence in the importance of terms, but we already decided that <code>aspect</code> is not important. But anyway. We decided last time around that an exponential model with a nugget effect did OK:</p>
<p><em>This code chunk is not run, because it will take several minutes:</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ft_richNugg <span class="ot">=</span> <span class="fu">gls</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),<span class="at">data=</span>Myrtaceae,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">correlation=</span><span class="fu">corExp</span>(<span class="at">form=</span><span class="sc">~</span>X<span class="sc">+</span>Y,<span class="at">nugget=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ft_richAspNugg <span class="ot">=</span> <span class="fu">gls</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span> <span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">cos</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>)<span class="sc">+</span><span class="fu">sin</span>(aspect<span class="sc">*</span><span class="dv">4</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">360</span>),<span class="at">data=</span>Myrtaceae,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">correlation=</span><span class="fu">corExp</span>(<span class="at">form=</span><span class="sc">~</span>X<span class="sc">+</span>Y,<span class="at">nugget=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_richNugg)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ft_richAspNugg)</span></code></pre></div>
<p>As expected, this did not change inference in any appreciable way!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
