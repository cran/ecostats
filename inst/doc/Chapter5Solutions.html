<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2024-07-03" />

<title>Chapter 5 – Model selection – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 5 – Model selection – Exercise
solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2024-07-03</h4>



<div id="exercise-5.1-plant-height-and-climate" class="section level2">
<h2>Exercise 5.1: Plant height and climate</h2>
<p><em>Which climate variables best explain plant height?</em></p>
<p>This question is about which variables best explain patterns in
height – it is not about hypothesis testing or interval estimation,
instead we want to compare different possible models for plant height,
and so can think of this as a <em>model selection</em> question.</p>
<p>As before, this research question involves several variables:
<em>height</em> (quantitative) and <em>climate</em>. How climate is
measured has not been specified here, but it typically involves
quantitative measurements of temperature, precipitation and often
related variables.</p>
<p>As before we will answer this question using multiple regression, a
type of linear model, and the main question is about which predictors to
add to this linear model.</p>
</div>
<div id="figures-5.1-5.2-bias-variance-trade-off-for-polynomial-models" class="section level2">
<h2>Figures 5.1-5.2: bias-variance trade-off for polynomial models</h2>
<p>Here is the code behind Figures 5.1-5.2. Because of the small sample
size, you can get quite different answers on different runs! Hence the
seed has been fixed at the values used to generate results in the
text.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>sigma<span class="ot">=</span><span class="fl">1.2</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>nDegree<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>seed<span class="ot">=</span><span class="dv">61</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>( <span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>n) )</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">3</span><span class="sc">*</span>x<span class="dv">-3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>n)<span class="sc">*</span>sigma</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>idTrain <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>n),n)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>xTest <span class="ot">=</span> x[<span class="sc">-</span>idTrain]</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>yTest <span class="ot">=</span> y[<span class="sc">-</span>idTrain]</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>x <span class="ot">=</span> x[idTrain]</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>y <span class="ot">=</span> y[idTrain]</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>err<span class="ot">=</span><span class="fu">rep</span>(<span class="cn">NA</span>,nDegree)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>errTrain <span class="ot">=</span> err</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>whichPlot<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))( <span class="fu">length</span>(whichPlot) )</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">1.5</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>),<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">length</span>(whichPlot)),<span class="at">las=</span><span class="dv">1</span>,<span class="at">oma=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>dgreen<span class="ot">=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="fl">0.75</span>,<span class="dv">0</span>,<span class="at">names=</span><span class="st">&quot;dgreen&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>xpred <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="cf">for</span>(iDegree <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nDegree)</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>{</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  fti<span class="ot">=</span><span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">poly</span>(x,<span class="at">degree=</span>iDegree,<span class="at">raw=</span><span class="cn">TRUE</span>),<span class="at">data=</span>X)</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  err[iDegree] <span class="ot">=</span> <span class="fu">mean</span>( (yTest <span class="sc">-</span> <span class="fu">predict</span>(fti,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>xTest)))<span class="sc">^</span><span class="dv">2</span> ) </span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>  errTrain[iDegree] <span class="ot">=</span> <span class="fu">mean</span>(fti<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>  <span class="cf">if</span>(iDegree <span class="sc">%in%</span> whichPlot)</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  {</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>    <span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>    <span class="cf">if</span>(iDegree<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>      <span class="fu">mtext</span>(<span class="st">&quot;y&quot;</span>,<span class="dv">2</span>,<span class="at">line=</span><span class="fl">1.5</span>)</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="st">&quot;x&quot;</span>,<span class="dv">1</span>,<span class="at">line=</span><span class="fl">1.5</span>)</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span><span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">cex.axis=</span><span class="fl">0.75</span>)</span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="dv">5</span><span class="sc">*</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">0</span>),<span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">cex.axis=</span><span class="fl">0.75</span>)</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>    <span class="fu">points</span>(yTest<span class="sc">~</span>xTest,<span class="at">col=</span>dgreen,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>)</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>    <span class="fu">lines</span>(xpred,<span class="fu">predict</span>(fti,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>xpred)),<span class="at">col=</span>cols[<span class="fu">which</span>(whichPlot<span class="sc">==</span>iDegree)])</span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">&quot;Degree =&quot;</span>,iDegree),<span class="dv">3</span>,<span class="at">line=</span><span class="fl">0.5</span>)</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a>  }</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>}</span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Training data&quot;</span>,<span class="st">&quot;Test data&quot;</span>),<span class="at">pch=</span><span class="fu">c</span>(<span class="st">&quot;o&quot;</span>,<span class="st">&quot;*&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,dgreen))</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk fig5.1" />
<div class="figcaption">plot of chunk fig5.1</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">print</span>(err)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; [1] 10.566356  1.729799  1.742761  1.945641  5.632565  5.681434  7.815761 10.459043</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">2.75</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>),<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>nDegree,errTrain,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(err,errTrain))),<span class="at">ylab=</span><span class="st">&quot;Mean squared error&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Degree of polynomial [log scale]&quot;</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">log=</span><span class="st">&quot;x&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>nDegree,err,<span class="at">col=</span>dgreen)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="cf">for</span>(iDegree <span class="cf">in</span> whichPlot)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,iDegree,<span class="at">col.ticks=</span>cols[<span class="fu">which</span>(whichPlot<span class="sc">==</span>iDegree)],<span class="at">col.axis=</span>cols[<span class="fu">which</span>(whichPlot<span class="sc">==</span>iDegree)])</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Training data&quot;</span>,<span class="st">&quot;Test data&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,dgreen))</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk fig5.2" />
<div class="figcaption">plot of chunk fig5.2</div>
</div>
</div>
<div id="code-box-5.1-using-validation-for-model-selection-using-angelas-plant-height-data" class="section level2">
<h2>Code Box 5.1: Using validation for model selection using Angela’s
plant height data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(globalPlants)[<span class="dv">1</span>]</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>indTrain <span class="ot">=</span> <span class="fu">sample</span>(n,n<span class="sc">^</span><span class="fl">0.75</span>) <span class="co">#select a training sample of size n^0.75:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>datTrain <span class="ot">=</span> globalPlants[indTrain,]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>datTest <span class="ot">=</span> globalPlants[<span class="sc">-</span>indTrain,]</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>ft_r <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain,<span class="at">dat=</span>datTrain)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>ft_rs <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain<span class="sc">+</span>rain.seas,<span class="at">dat=</span>datTrain)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>pr_r <span class="ot">=</span> <span class="fu">predict</span>(ft_r,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>pr_rs <span class="ot">=</span> <span class="fu">predict</span>(ft_rs,<span class="at">newdata=</span>datTest)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>rss_r <span class="ot">=</span> <span class="fu">mean</span>( (<span class="fu">log</span>(datTest<span class="sc">$</span>height)<span class="sc">-</span>pr_r)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>rss_rs <span class="ot">=</span> <span class="fu">mean</span>( (<span class="fu">log</span>(datTest<span class="sc">$</span>height)<span class="sc">-</span>pr_rs)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">c</span>(rss_r,rss_rs) )</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; [1] 2.668369 2.467766</span></span></code></pre></div>
</div>
<div id="code-box-5.2-5-fold-cross-validation-for-the-data-of-exercise-5.1" class="section level2">
<h2>Code Box 5.2: 5-fold cross-validation for the data of Exercise
5.1</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>ft_r <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain,<span class="at">dat=</span>globalPlants)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>ft_rs <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain<span class="sc">+</span>rain.seas,<span class="at">dat=</span>globalPlants)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>cv_r <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_r, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>cv_rs <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_rs, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">c</span>( <span class="fu">attr</span>(cv_r,<span class="st">&quot;ms&quot;</span>),<span class="fu">attr</span>(cv_rs,<span class="st">&quot;ms&quot;</span>) ), <span class="at">digits=</span><span class="dv">6</span> )</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; [1] 2.22541 2.15883</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>cv_r <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_r, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">1</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>cv_rs <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_rs, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">1</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">c</span>( <span class="fu">attr</span>(cv_r,<span class="st">&quot;ms&quot;</span>),<span class="fu">attr</span>(cv_rs,<span class="st">&quot;ms&quot;</span>) ), <span class="at">digits=</span><span class="dv">6</span> )</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; [1] 2.21103 2.16553</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>cv_r <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_r, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">2</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>cv_rs <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_rs, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">2</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">c</span>( <span class="fu">attr</span>(cv_r,<span class="st">&quot;ms&quot;</span>),<span class="fu">attr</span>(cv_rs,<span class="st">&quot;ms&quot;</span>) ), <span class="at">digits=</span><span class="dv">6</span> )</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; [1] 2.22425 2.14762</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>cv_r <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_r, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">3</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>cv_rs <span class="ot">=</span> <span class="fu">cv.lm</span>(<span class="at">data=</span>globalPlants, ft_rs, <span class="at">m=</span><span class="dv">5</span>, <span class="at">printit=</span><span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">3</span>, <span class="at">plotit=</span><span class="cn">FALSE</span>) <span class="co"># 5 fold CV</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">c</span>( <span class="fu">attr</span>(cv_r,<span class="st">&quot;ms&quot;</span>),<span class="fu">attr</span>(cv_rs,<span class="st">&quot;ms&quot;</span>) ), <span class="at">digits=</span><span class="dv">6</span> )</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; [1] 2.2783 2.2373</span></span></code></pre></div>
</div>
<div id="code-box-5.3-computing-information-criteria-on-r-for-exercise-5.1" class="section level2">
<h2>Code Box 5.3: Computing Information Criteria on <code>R</code> for
Exercise 5.1</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>ft_r <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain,<span class="at">dat=</span>globalPlants)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ft_rs <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain<span class="sc">+</span>rain.seas,<span class="at">dat=</span>globalPlants)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">AIC</span>(ft_r), <span class="fu">AIC</span>(ft_rs) )</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [1] 479.6605 475.4343</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">BIC</span>(ft_r), <span class="fu">BIC</span>(ft_rs) )</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [1] 488.2861 486.9351</span></span></code></pre></div>
</div>
<div id="code-box-5.4-all-subsets-selection-for-the-plant-height-data-of-5.1" class="section level2">
<h2>Code Box 5.4: All subsets selection for the plant height data of
5.1</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;leaps&#39; was built under R version 4.3.3</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>fit_heightallsub<span class="ot">&lt;-</span><span class="fu">regsubsets</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.wetm<span class="sc">+</span>temp.seas,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">data=</span>globalPlants,<span class="at">nbest=</span><span class="dv">2</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">summary</span>(fit_heightallsub)<span class="sc">$</span>outmat,<span class="fu">summary</span>(fit_heightallsub)<span class="sc">$</span>bic)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;          temp rain rain.wetm temp.seas                    </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 1  ( 1 ) &quot; &quot;  &quot; &quot;  &quot;*&quot;       &quot; &quot;       &quot;-21.06175277099&quot;  </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 1  ( 2 ) &quot; &quot;  &quot;*&quot;  &quot; &quot;       &quot; &quot;       &quot;-19.2868231448677&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 2  ( 1 ) &quot;*&quot;  &quot;*&quot;  &quot; &quot;       &quot; &quot;       &quot;-24.8920679441895&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 2  ( 2 ) &quot;*&quot;  &quot; &quot;  &quot;*&quot;       &quot; &quot;       &quot;-23.9315826810965&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 3  ( 1 ) &quot;*&quot;  &quot;*&quot;  &quot; &quot;       &quot;*&quot;       &quot;-20.9786934545272&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 3  ( 2 ) &quot;*&quot;  &quot;*&quot;  &quot;*&quot;       &quot; &quot;       &quot;-20.3405400349995&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 4  ( 1 ) &quot;*&quot;  &quot;*&quot;  &quot;*&quot;       &quot;*&quot;       &quot;-16.4229239023018&quot;</span></span></code></pre></div>
</div>
<div id="code-box-5.5-stepwise-subset-selection-for-the-plant-height-data-of-5.1" class="section level2">
<h2>Code Box 5.5: Stepwise subset selection for the plant height data of
5.1</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>ft_clim <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.wetm<span class="sc">+</span>temp.seas,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>   <span class="at">data=</span>globalPlants)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>stepClim<span class="ot">=</span><span class="fu">step</span>(ft_clim,<span class="at">trace=</span><span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>stepClim<span class="sc">$</span>anova</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;          Step Df  Deviance Resid. Df Resid. Dev       AIC</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 1             NA        NA       126   260.6727 100.13694</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 2 - rain.wetm  1 0.6363946       127   261.3091  98.45637</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 3 - temp.seas  1 1.9256333       128   263.2347  97.41819</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>ft_int <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>globalPlants)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>stepForward <span class="ot">&lt;-</span> <span class="fu">step</span>(ft_int,<span class="at">scope=</span><span class="fu">formula</span>(ft_clim),<span class="at">direction=</span><span class="st">&quot;forward&quot;</span>,</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>    <span class="at">trace=</span><span class="dv">0</span>)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>stepForward<span class="sc">$</span>anova</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;          Step Df Deviance Resid. Df Resid. Dev       AIC</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 1             NA       NA       130   355.9206 132.93585</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; 2 + rain.wetm -1 74.59845       129   281.3221 104.12370</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 3      + temp -1 16.15030       128   265.1718  98.37867</span></span></code></pre></div>
</div>
<div id="simulation-code-for-figure-5.4" class="section level2">
<h2>Simulation code for Figure 5.4</h2>
<p>I used <code>nSim=1000</code> in the book, but have set it to
<code>50</code> here so the code doesn’t take ages to run…</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>nSim <span class="ot">=</span> <span class="dv">50</span> <span class="co"># increase this for a more precise answer </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">32</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,p<span class="dv">-2</span>))</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>pTrue<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>rho<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>Sigma <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">-</span>rho,p))<span class="sc">+</span>rho</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">rmvnorm</span>(n,<span class="at">sigma=</span>Sigma)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>eta <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>resArray <span class="ot">=</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,nSim))</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="fu">dimnames</span>(resArray)[[<span class="dv">1</span>]]<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;AIC&quot;</span>,<span class="st">&quot;MStrue&quot;</span>,<span class="st">&quot;propTrue&quot;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="fu">dimnames</span>(resArray)[[<span class="dv">2</span>]]<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;for&quot;</span>,<span class="st">&quot;back&quot;</span>)</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>counter  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="cf">for</span>(iSim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSim)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>{</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>  y <span class="ot">=</span> eta <span class="sc">+</span> <span class="fu">rnorm</span>(n)<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>  <span class="co"># construct matrix of all possible subsets</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>  allSubs <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">2</span><span class="sc">^</span>p,p)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>  <span class="cf">for</span>(iVar <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>    allSubs[,iVar] <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">each=</span><span class="dv">2</span><span class="sc">^</span>(p<span class="sc">-</span>iVar),<span class="at">times=</span><span class="dv">2</span><span class="sc">^</span>(iVar<span class="dv">-1</span>))</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>  <span class="co"># define vectors to stor AIC and MS</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>  aics <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">2</span><span class="sc">^</span>p)</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a>  ms   <span class="ot">=</span> aics</span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>  isTrue<span class="ot">=</span>aics</span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a>  <span class="co"># intercept first as it will give error</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>  ft0 <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>  aics[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">AIC</span>(ft0)</span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>  ms[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">mean</span>((<span class="fu">predict</span>(ft0)<span class="sc">-</span>eta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a>  isTrue[<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a>  <span class="co"># now get all subset results</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>  <span class="cf">for</span>(iModel <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">2</span><span class="sc">^</span>p)</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a>  {</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a>    ft <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>X[,allSubs[iModel,]<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a>    aics[iModel] <span class="ot">=</span> <span class="fu">AIC</span>(ft)</span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a>    ms[iModel] <span class="ot">=</span> <span class="fu">mean</span>((<span class="fu">predict</span>(ft)<span class="sc">-</span>eta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>    isTrue[iModel] <span class="ot">=</span> allSubs[iModel,<span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> allSubs[iModel,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">sum</span>(allSubs[iModel,])<span class="sc">==</span><span class="dv">2</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a>  }</span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a>  whichBest <span class="ot">=</span> <span class="fu">which</span>(aics<span class="sc">==</span><span class="fu">min</span>(aics))[<span class="dv">1</span>] <span class="co">#if tie take the first one, probably smaller, but whatever this won&#39;t happen</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a>  <span class="co"># now backward stepwise</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a>  ftBack <span class="ot">=</span> <span class="fu">step</span>(<span class="fu">lm</span>(y<span class="sc">~</span>.,<span class="at">data=</span><span class="fu">data.frame</span>(X)),<span class="at">trace=</span><span class="dv">0</span>,<span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a>  aicBack <span class="ot">=</span> <span class="fu">AIC</span>(ftBack)</span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a>  msBack <span class="ot">=</span> <span class="fu">mean</span>((<span class="fu">predict</span>(ftBack)<span class="sc">-</span>eta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a>  trueBack <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">coef</span>(ftBack))<span class="sc">==</span><span class="dv">3</span> <span class="sc">&amp;</span> <span class="st">&quot;X1&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">coef</span>(ftBack)) <span class="sc">&amp;</span> <span class="st">&quot;X2&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">coef</span>(ftBack))</span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a>  <span class="co"># now forward stepwise</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a>  scopeForm<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>,<span class="dv">1</span><span class="sc">:</span>p,<span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a>  ftFor <span class="ot">=</span> <span class="fu">step</span>(<span class="fu">lm</span>(y<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span><span class="fu">data.frame</span>(X)),<span class="at">scope=</span><span class="fu">paste</span>(<span class="st">&quot;~&quot;</span>,scopeForm),<span class="at">trace=</span><span class="dv">0</span>,<span class="at">direction=</span><span class="st">&quot;forward&quot;</span>)</span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a>  aicFor <span class="ot">=</span> <span class="fu">AIC</span>(ftFor)</span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a>  msFor <span class="ot">=</span> <span class="fu">mean</span>((<span class="fu">predict</span>(ftFor)<span class="sc">-</span>eta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a>  trueFor <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">coef</span>(ftFor))<span class="sc">==</span><span class="dv">3</span> <span class="sc">&amp;</span> <span class="st">&quot;X1&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">coef</span>(ftFor)) <span class="sc">&amp;</span> <span class="st">&quot;X2&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">coef</span>(ftFor))</span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a>  counterAdd <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a>  resArray[<span class="dv">1</span>,,iSim] <span class="ot">=</span> <span class="fu">c</span>(aics[whichBest],aicFor,aicBack)</span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a>  resArray[<span class="dv">2</span>,,iSim] <span class="ot">=</span> <span class="fu">c</span>(ms[whichBest],msFor,msBack)</span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a>  resArray[<span class="dv">3</span>,,iSim] <span class="ot">=</span> <span class="fu">c</span>(isTrue[whichBest],trueFor,trueBack)</span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a>  eps<span class="ot">=</span><span class="dv">1</span>.e<span class="dv">-8</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a>  whichAIC <span class="ot">=</span> <span class="fu">which</span>(resArray[<span class="dv">1</span>,,iSim]<span class="sc">&lt;</span><span class="fu">min</span>(resArray[<span class="dv">1</span>,,iSim])<span class="sc">+</span>eps)</span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a>  counterAdd[<span class="dv">1</span>,whichAIC] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a>  whichMS <span class="ot">=</span> <span class="fu">which</span>(resArray[<span class="dv">2</span>,,iSim]<span class="sc">&lt;</span><span class="fu">min</span>(resArray[<span class="dv">2</span>,,iSim])<span class="sc">+</span>eps)</span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a>  counterAdd[<span class="dv">2</span>,whichMS] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a>  counterAdd[<span class="dv">3</span>,] <span class="ot">=</span> resArray[<span class="dv">3</span>,,iSim]</span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a>  counter <span class="ot">=</span> counter <span class="sc">+</span> counterAdd</span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a>}</span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#end sim</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a>resMean <span class="ot">=</span> <span class="fu">apply</span>(resArray,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),mean)</span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a>resSD <span class="ot">=</span> <span class="fu">apply</span>(resArray,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),sd)<span class="sc">/</span><span class="fu">sqrt</span>(nSim)</span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a>counter <span class="ot">=</span> counter<span class="sc">/</span>nSim</span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="fu">print</span>(resMean)</span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt;                  all         for       back</span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt; AIC      135.6532644 135.9232694 135.750229</span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; MStrue     0.9629137   0.9017192   1.001753</span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; propTrue   0.1400000   0.1600000   0.120000</span></span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.75</span>,<span class="dv">0</span>),<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a><span class="fu">plot</span>(resMean[<span class="dv">1</span>,],<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">3.5</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">xlab=</span><span class="st">&quot;AIC&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlim=</span><span class="fu">range</span>(resMean[<span class="dv">1</span>,]<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>resSD[<span class="dv">1</span>,],resMean[<span class="dv">1</span>,]<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>resSD[<span class="dv">1</span>,]))</span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a><span class="cf">for</span>(iMethod <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb9-93"><a href="#cb9-93" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(resMean[<span class="dv">1</span>,iMethod]<span class="sc">-</span>resSD[<span class="dv">1</span>,iMethod]<span class="sc">*</span><span class="dv">2</span>,resMean[<span class="dv">1</span>,iMethod]<span class="sc">+</span>resSD[<span class="dv">1</span>,iMethod]<span class="sc">*</span><span class="dv">2</span>),<span class="fu">c</span>(iMethod,iMethod),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb9-94"><a href="#cb9-94" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;All subsets&quot;</span>,<span class="st">&quot;Forward&quot;</span>,<span class="st">&quot;Backward&quot;</span>),<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb9-95"><a href="#cb9-95" tabindex="-1"></a></span>
<span id="cb9-96"><a href="#cb9-96" tabindex="-1"></a><span class="fu">plot</span>(resMean[<span class="dv">2</span>,],<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">3.5</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean squared error of &quot;</span>,<span class="fu">hat</span>(mu))),<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlim=</span><span class="fu">range</span>(resMean[<span class="dv">2</span>,]<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>resSD[<span class="dv">2</span>,],resMean[<span class="dv">2</span>,]<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>resSD[<span class="dv">2</span>,]))</span>
<span id="cb9-97"><a href="#cb9-97" tabindex="-1"></a><span class="cf">for</span>(iMethod <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb9-98"><a href="#cb9-98" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(resMean[<span class="dv">2</span>,iMethod]<span class="sc">-</span>resSD[<span class="dv">2</span>,iMethod]<span class="sc">*</span><span class="dv">2</span>,resMean[<span class="dv">2</span>,iMethod]<span class="sc">+</span>resSD[<span class="dv">2</span>,iMethod]<span class="sc">*</span><span class="dv">2</span>),<span class="fu">c</span>(iMethod,iMethod),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb9-99"><a href="#cb9-99" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot; &quot;</span>,<span class="st">&quot; &quot;</span>,<span class="st">&quot; &quot;</span>),<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk subsetsim" />
<div class="figcaption">plot of chunk subsetsim</div>
</div>
</div>
<div id="code-box-5.6-lasso-for-plant-height-data-of-5.1" class="section level2">
<h2>Code Box 5.6: LASSO for plant height data of 5.1</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;glmnet&#39; was built under R version 4.3.3</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(globalPlants<span class="sc">$</span>temp, globalPlants<span class="sc">$</span>rain, globalPlants<span class="sc">$</span>rain.wetm,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>   globalPlants<span class="sc">$</span>temp.seas)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>ft_heightcv<span class="ot">=</span><span class="fu">cv.glmnet</span>(X,<span class="fu">log</span>(globalPlants<span class="sc">$</span>height))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">plot</span>(ft_heightcv)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk box5.6" />
<div class="figcaption">plot of chunk box5.6</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>ft_lasso<span class="ot">=</span><span class="fu">glmnet</span>(X,<span class="fu">log</span>(globalPlants<span class="sc">$</span>height),<span class="at">lambda=</span>ft_heightcv<span class="sc">$</span>lambda.min)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>ft_lasso<span class="sc">$</span>beta</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 4 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;              s0</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; V1 0.0424080540</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; V2 0.0003785307</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; V3 0.0014047575</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; V4 .</span></span></code></pre></div>
</div>
<div id="exercise-5.2-relative-importance-of-climate-variables" class="section level2">
<h2>Exercise 5.2: Relative importance of climate variables</h2>
<p><em>How important are the different climate variables in explaining
plant height?</em></p>
<p>We are asked to quantify variable importance. A couple of techniques
are suggested in Code Boxes 5.8-5.9.</p>
</div>
<div id="code-box-5.7-sequential-r2-for-variable-importance" class="section level2">
<h2>Code Box 5.7: Sequential <span class="math inline">\(R^2\)</span>
for variable importance</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ft_clim <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.wetm<span class="sc">+</span>temp.seas,<span class="at">data=</span>globalPlants)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>ft_int <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>globalPlants)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>stepAnova <span class="ot">=</span> <span class="fu">step</span>(ft_int, <span class="at">scope=</span><span class="fu">formula</span>(ft_clim), <span class="at">direction=</span><span class="st">&quot;forward&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                     <span class="at">trace=</span><span class="dv">0</span>, <span class="at">k=</span><span class="dv">0</span>)<span class="sc">$</span>anova</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>stepAnova<span class="sc">$</span>R2 <span class="ot">=</span> stepAnova<span class="sc">$</span>Deviance<span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>stepAnova</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;          Step Df  Deviance Resid. Df Resid. Dev       AIC          R2</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; 1             NA        NA       130   355.9206 130.93585          NA</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 2 + rain.wetm -1 74.598450       129   281.3221 100.12370 0.209592965</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; 3      + temp -1 16.150298       128   265.1718  92.37867 0.045376129</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 4      + rain -1  2.586703       127   262.5851  91.09452 0.007267641</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; 5 + temp.seas -1  1.912441       126   260.6727  90.13694 0.005373225</span></span></code></pre></div>
</div>
<div id="code-box-5.8-marginal-and-conditional-r2-for-variable-importance" class="section level2">
<h2>Code Box 5.8: Marginal and conditional <span class="math inline">\(R^2\)</span> for variable importance</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>stepMargin<span class="ot">=</span><span class="fu">add1</span>(ft_int,<span class="at">scope=</span><span class="fu">formula</span>(ft_clim))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>stepMargin<span class="sc">$</span>R2<span class="ot">=</span>stepMargin<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>stepMargin</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; Single term additions</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; log(height) ~ 1</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq    RSS    AIC      R2</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 355.92 132.94        </span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; temp       1    66.224 289.70 107.97 0.18607</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; rain       1    70.761 285.16 105.90 0.19881</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; rain.wetm  1    74.598 281.32 104.12 0.20959</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; temp.seas  1    46.401 309.52 116.64 0.13037</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>leave1out<span class="ot">=</span><span class="fu">drop1</span>(ft_clim)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>leave1out<span class="sc">$</span>R2<span class="ot">=</span>leave1out<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>leave1out</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Single term deletions</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; log(height) ~ temp + rain + rain.wetm + temp.seas</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq    RSS     AIC       R2</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 260.67 100.137         </span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; temp       1   16.0581 276.73 105.968 0.045117</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; rain       1    3.4438 264.12  99.856 0.009676</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; rain.wetm  1    0.6364 261.31  98.456 0.001788</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; temp.seas  1    1.9124 262.58  99.095 0.005373</span></span></code></pre></div>
</div>
<div id="code-box-5.9-standardised-coefficients-for-angelas-height-data" class="section level2">
<h2>Code Box 5.9: Standardised coefficients for Angela’s height
data</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># first create a dataset with standardised predictors:</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>globalPlantStand<span class="ot">=</span>globalPlants</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>whichVars<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;temp&quot;</span>,<span class="st">&quot;rain&quot;</span>,<span class="st">&quot;rain.wetm&quot;</span>,<span class="st">&quot;temp.seas&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>globalPlantStand[,whichVars]<span class="ot">=</span><span class="fu">scale</span>(globalPlantStand[,whichVars])</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># then fit the model:</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>ft_climStand <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.wetm<span class="sc">+</span>temp.seas,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>               <span class="at">data=</span>globalPlantStand)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">summary</span>(ft_climStand)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(height) ~ temp + rain + rain.wetm + temp.seas, </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;     data = globalPlantStand)</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; -2.9649 -1.0454 -0.0122  0.9801  3.4005 </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; (Intercept)   1.1947     0.1257   9.507  &lt; 2e-16 ***</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; temp          0.5715     0.2051   2.786  0.00616 ** </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; rain          0.4185     0.3244   1.290  0.19934    </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; rain.wetm     0.1860     0.3353   0.555  0.58013    </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; temp.seas     0.2090     0.2174   0.961  0.33816    </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.438 on 126 degrees of freedom</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.2676, Adjusted R-squared:  0.2444 </span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; F-statistic: 11.51 on 4 and 126 DF,  p-value: 5.378e-08</span></span></code></pre></div>
</div>
<div id="exercise-5.3-variable-importance-output" class="section level2">
<h2>Exercise 5.3: Variable importance output</h2>
<p><em>Compare the <span class="math inline">\(R^2\)</span> results of
Code Boxes 5.7-5.8. Which table(s) do you think Angela should report
when describing variable importance?</em></p>
<p>This is a tough one – I guess the main story is that:</p>
<ol style="list-style-type: decimal">
<li>a rain variable (whether <code>rain</code> or
<code>rain.wetm</code>) explains a big hcunk of variation</li>
<li><code>temp</code> explains a fair bit of variation even after rain
variables are in the model</li>
</ol>
<p>The most concise way to make these points would be to show the
marginal <span class="math inline">\(R^2\)</span> table to make point 1,
and the conditional <span class="math inline">\(R^2\)</span> table to
make point 2.</p>
<p><em>Now look at the standardised coefficients in Code Box 5.9. Do
these coefficients measure marginal or conditional effects? Which of the
<span class="math inline">\(R^2\)</span> tables in Code Box 5.8 are they
most similar to in relative size (e.g. ranking from largest to
smallest)? Is this what you expected?</em></p>
<p>The <code>summary</code> function tells us about the coefficients in
the model, which always measure <em>conditional</em> effects after all
other terms have been added to the model. The conditional <span class="math inline">\(R^2\)</span> table gives the most similar answers,
with the same ranking of predictors (largest to smallest). The
standardised coefficient for<code>rain.wetm</code> is larger than I
expected, and for <code>temp</code> it is smaller than I expected, from
looking at the conditional <span class="math inline">\(R^2\)</span>
values. I guess this is because of differences in the extent of
collinearity across predictors.</p>
</div>
<div id="code-box-5.10-importance-of-temperature-vs-rainfall" class="section level2">
<h2>Code Box 5.10: Importance of temperature vs rainfall</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ft_onlyTemp <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>temp<span class="sc">+</span>temp.seas,<span class="at">data=</span>globalPlants)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>tempAn<span class="ot">=</span><span class="fu">anova</span>(ft_int,ft_onlyTemp,ft_clim)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>tempAn<span class="sc">$</span>R2<span class="ot">=</span>tempAn<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>tempAn</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Model 1: log(height) ~ 1</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Model 2: log(height) ~ temp + temp.seas</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Model 3: log(height) ~ temp + rain + rain.wetm + temp.seas</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F     Pr(&gt;F)       R2</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 1    130 355.92                                        </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; 2    128 289.00  2    66.917 16.173 0.00000056 0.188011</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; 3    126 260.67  2    28.331  6.847 0.00150359 0.079599</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>ft_onlyRain <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(height)<span class="sc">~</span>rain<span class="sc">+</span>rain.wetm,<span class="at">data=</span>globalPlants)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>rainAn<span class="ot">=</span><span class="fu">anova</span>(ft_int,ft_onlyRain,ft_clim)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>rainAn<span class="sc">$</span>R2<span class="ot">=</span>rainAn<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>rainAn</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Model 1: log(height) ~ 1</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Model 2: log(height) ~ rain + rain.wetm</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Model 3: log(height) ~ temp + rain + rain.wetm + temp.seas</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)       R2</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 1    130 355.92                                        </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 2    128 279.80  2    76.118 18.3964 0.0000001 0.213863</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 3    126 260.67  2    19.130  4.6233 0.0115445 0.053747</span></span></code></pre></div>
</div>
<div id="code-for-figure-5.5" class="section level1">
<h1>Code for Figure 5.5</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  R2sTemp <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,tempAn<span class="sc">$</span>R2[<span class="dv">2</span>])</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  R2sRain <span class="ot">=</span> <span class="fu">c</span>(rainAn<span class="sc">$</span>R2[<span class="dv">3</span>],<span class="fu">sum</span>(rainAn<span class="sc">$</span>R2[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  R2error<span class="ot">=</span><span class="fu">c</span>(<span class="fu">sum</span>(rainAn<span class="sc">$</span>R2[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),<span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  darkBlue<span class="ot">=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  darkRed<span class="ot">=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  darkYellow<span class="ot">=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span>),<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(R2error,R2error[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>]),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.25</span>),<span class="at">lwd=</span><span class="fl">0.25</span>,<span class="at">border=</span>darkYellow)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(R2sTemp,R2sTemp[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>]),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.25</span>),<span class="at">border=</span>darkRed,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(R2sRain,R2sRain[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>]),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.25</span>),<span class="at">border=</span>darkBlue,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>  yText<span class="ot">=</span><span class="fl">0.15</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  eps<span class="ot">=</span><span class="fl">0.008</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fu">mean</span>(R2error),<span class="fl">0.5</span>,<span class="st">&#39;Unexplained&#39;</span>,<span class="at">adj=</span><span class="fl">0.5</span>,<span class="at">col=</span>darkYellow)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">text</span>(eps,yText,<span class="st">&#39;Temperature&#39;</span>,<span class="at">adj=</span><span class="dv">0</span>,<span class="at">col=</span>darkRed)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  <span class="fu">text</span>(R2sRain[<span class="dv">2</span>]<span class="sc">-</span>eps,<span class="dv">1</span><span class="sc">-</span>yText,<span class="st">&#39;Rainfall&#39;</span>,<span class="at">adj=</span><span class="dv">1</span>,<span class="at">col=</span>darkBlue)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk fig5.5" />
<div class="figcaption">plot of chunk fig5.5</div>
</div>
<div id="exercise-5.4-head-bobs-in-lizards-do-their-displays-change-with-the-environment" class="section level2">
<h2>Exercise 5.4: Head bobs in lizards – do their displays change with
the environment?</h2>
<p><em>Terry… wanted to know which environmental features (out of
temperature, light and noisiness) were related to head bobbing
speed</em></p>
<p>This is a model selection question, we want to see which
environmental variables are associated with head-bobbing, so will try a
bunch of different models with different predictors to see which one(s)
fits best.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">data</span>(headbobLizards)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">str</span>(headbobLizards)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    14 obs. of  10 variables:</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;  $ LizardID           : Factor w/ 14 levels &quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt;  $ Observation        : num  1 1 1 1 1 3.1 1 5 2 1 ...</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt;  $ Display            : int  3 1 1 1 1 1 1 2 1 2 ...</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt;  $ ObservationDate    : Factor w/ 19 levels &quot;03-07-05&quot;,&quot;04-07-05&quot;,..: 1 2 1 1 1 3 1 2 3 1 ...</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;  $ ObservationTime24hr: Factor w/ 342 levels &quot;10:00&quot;,&quot;10:03&quot;,..: 186 325 205 243 232 173 300 191 305 165 ...</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;  $ TemperatureC       : num  25.7 27.2 26.2 26.2 26 27.6 26.2 27.1 27 28.1 ...</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt;  $ AmbientLight       : num  0.47 4.13 2.46 0.31 2.36 ...</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt;  $ Bg_noise_max       : num  11.1 16.47 9.32 2.29 7.37 ...</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt;  $ Hbspd_max          : num  29.7 54.4 34.6 26.7 28.7 ...</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;  $ time               : POSIXct, format: &quot;2005-07-03 15:44:00&quot; &quot;2005-07-04 09:33:00&quot; &quot;2005-07-03 16:18:00&quot; &quot;2005-07-03 17:50:00&quot; ...</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co"># try some AIC funny-business</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="fu">plot</span>(Hbspd_max<span class="sc">~</span>TemperatureC,<span class="at">data=</span>headbobLizards)</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="fu">plot</span>(Hbspd_max<span class="sc">~</span>Bg_noise_max,<span class="at">data=</span>headbobLizards)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk headbobs" />
<div class="figcaption">plot of chunk headbobs</div>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co"># my vote is log-transformation, covers almost a factor of 3 and a bit of right-skew:</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">plot</span>(Hbspd_max<span class="sc">~</span>TemperatureC,<span class="at">data=</span>headbobLizards,<span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="fu">plot</span>(Hbspd_max<span class="sc">~</span>Bg_noise_max,<span class="at">data=</span>headbobLizards,<span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk headbobs" />
<div class="figcaption">plot of chunk headbobs</div>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>headbobLizards<span class="sc">$</span>bobspeed<span class="ot">=</span><span class="fu">log</span>(headbobLizards<span class="sc">$</span>Hbspd_max)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>ft_headbob<span class="ot">=</span><span class="fu">lm</span>(bobspeed<span class="sc">~</span>TemperatureC<span class="sc">+</span>AmbientLight<span class="sc">+</span>Bg_noise_max,<span class="at">data=</span>headbobLizards)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_headbob)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk headbobs" />
<div class="figcaption">plot of chunk headbobs</div>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">stepAIC</span>(ft_headbob)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=-35.58</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; bobspeed ~ TemperatureC + AmbientLight + Bg_noise_max</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt;                Df Sum of Sq     RSS     AIC</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; - Bg_noise_max  1  0.018757 0.64139 -37.164</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                      0.62264 -35.580</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; - AmbientLight  1  0.113540 0.73618 -35.235</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; - TemperatureC  1  0.193576 0.81621 -33.790</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=-37.16</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; bobspeed ~ TemperatureC + AmbientLight</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt;                Df Sum of Sq     RSS     AIC</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                      0.64139 -37.164</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt; - AmbientLight  1   0.14217 0.78356 -36.361</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; - TemperatureC  1   0.46327 1.10466 -31.553</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; lm(formula = bobspeed ~ TemperatureC + AmbientLight, data = headbobLizards)</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt;  (Intercept)  TemperatureC  AmbientLight  </span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt;    -1.930275      0.210716     -0.009144</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="fu">summary</span>(ft_headbob)</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; lm(formula = bobspeed ~ TemperatureC + AmbientLight + Bg_noise_max, </span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt;     data = headbobLizards)</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; -0.29881 -0.15097 -0.02893  0.07918  0.43165 </span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -1.085254   2.581853  -0.420    0.683</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; TemperatureC  0.176014   0.099825   1.763    0.108</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; AmbientLight -0.008383   0.006208  -1.350    0.207</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt; Bg_noise_max  0.006418   0.011693   0.549    0.595</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2495 on 10 degrees of freedom</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4611, Adjusted R-squared:  0.2994 </span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a><span class="co">#&gt; F-statistic: 2.852 on 3 and 10 DF,  p-value: 0.09115</span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>ft_2<span class="ot">=</span><span class="fu">lm</span>(bobspeed<span class="sc">~</span>TemperatureC<span class="sc">+</span>AmbientLight,<span class="at">data=</span>headbobLizards)</span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a><span class="fu">summary</span>(ft_2)</span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a><span class="co">#&gt; lm(formula = bobspeed ~ TemperatureC + AmbientLight, data = headbobLizards)</span></span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a><span class="co">#&gt; -0.30317 -0.15088 -0.03001  0.07111  0.45789 </span></span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -1.930275   2.005678  -0.962   0.3565  </span></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a><span class="co">#&gt; TemperatureC  0.210716   0.074756   2.819   0.0167 *</span></span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a><span class="co">#&gt; AmbientLight -0.009144   0.005856  -1.561   0.1467  </span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2415 on 11 degrees of freedom</span></span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4448, Adjusted R-squared:  0.3439 </span></span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a><span class="co">#&gt; F-statistic: 4.407 on 2 and 11 DF,  p-value: 0.0393</span></span>
<span id="cb20-67"><a href="#cb20-67" tabindex="-1"></a></span>
<span id="cb20-68"><a href="#cb20-68" tabindex="-1"></a>ft_int<span class="ot">=</span><span class="fu">lm</span>(bobspeed<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>headbobLizards)</span>
<span id="cb20-69"><a href="#cb20-69" tabindex="-1"></a><span class="fu">BIC</span>(ft_int,ft_2,ft_headbob)</span>
<span id="cb20-70"><a href="#cb20-70" tabindex="-1"></a><span class="co">#&gt;            df       BIC</span></span>
<span id="cb20-71"><a href="#cb20-71" tabindex="-1"></a><span class="co">#&gt; ft_int      2 10.082646</span></span>
<span id="cb20-72"><a href="#cb20-72" tabindex="-1"></a><span class="co">#&gt; ft_2        4  7.122104</span></span>
<span id="cb20-73"><a href="#cb20-73" tabindex="-1"></a><span class="co">#&gt; ft_headbob  5  9.345644</span></span></code></pre></div>
<p>There’s actually a suggestion of non-linearity here, there are only a
few points making that pattern though so I’m not sure. Also not sure if
that makes sense, for lizards to get most active at an intermediate
temperature, would need to check with Terry on that one…</p>
<p>But in any case, the main story seems to be that noisiness doesn’t
seem that important, it is more about temperature and light. Some <span class="math inline">\(R^2\)</span> values might help understand variable
relative importance:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>stepMargin<span class="ot">=</span><span class="fu">add1</span>(ft_int,<span class="at">scope=</span><span class="fu">formula</span>(ft_headbob))</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>stepMargin<span class="sc">$</span>R2<span class="ot">=</span>stepMargin<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>stepMargin</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; Single term additions</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; bobspeed ~ 1</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt;              Df Sum of Sq     RSS     AIC      R2</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                    1.15530 -32.926        </span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; TemperatureC  1   0.37174 0.78356 -36.361 0.32177</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; AmbientLight  1   0.05064 1.10466 -31.553 0.04384</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; Bg_noise_max  1   0.29569 0.85962 -35.065 0.25594</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>leave1out<span class="ot">=</span><span class="fu">drop1</span>(ft_headbob)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>leave1out<span class="sc">$</span>R2<span class="ot">=</span>leave1out<span class="sc">$</span><span class="st">`</span><span class="at">Sum of Sq</span><span class="st">`</span><span class="sc">/</span><span class="fu">deviance</span>(ft_int)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>leave1out</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; Single term deletions</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; bobspeed ~ TemperatureC + AmbientLight + Bg_noise_max</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt;              Df Sum of Sq     RSS     AIC       R2</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                    0.62264 -35.580         </span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; TemperatureC  1  0.193576 0.81621 -33.790 0.167555</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; AmbientLight  1  0.113540 0.73618 -35.235 0.098278</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; Bg_noise_max  1  0.018757 0.64139 -37.164 0.016235</span></span></code></pre></div>
<p>Well glad we looked at this as well… so temperature and noisiness
both seem associated with headbobs, but after adding temp to the model,
noisiness doesn’t really add anything, whereas the reverse is not true.
So it seems there is a fairly strong association with temp (marginally
32%, conditionally still 17%) and some effect of ambient light
(marginally 4%, after controlling for temp 10%). The large marginal
effect of noisiness is probably due to correlation with temp.</p>
</div>
<div id="exercise-5.5-plant-height-data-and-precipitation" class="section level2">
<h2>Exercise 5.5 Plant height data and precipitation</h2>
<p><em>Find a subset of precipitation variables that optimally predicts
plant height</em></p>
<p>I’ll start with forward selection. We know temp is important so I
will include that in all models</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">str</span>(globalPlants)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    131 obs. of  33 variables:</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;  $ sort_number     : int  1402 25246 11648 8168 22422 25151 26007 6597 16908 4610 ...</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt;  $ site            : int  193 103 54 144 178 27 118 154 106 201 ...</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt;  $ Genus_species   : Factor w/ 175 levels &quot;_8324&quot;,&quot;Abies_veitchii&quot;,..: 5 143 67 45 127 142 147 37 96 28 ...</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;  $ Family          : Factor w/ 68 levels &quot;Annonaceae&quot;,&quot;Asteraceae&quot;,..: 60 37 49 12 50 27 55 31 49 5 ...</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;  $ growthform      : Factor w/ 6 levels &quot;Fern&quot;,&quot;Herb&quot;,..: 6 6 2 4 2 4 6 6 2 4 ...</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt;  $ height          : num  22.86 45 0.55 0.6 0.152 ...</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;  $ Country         : Factor w/ 37 levels &quot;Argentina&quot;,&quot;Australia&quot;,..: 35 26 2 14 35 2 NA 35 2 8 ...</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;  $ Site            : Factor w/ 127 levels &quot;a-ngau&quot;,&quot;ab&quot;,..: 84 74 41 52 55 66 75 45 44 NA ...</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;  $ lat             : num  44.6 12.2 23.8 32.6 41.6 ...</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;  $ long            : num  -123.3 -70.5 133.8 34.9 -87 ...</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;  $ alt             : int  179 386 553 115 200 157 2 71 2 28 ...</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt;  $ temp            : num  10.8 24.5 20.9 19.9 9.7 16.8 27.7 15.5 26.4 5.4 ...</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;  $ diurn.temp      : num  11.8 10.8 16.3 9.7 10.7 10 4.8 11.4 5 6.6 ...</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;  $ isotherm        : num  4.4 7.4 4.8 4.4 2.8 4.8 8.8 3.2 7.4 2.1 ...</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt;  $ temp.seas       : num  5.2 0.9 6 4.9 9.7 3.9 0.2 8.6 0.6 8.3 ...</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt;  $ temp.max.warm   : num  27 31.2 37 30.7 28.6 26.1 30.6 32.9 29.9 21.2 ...</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;  $ temp.min.cold   : num  0.3 16.7 3.6 8.7 -9.5 5.5 25.2 -2.6 23.2 -9 ...</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;  $ temp.ann.range  : num  26.7 14.5 33.4 22 38.1 20.6 5.4 35.5 6.7 30.2 ...</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt;  $ temp.mean.wetqr : num  4.9 25.1 28.1 13.6 21.6 21.2 27.9 15.6 26.8 6.5 ...</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt;  $ temp.mean.dryqr : num  17.4 23.2 14.8 25.3 -3.3 12.3 27.5 21.5 25.7 -1.6 ...</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt;  $ temp.mean.warmqr: num  17.6 25.3 28.1 25.7 21.6 21.4 27.9 26.1 27.1 16.1 ...</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;  $ temp.mean.coldqr: num  4.5 23.1 12.8 13.6 -3.3 11.5 27.5 3.8 25.5 -5 ...</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt;  $ rain            : int  1208 3015 278 598 976 1283 2585 1262 1704 664 ...</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt;  $ rain.wetm       : int  217 416 37 159 104 157 300 129 309 77 ...</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt;  $ rain.drym       : int  13 99 9 0 44 63 82 66 16 31 ...</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt;  $ rain.seas       : int  69 45 42 115 23 29 34 18 66 28 ...</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt;  $ rain.wetqr      : int  601 1177 109 408 299 450 870 382 806 220 ...</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt;  $ rain.dryqr      : int  68 340 35 0 165 208 305 249 92 106 ...</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt;  $ rain.warmqr     : int  75 928 109 2 299 385 855 268 659 191 ...</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt;  $ rain.coldqr     : int  560 359 42 408 165 279 405 325 135 137 ...</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt;  $ LAI             : num  2.51 4.26 1.32 1.01 3.26 4.14 NA 3.14 4.51 3.07 ...</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt;  $ NPP             : int  572 1405 756 359 1131 1563 NA 1266 2296 536 ...</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt;  $ hemisphere      : int  1 -1 -1 1 1 -1 1 1 -1 1 ...</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>globalPlants<span class="sc">$</span>logHt <span class="ot">=</span> <span class="fu">log</span>(globalPlants<span class="sc">$</span>height)</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>ft_temp <span class="ot">=</span> <span class="fu">lm</span>(logHt<span class="sc">~</span>temp, <span class="at">data=</span>globalPlants)</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>ft_tempRain <span class="ot">=</span> <span class="fu">lm</span>(logHt<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.wetm<span class="sc">+</span>rain.drym<span class="sc">+</span>rain.seas<span class="sc">+</span>rain.wetqr<span class="sc">+</span>rain.dryqr<span class="sc">+</span>rain.warmqr<span class="sc">+</span>rain.coldqr, <span class="at">data=</span>globalPlants)</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_tempRain)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk ex5.5plantprecip" />
<div class="figcaption">plot of chunk ex5.5plantprecip</div>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>ft_step <span class="ot">=</span> <span class="fu">step</span>(ft_temp, <span class="at">scope=</span><span class="fu">formula</span>(ft_tempRain), <span class="at">direction=</span><span class="st">&quot;forward&quot;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=107.97</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS     AIC</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; + rain.wetqr   1   26.7393 262.96  97.280</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; + rain         1   26.4615 263.24  97.418</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; + rain.wetm    1   24.5243 265.17  98.379</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; + rain.coldqr  1   20.3413 269.36 100.429</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1   11.2099 278.49 104.796</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1    9.4721 280.22 105.611</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; + rain.drym    1    9.2552 280.44 105.713</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     289.70 107.966</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1    0.0632 289.63 109.938</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=97.28</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp + rain.wetqr</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS    AIC</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; + rain.coldqr  1    4.0676 258.89 97.238</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     262.96 97.280</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; + rain.wetm    1    1.5701 261.39 98.495</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; + rain         1    1.1733 261.78 98.694</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1    0.7535 262.20 98.904</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1    0.5071 262.45 99.027</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt; + rain.drym    1    0.4799 262.48 99.041</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1    0.0841 262.87 99.238</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=97.24</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp + rain.wetqr + rain.coldqr</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS    AIC</span></span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     258.89 97.238</span></span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a><span class="co">#&gt; + rain.wetm    1   1.33741 257.55 98.559</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1   0.12668 258.76 99.174</span></span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1   0.01663 258.87 99.229</span></span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a><span class="co">#&gt; + rain         1   0.01150 258.88 99.232</span></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1   0.00406 258.88 99.236</span></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a><span class="co">#&gt; + rain.drym    1   0.00005 258.89 99.238</span></span></code></pre></div>
<p>So forward selection suggests adding rainfall in the wettest and
coldest quarters to the model.</p>
<p>How about LASSO…</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>XtempRain<span class="ot">=</span><span class="fu">with</span>(globalPlants,<span class="fu">cbind</span>(temp,rain,rain.wetm,rain.drym,rain.seas,rain.wetqr,rain.dryqr,rain.wetqr,rain.dryqr))</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>lasso_rain<span class="ot">=</span><span class="fu">cv.glmnet</span>(XtempRain,globalPlants<span class="sc">$</span>logHt,<span class="at">penalty.factor=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">8</span>)))</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">plot</span>(lasso_rain)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk ex5.5lassorain" />
<div class="figcaption">plot of chunk ex5.5lassorain</div>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>ft_lasso<span class="ot">=</span><span class="fu">glmnet</span>(XtempRain,globalPlants<span class="sc">$</span>logHt,<span class="at">lambda=</span>lasso_rain<span class="sc">$</span>lambda.min)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>ft_lasso<span class="sc">$</span>beta</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; 9 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt;                      s0</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; temp       0.0396005806</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; rain       0.0006377051</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; rain.wetm  .           </span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; rain.drym  .           </span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; rain.seas  0.0055999469</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt; rain.wetqr .           </span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt; rain.dryqr .           </span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; rain.wetqr .           </span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; rain.dryqr .</span></span></code></pre></div>
<p>This time we are going with two rainfall variables again, but
different ones – total precipitation and seasonality. (This actually
provides similar information to what you would get from
<code>rain.wetqr</code> and <code>rain.dryqr</code>, which jointly tell
you about both total rainfall and variability/seasonality.)</p>
<p><em>Any issues with multi-collinearity amongst the precipitation
variables? Try to address any multi-collinearity by culling one or two
of the main culprits. Does this affect your previous model selection
results?</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: carData</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;car&#39;</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt;     recode</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:DAAG&#39;:</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt;     vif</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="fu">vif</span>(ft_tempRain)</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt;        temp        rain   rain.wetm   rain.drym   rain.seas  rain.wetqr  rain.dryqr rain.warmqr rain.coldqr </span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt;    1.773040  111.063634   85.433552  110.163673    5.524702  130.580531  144.565319    9.577784    6.436926</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="fu">cor</span>(XtempRain)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt;                 temp        rain rain.wetm  rain.drym   rain.seas rain.wetqr rain.dryqr rain.wetqr rain.dryqr</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; temp       1.0000000  0.47869648 0.5552163  0.1923458  0.37764956  0.5530709  0.1959310  0.5530709  0.1959310</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; rain       0.4786965  1.00000000 0.9170080  0.7540378 -0.03914991  0.9276384  0.7811679  0.9276384  0.7811679</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; rain.wetm  0.5552163  0.91700800 1.0000000  0.4730420  0.30626819  0.9935421  0.5030374  0.9935421  0.5030374</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; rain.drym  0.1923458  0.75403779 0.4730420  1.0000000 -0.53128346  0.4907095  0.9933645  0.4907095  0.9933645</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; rain.seas  0.3776496 -0.03914991 0.3062682 -0.5312835  1.00000000  0.2893864 -0.5243323  0.2893864 -0.5243323</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; rain.wetqr 0.5530709  0.92763843 0.9935421  0.4907095  0.28938641  1.0000000  0.5187558  1.0000000  0.5187558</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; rain.dryqr 0.1959310  0.78116788 0.5030374  0.9933645 -0.52433232  0.5187558  1.0000000  0.5187558  1.0000000</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; rain.wetqr 0.5530709  0.92763843 0.9935421  0.4907095  0.28938641  1.0000000  0.5187558  1.0000000  0.5187558</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; rain.dryqr 0.1959310  0.78116788 0.5030374  0.9933645 -0.52433232  0.5187558  1.0000000  0.5187558  1.0000000</span></span></code></pre></div>
<p>A bunch of high VIF’s, looking at correlations,
<code>rain.wetm</code> looks like one of the main culprits, it is quite
understandable that rainfall in the wettest month should be highly
correlated with total rainfall, and with rainfall in the wettest
quarter! Will also remove <code>rain.drym</code> because there is high
redundancy between this variable and <code>rain.dryqr</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>ft_tempLessRain <span class="ot">=</span> <span class="fu">lm</span>(logHt<span class="sc">~</span>temp<span class="sc">+</span>rain<span class="sc">+</span>rain.seas<span class="sc">+</span>rain.wetqr<span class="sc">+</span>rain.dryqr<span class="sc">+</span>rain.warmqr<span class="sc">+</span>rain.coldqr, <span class="at">data=</span>globalPlants)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>ft_Lstep <span class="ot">=</span> <span class="fu">step</span>(ft_temp, <span class="at">scope=</span><span class="fu">formula</span>(ft_tempLessRain), <span class="at">direction=</span><span class="st">&quot;forward&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=107.97</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS     AIC</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt; + rain.wetqr   1   26.7393 262.96  97.280</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; + rain         1   26.4615 263.24  97.418</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; + rain.coldqr  1   20.3413 269.36 100.429</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1   11.2099 278.49 104.796</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1    9.4721 280.22 105.611</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     289.70 107.966</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1    0.0632 289.63 109.938</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=97.28</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp + rain.wetqr</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS    AIC</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; + rain.coldqr  1    4.0676 258.89 97.238</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     262.96 97.280</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt; + rain         1    1.1733 261.78 98.694</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1    0.7535 262.20 98.904</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1    0.5071 262.45 99.027</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1    0.0841 262.87 99.238</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=97.24</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">#&gt; logHt ~ temp + rain.wetqr + rain.coldqr</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt;               Df Sum of Sq    RSS    AIC</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                     258.89 97.238</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">#&gt; + rain.seas    1  0.126684 258.76 99.174</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="co">#&gt; + rain.warmqr  1  0.016626 258.87 99.229</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a><span class="co">#&gt; + rain         1  0.011498 258.88 99.232</span></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a><span class="co">#&gt; + rain.dryqr   1  0.004059 258.88 99.236</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a>XlessRain<span class="ot">=</span><span class="fu">model.matrix</span>(ft_tempLessRain)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a>lasso_Lrain<span class="ot">=</span><span class="fu">cv.glmnet</span>(XlessRain,globalPlants<span class="sc">$</span>logHt,<span class="at">penalty.factor=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)))</span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a><span class="fu">plot</span>(lasso_Lrain)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk ex5.5lessrain" />
<div class="figcaption">plot of chunk ex5.5lessrain</div>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>ft_Llasso<span class="ot">=</span><span class="fu">glmnet</span>(XlessRain,globalPlants<span class="sc">$</span>logHt,<span class="at">lambda=</span>lasso_Lrain<span class="sc">$</span>lambda.min)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>ft_Llasso<span class="sc">$</span>beta</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co">#&gt; 7 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt;                       s0</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt; temp        4.188268e-02</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; rain        5.333291e-05</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; rain.seas   .           </span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; rain.wetqr  1.030699e-03</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; rain.dryqr  .           </span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; rain.warmqr .           </span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; rain.coldqr 6.719062e-04</span></span></code></pre></div>
<p>Forward selection is unchanged, not a big surprise because the
forward path stopped before any deleted variables were considered. This
time LASSO gave a similar model, also picking <code>rain.wetqr</code>
and <code>rain.coldqr</code>, it also added a small term for
<code>rain</code> too. Note that the precise solution you get depends on
randomness in the assignment of observations to validation groups, so
your run may come out a little differently to this.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
