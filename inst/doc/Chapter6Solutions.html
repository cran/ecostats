<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2024-07-04" />

<title>Chapter 6 – Mixed effect models – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 6 – Mixed effect models – Exercise
solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2024-07-04</h4>



<div id="exercise-6.1-effects-of-water-pollution-on-subtidal-marine-micro-invertebrates" class="section level2">
<h2>Exercise 6.1: Effects of water pollution on subtidal marine
micro-invertebrates</h2>
<p><em>What factors are there? Fixed or random?</em></p>
<p>He samples in seven estuaries along the New South Wales coast (three
of which are “Pristine”, four are “Modified”), and in each estuary, he
takes 4-7 samples and counts the creepy crawlies therein.</p>
<p><em>Modification</em> is a factor, taking levels “Pristine” and
“Modified”</p>
<p><em>Estuary</em> is a factor, taking seven levels. If these were
sampled randomly, and we want to make inferences across all estuaries on
the New South Wales coast, it oculd be treated as a random factor.</p>
<p>The 4-7 samples at each estuary are the replicates, so they shouldn’t
be added to the model, variation in replicates will enter through the
error term.</p>
</div>
<div id="code-for-fig-6.1" class="section level2">
<h2>code for Fig 6.1</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(estuaries)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">plot</span>(Total<span class="sc">~</span>Estuary,<span class="at">data=</span>estuaries,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Modified&quot;</span>,<span class="st">&quot;Pristine&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>),<span class="at">pch=</span><span class="dv">15</span>,<span class="at">pt.cex=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-6.1-fitting-a-linear-mixed-model-to-the-estuary-data-of-exercise-6.1" class="section level2">
<h2>Code Box 6.1: Fitting a linear mixed model to the estuary data of
Exercise 6.1</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(estuaries)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>ft_estu <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">summary</span>(ft_estu)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; Formula: Total ~ Mod + (1 | Estuary)</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;    Data: estuaries</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 314.4</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; -2.2393 -0.7569  0.1553  0.7372  1.8962 </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  Estuary  (Intercept)  10.68    3.268  </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  Residual             123.72   11.123  </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; Number of obs: 42, groups:  Estuary, 7</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; (Intercept)   39.053      3.237  12.065</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; ModPristine  -11.243      4.287  -2.622</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;             (Intr)</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; ModPristine -0.755</span></span></code></pre></div>
<p>There is some evidence of an effect of <code>Mod</code>, since the
estimated coefficient is more than double its standard error (so a 95%
confidence interval would not cover zero). The effect appears to be a
decrease in total abundance in pristine estuaries.</p>
</div>
<div id="code-box-6.2-residual-plots-from-a-mixed-model-for-exercise-6.1" class="section level2">
<h2>Code Box 6.2: Residual plots from a mixed model for Exercise
6.1</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ft_estu <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="fu">residuals</span>(ft_estu)<span class="sc">~</span><span class="fu">fitted</span>(ft_estu),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Fitted values&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="fu">residuals</span>(ft_estu)<span class="sc">~</span><span class="fu">predict</span>(ft_estu,<span class="at">re.form=</span><span class="cn">NA</span>),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Fitted values (no random effects)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC225C2/7a2///bkDrbkJDb////AAD/tmb/25D//7b//9v////59dV9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAXH0lEQVR4nO2dC3fiOpaFnSLpabjdYbqYKTftAP//X7blt8FY58iStm3tb93KZSXowZa2JR3JJnsQkjAZugKEIKEBSNLQACRpaACSNDQASRoagCQNDUCShgYgSUMDkKShAUjS0AAkaWgAkjQ0AEkaGoAkDQ1AkoYGIElDA5CkoQFI0rgbICNqPDYc9XdgSkb3BnBvu1TxawCfmaUBDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsEQ3wHTkNV0CGYAyC4ltgGxR/jskjAEosxS9Ae7negft1x9tyu4NbJoetRYS/SmzGLUB8uxYvyjaF9KU/RvYMj1aLUT6U2YxWgPcz53s+eGqSTl4A1umR6mFTH/KLEZrgNvpu31ZvA7CXAOoUYoh1J8yS4k8AjA88UyQEYAyi3FYAzSXIKc1AHlGvwag/j7RR4FupzoK8Xr9YQM4oJaM+nuFO8FguBOMxYcB5m+vIbN4kIz6L0BvgLzUuZqG5i5RIPKEWjLq7xX9IvjjdzkN/XywAfygXgRTf6+4hUHv53IJxgbwgVMYlPp7w3Uj7HK4sgF84LgRRv094bwRdvlkA/jAdSOM+vtBvwZoZL+dJs4jsgHUqNcA1N8rLlGgehC+n9kAHnCIAlF/j3AjDAw3wrDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALFs2wC5OPwYywC60icGGDbCP+17DGGAf2sRguwbYyZMPghhgJ9rEgAYAQwNgoQHA0ABYtmuAncxzuQbAsmED7CPSwSgQli0bYBdwHwALDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwBLdAIzPjWEYFEtsA3CH5gluhGGJbADu0T/DoxBYaAAwNAAWGgAMDYCFawAwXANgYRQIDKNAWLgPAIb7AFhoADA0ABYaAAwNgIUGAEMDYKEBwNAAWLZsgF1EOhgFwrJhA+wj1s19ACzbNcBOdju5E4yFBgBDA2ChAcDQAFi2a4CdzHO5BsCyYQPsI9LBKBCWVRjArbX2cZULNAJkdICMNRjArSfvZJ4bZg2QtT+IhRUYwLEn0wDvM9uJNjGgAcDQAFi2awCuAd5nximQmBUYwLkn72Kdx0UwljUYYB892RGGQbGswgApE8gARIjeAPdzNb5mv/5oU5IJ1JJRf6+oDZBnx/pF0b6QpiRTaCWj/n7RGuB+7mTPD9f3KTkHFaKUifp7RmuA2+m7fVm8DsI8jKVGqRL190yYEYAbMWKCjADUX4zDGqC5BM3NQdkAYvRrAOrvE30U6HaqoxCv1x82gANqkai/VwLtA3AOKiXQTrDvnHeLDwNkPcPfLapXMniQifovgDvBYLgTjIUGWMyyiy0NEJ/RUDn195m07RJsejM+xQZYON1W7wNQ/6WMWkw9AtzPU4dQJCn3ydKAizYl9V/KuMVcDsN9WvJOitgGoP5LWWqAR5F9v/tTgg3gYgDbHHQe6r+MrNJ/gQFm804P/RrAOgddVBdiY9kawJp1cmijQPYh2L0qPjPbKxwBwNAAWBavAax5k1loACw0ABquAbBwDYBmWRRoLmOfme2XJTvBlpydUyYLDYBldwaYOhoZvMQlqb3Vw3dm+2W3I8BTr49jg7hngSJmtlt2ugZ419cD2yD6UYhome2VXUaBrF08mAtogK2xPwOIu3YIC9AAW2NvBlD16gAW4Bpga+xmDVAd6dAW6d8Cq4wC8Z7gGXYSBXK99MboGvL+F8YAC4elnbMPA2RVV3YqMfjlUdH/ghhg6cJk3+xkClT3YtcSg3pA0/9ogNjsZBGcLW7kcBagAdZMHAMEnmWY3JfPc0PVEW4AfkfYDFEMEHgR1nyG5W0cqJeg1wA0wBwR1gCBh2CfGQfaH8ZGgTgFmiV8FChoA/justjNMRogOhsfAQLk6t1Sg5+y93otmAaYZeNrgEC5BuiH0EWw75x3xKajQKFDlz7zQhqARyHes+V9gJD5++wx6DUAmSPCGiAMMQ4w+MoKfBaIzLHRs0DhWxfRf2gALJsxQJQ5LWDiTANg2YoBYjVtdAvQAFi2YYCY3TKyBWgALFYD3E7HRz79rbSy3JYT+6octTxbWSvQf9dYDXA5XH++Ph+X919LYsnt+S3a7oUIaC8u018UyFF/7gPMoIkC3U7f1VeSFDPfTDWd8v07NE2Dasdl5frbB3DUnzvBM6j2AUwDXErxcz8G0B5SATbiAgt43Al2059ngWZQ7gRfPm+nw/V28jMF0rUMeBh3Lt7nUQgn/WmAGZQGuJ2yj99z30z4NqW98KW5BcfRAj4N4KQ/DTBDnLNAb5/UKc5/Has4t1r4WwPoy61f8I6w96jWAPqsX8sYv0XYMKtpPqeOhD4LRAPMsYU7wtbUekG7UhADcAokZtYA5fyzI2oUYm1Xr+CPV58Gpn9CrHIEWGHLBbMARwAs0dcAgkzW2XABn6DiPzNuhEmRhEH1Q7BmFficxXrbLci6UhAGjap/atg3wg7X/PPx8/XtmpuuOitvNv/9yroRFlX/9LAZwBxGLA7XRy46juh81c8WpY+KZw9YMnPVnyOAELsBvh8///On+ueWmyxV9W8rbeazd1kN4KQ/1wBSbAa4n4+P21+/QxqgDVlsqsG8ecCSjZv+jAKJsa4BzDHEyzHkFKhprc01l/tmq20ncoiT/jTALLqd4MuniUSIghALDLC9/l/h9CXE1rMoI1z0pwHmsOrvYR9AmWrjS7Z+v1byMca9k/sAsbHrH9sAW+//QzK7GWIYYFSPZfis3yrQGaA7jtKNwffz+50ZtynQ/jSuedOXVAaIoL8Ff1ZaSUM7jQD9Lal5dmx+1b6YT2mtzjpUicKgJ8jXABXh9I/KOrzktAZon0pgwnINE4EJdbVS6v49mSIK1BBI/+3iyz9SA7SXILMx8/SrQV3+Q9TI2pv6h0JogPapBD6vQAldr4Y4LYJD6J8oTmuA/qkEedZcghbPQVNtLRcDhNA/VdyiQP3V5vU30ylt1Ui2sZyiQN71T5d17AOk3FS6nWBtzsTGCnaC0738VzhEgYQZ+8xsv4ijQM43ZdvKF70tDea0CKQ/GWAdAeq1VvHx2zW3l/ewlYbY1PCuPxlhM0D7UD5vx6E9ttGy/cCgyKtmeZ+r/ivWBo9mI6zdePH0eHTQd5HGRlE1axTISf8Va4NHtQhuN14uXkYAn20yjmatCk3VrCOAi/4r1gaPMgxaVBsvuY85aIi7yVfZyB4N4Kb/irXBo90HqEIRsq+ompfcc3usuJF9GsBJ/xVrgwe0EeZ/Ubbiea6/NYC+XG0F0gOyERaiNVYc6fAWBVIW61CBBHE5Di3M+W2J4gqlBg2AxbITfHy9JU+bm332k/R4Pb8T7Kp/0pKqCD8CWC9Faa/YgowAaUuqIrQBBCNx2q1FA2CxGsA8nTWXxuFe5qCSNki7tWyf20n/+klLqUqqwmqAy+H68/XZ3ZQtzK2egyq+Dy/ZxrJ98CX6Ezs2A5izKGYzUncWRXlRTzlkYfnkrvpzBBAiMcClFD9XGyDlXq1AYAA3/TkEiLBPgT5vp8O1vylblFvW/kdsWKdAjvoLsiYP0SI4+/jdnkoX58Y5qBT7Ipj6hyRUGJQTICHcCcYS7TAcmSaQAYgQuwHKMfhwvbw+hEmaG5nFKhn1D4rVAMXH79wswkQtwAZQY5OM+ofFZgBzS565IVsXhiNiLJJR/8BI9gFMA3i6KZ48I9gHoP4BkY4A2pviGYUQIhwBqH8ghGuA7pnEwtwYh5YiWwNQ/1CIokBZJnsoAXci9UiiQNQ/HGH2AdgAYng/ABaxAf7Nw1hBkIpE/cNgMUDe3Ix6P/Oe1DDMq0T9QzNvAPNQYhN/KLKJ7+OZTckohJBZmah/cGYNUB1CvJ2+c+0ijIiZk4z6h2fWANUG/P3890x2GFfUAGlcmvw8GGuB/mnI7IjiG2JM9PkiG37f5fb6jv03jeJTzhvAVf80ZHZkJI7EAMIns77JbeINe28azacUGECvfxoyOzIWR2IA6QBMAzR4NoBe/zRkdoQGCA4NsGagBkhkcup3DeCgfxoyO6JZA/j/ms40whO+okDO+qchsyPxH49O3hLkLBARQwOAoQGw0ABgaAAsNAAYGgALDQCGBsCiN8D9/D4swQZQo5aM+ntFbYC8PZlSTBxRcWyAlGN22k8u1D9lSVVoDWCeUtCQv55RcRM96V0b5QcX6p+0pCq0Bqg3JysmHlXjpHna+/bKzy3TP21JVaxgBEivtWw7kTPI9E9PUhWLdoK7J9R4WwMk11rWsyhziPRPTlIV8rNAk7QHVKZOqSe5BtCuN+2nEWcR6b9xSYMy/gK1VewDbDpkoe5rCw1gz7p6tWVJw1Ipk63KAFtGP9uIYgDyFrv+NIACh+n2ojWAoDJkFv8jQH9oPcEGcFlvLogCvckuXf31LFsDzN+jkWIDLFxvqvcBqP9SlkWBZh/Sl2QDLLvwatNS/+UsuyNs7jtrU2yAyRHAzy2Rk1D/pYwmiw5rgOL9lzUk2ACTawDFtEgvGfVfBsOgXpkygGZhzChQbBgG9QoNsDW8GGBwJkuZcndMTHfCG4D6u+NlCsQG6JlY8AZdAxio/wKWLoINbIB5AkaBKqj/Ejw8GIsN4AsaAAsNAIYGwMIoEBhGgbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALDQAGBoACw0AhgbAQgOAoQGw0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALDQAGBoACw0AhgbAQgOAoQGw0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACyhDMBvLBQSyADUX0ggA2SLskmJMAag/lLCGCBbmE9CBDEA9RdDA4ChAbDQAGBoACxcA4DhGgALo0BgGAXCwhEADEcALNHXALw0jQm0BjAyU2gBsQ3AS9MTYQyQtT+IhcgGYHjiGUaBsEReA7BlnuEIgCVyFIgGeIZrACyxT4NyDfAEo0BY9Aa4n7OKX3+0Keu3+BuZdxFQUn8Emf670CYGagPkWfMd5UX2+mXlUUXfx1VO+wlk+u9DmxhoDXA/d7Lnh6smpW92spxQfgCZ/jvRJgZaA9xO3+3L4nUQpgHUKD+ATP+daBMDjgBgOAJgcVgDNJcgrgG8oF8DSPTfhzYx0EeBbqc6CvF6/Ymt+S4iHeqPINN/F9rEIPY+AHkizD4AkUIDgKEBsOgNkJejazUNzbFRoJ2gloz6e0W/CP74XU5DPx+DBsh6/Fdw76gXwdTfK25h0Pu5XILxCuQDpzAo9feG60bY5XBlA/jAcSOM+nvCeSPs8skG8IHrRhj194N+DdDIfjtNnEdkA6hRrwGov1dcokD1IHw/swE84BAFov4e4T4AGO4DYHE0wOBMljIlGeMmGfX3BQ0AhgbAQgOAoQGw0ABgaAAsNAAYGgALo0BgGAXCQgOAoQGw0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALDQAGBoACw0AhgbAQgOAoQGw0ABgaAAsNAAYGgBLdAPwAZZjAhmAMguJbYBsUf47JIwBKLOUyAbIFhawP4IYgDKLoQHA0ABYaAAwNAAWrgHAcA2AhVEgMIwCYeE+ABjuA2ChAcDQAFhoADA0ABYaAAwNgIUGAEMDYKEBwNAAWGgAMDQAFs8GIGrc2476+2BKRp9t4pPQFdt6/j4K1CeJUkicei1OGZitd1AaIGYSGiC5/H0USAPQAJvN30eBNAANsNn8fRRIA9AAm83fR4E0AA2w2fx9FEgD0ACbzd9HgTQADbDZ/H0USAOs2ACExIAGIElDA5CkoQFI0tAAJGloAJI0NABJGhqAJA0NQJJmfQbIs+zjt3lRtC/C5H87mZvkPv0X8HhcDtdHsPo/cz+XH+NoXpWfLPsWpdFr3KboS5MX8mgVkSf5+RI2TZdC/uHHrM4A+a8/j8J8JvOj8N+Duvx//haqdxaZae5A9X/mfi7LyE1vyU2Bok6g17hN0ZcmL+TRKqKoV/n220lQSpdC/uGfWJsBbqejadTP8p+5zlx8X6G7/B9FqV0QyqGlbL9A9X/h58u0etkRqg8lKlCvcZeiK02e5NEqoq2XoJRBCumHf2ZtBqjQSe2W/yMP1Tfzw/+WzR2y/q+UV0FlH9Br3PTmujR5IY9WEUW9VIPzDg1gxrNahDCXaZP/4/J38WxWRVlxM+MNWf9XLmU5ulmAXuO8n9FLP1WdpFFEnqT49f8nedvku5oCPaqF2bG9yoSYRNf5306mTS7eHWCGb9Pc4eo/QVH1FsWqW69x0ffIQtg3myStIvIkeVY6rB9wRPVyDTms0ABGssM1ZAcy+dev/F+h8zLr2AYoqlWpuS7/fEkdrde4Va2Qh86qJK0i8iT1wCFtm6oQ3YcfsEoDmDYJOoXo2ryeBXukqnbkKVB9RdYuOvQaN37RzBvbQuQGMEnqDyFuG1OI84prnQYoP0/QRWSnrfdYaN48hC9s/Z+KrOcAyiFHr3H19ly1biqTdIrIk9SWFLeNSeE83q7NAHWbFCaqFySM2OXfvfBcgOESMQxa9si6a8k/kF7jPu9c2pHH1RGNAF2S20n4UTy05toM0HeeQBtJXf5Vu/tfBLdlxNoI6ye+8mmwXuM2hWKa3V8FHtIpUJckH6YVpdjRGuDSDpd5mKMEXf4Xx81zQRFVcweq/xPNDKMK7IrjunqNmxSD0uSFPMRrgC5JIf0oo9Z0uZqtzwCERIQGIElDA5CkoQFI0tAAJGloAJI0NABJms0Y4NLuqFfbhEXzb8ybPZ16YzFdgkp3P+vFFe4P5ll2zKei+4Pq3/5auNWyHQMMt1JMu0y0DQ0wSVDpXO4rkhnA3O5V3fI1W6lCfsxuEhpg/4SUzklbqQEma/pUpssINGR7Big/vnlmgMEcNh88EuHjX/UNSPXBqPJ1s09epqg0q360Cao80jBGSOnM+bPb6Z+n+heDEwy3v/5lbmvp8mnf0hXWvPfny/zlaPJsW6Mup61pdQJv8NyLT/OHw7WrRL5sCNikAfqLQ3Vj31dzGKpon9zxWb//0jwqYdiKbYKqqZ3uodseIaUzb7ydzKMimnsS24c5NHfcdfk0b+kKa9/781U9Z8J08+YsZ1vOa03rnI7ml30lFh443LYB6ilidxz20jwiproqHav1kfnDoBW7BLFu1l0DAaWrfln9KN9dn99sOmT9lz6f4+AOhIu5hb95b9Wzmx/fXcL2UPSopu2CwPyyr8TCe5q2Y4D2tophKxbtwF3r0Wnf/sWMs6NW7BLcTuk4IKB0/fyoml59Pwb9uJ0ktSVXmbSFde+tXvQ/Ho9BOU81bbt6/Ye2EpPrZDnbMcDUZaxoA3z5sBXNwHupJ7m//m98GesS1I84S2IGFFK6qk+ODdD0/Pp/g3yqX+VjA7SJRgYYBm1HNW1vEasy6yqRtgHa+d/oMlY9VuO7V/XlMtblGeeZDWgCSmcZAYb56EaAQW1fbuDuBpeqEkkboJOiubv1o71E/MOstYzYRTuOH7thtSeR+GhA6Zo1QN27n9YA349RPgOP5KM1wJMBunJeajpcA/QvklkDjFux2SOpH3HVBSHaa8XFPLmjvvJkx7ptDtdy0PzuEnSPxkyAkNLVUaBmGBhHgb7H+fShpKco0JMBunJGUaCupvfzp6l+X4kko0BlMx2ulzaYXQ2rfTD70Qbpqvv9OiWz7J9tMLu+LsV5ePMKCCldvQ/QzoOG+wCn53ya3vyyD/BsgLac/uo/rKnxp6l+V4lU9gHIKoHPIpdWgAYgiwj2jGEhyZwFIutk6VmchaRzGpSQENAAJGloAJI0NABJGhqAJM1/ARX9LkC8kW1eAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="code-box-6.3-using-anova-to-compare-mixed-effects-models-for-the-estuary-data" class="section level2">
<h2>Code Box 6.3: Using <code>anova</code> to compare mixed effects
models for the estuary data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ft_estu <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries,<span class="at">REML=</span>F)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ft_estuInt <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries,<span class="at">REML=</span>F)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">anova</span>(ft_estuInt,ft_estu)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Data: estuaries</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; ft_estuInt: Total ~ (1 | Estuary)</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; ft_estu: Total ~ Mod + (1 | Estuary)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; ft_estuInt    3 334.18 339.39 -164.09   328.18                       </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; ft_estu       4 330.14 337.09 -161.07   322.14 6.0396  1    0.01399 *</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>There is some evidence of an effect of modification.</p>
</div>
<div id="code-box-6.4-confidence-intervals-for-parameters-from-a-mixed-effects-model-for-the-estuary-data" class="section level2">
<h2>Code Box 6.4: Confidence intervals for parameters from a mixed
effects model for the estuary data</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">confint</span>(ft_estu)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; Computing profile confidence intervals ...</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;                  2.5 %    97.5 %</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; .sig01        0.000000  7.613337</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; .sigma        8.944066 14.084450</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; (Intercept)  32.815440 45.246159</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; ModPristine -19.461059 -2.994392</span></span></code></pre></div>
</div>
<div id="code-box-6.5-prediction-intervals-for-random-effects-terms-in-a-mixed-effects-model" class="section level2">
<h2>Code Box 6.5: Prediction intervals for random effects terms in a
mixed effects model</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>rft<span class="ot">=</span><span class="fu">ranef</span>(ft_estu,<span class="at">condVar=</span>T)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">dotplot</span>(rft)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; $Estuary</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-6.2-fitting-random-effects-with-different-variances" class="section level2">
<h2>Exercise 6.2: Fitting random effects with different variances</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>estuaries<span class="sc">$</span>isMod <span class="ot">=</span> <span class="fu">as.numeric</span>(estuaries<span class="sc">$</span>Mod<span class="sc">==</span><span class="st">&quot;Modified&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>estuaries<span class="sc">$</span>isPri <span class="ot">=</span> <span class="fu">as.numeric</span>(estuaries<span class="sc">$</span>Mod<span class="sc">!=</span><span class="st">&quot;Modified&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>ft_estuDiff <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">0</span><span class="sc">+</span>isMod<span class="sc">|</span>Estuary)<span class="sc">+</span>(<span class="dv">0</span><span class="sc">+</span>isPri<span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries,<span class="at">REML=</span>F)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">summary</span>(ft_estuDiff)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; Formula: Total ~ Mod + (0 + isMod | Estuary) + (0 + isPri | Estuary)</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;    Data: estuaries</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;    331.7    340.4   -160.8    321.7       37 </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; -2.2790 -0.7211  0.2024  0.6807  1.9407 </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;  Groups    Name  Variance Std.Dev.</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt;  Estuary   isMod   0.00    0.000  </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt;  Estuary.1 isPri  11.39    3.375  </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;  Residual        118.84   10.901  </span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; Number of obs: 42, groups:  Estuary, 7</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; (Intercept)   39.111      2.569   15.22</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; ModPristine  -11.303      3.806   -2.97</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt;             (Intr)</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; ModPristine -0.675</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="fu">BIC</span>(ft_estu,ft_estuDiff)</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt;             df      BIC</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt; ft_estu      4 337.0880</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; ft_estuDiff  5 340.3501</span></span></code></pre></div>
<p>BIC suggests that we didn’t need a different variance term for each
level of <code>Mod</code>. (It also estimated the cross-estuary variance
to be zero for modified estuaries, leading to a warning in the
output.)</p>
</div>
<div id="exercise-6.3-bird-exclusion-and-biological-control" class="section level2">
<h2>Exercise 6.3: Bird exclusion and biological control</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">data</span>(aphidsBACI)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">str</span>(aphidsBACI)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    16 obs. of  5 variables:</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;  $ Plot     : Factor w/ 8 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 1 2 ...</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;  $ Treatment: Factor w/ 2 levels &quot;excluded&quot;,&quot;present&quot;: 2 2 2 2 1 1 1 1 2 2 ...</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;  $ Time     : Factor w/ 2 levels &quot;X18.06.&quot;,&quot;X15.07.&quot;: 1 1 1 1 1 1 1 1 2 2 ...</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;  $ counts   : int  78 71 122 271 119 152 120 202 60 48 ...</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;  $ logcount : num  4.37 4.28 4.81 5.61 4.79 ...</span></span></code></pre></div>
<p>OK so we are looking for a <code>Treatment:Time</code> interaction,
but to account for repeated measures of each plot, we want a random
effect for <code>Plot</code> in the model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ft_aphids<span class="ot">=</span><span class="fu">lmer</span>(logcount<span class="sc">~</span>Treatment<span class="sc">*</span>Time<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Plot),<span class="at">data=</span>aphidsBACI)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>ft_aphidNull<span class="ot">=</span><span class="fu">lmer</span>(logcount<span class="sc">~</span>Time<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Plot),<span class="at">data=</span>aphidsBACI)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">anova</span>(ft_aphidNull,ft_aphids)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; refitting model(s) with ML (instead of REML)</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Data: aphidsBACI</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; ft_aphidNull: logcount ~ Time + (1 | Plot)</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; ft_aphids: logcount ~ Treatment * Time + (1 | Plot)</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;              npar    AIC    BIC   logLik deviance  Chisq Df Pr(&gt;Chisq)  </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; ft_aphidNull    4 28.204 31.294 -10.1020   20.204                       </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; ft_aphids       6 26.974 31.609  -7.4868   14.973 5.2304  2    0.07315 .</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Which gives us marginal evidence of an effect of bird exclusion of
aphid counts.</p>
<p>Compare this to what we got when adding <code>Plot</code> as a fixed
effect:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>lm_aphids<span class="ot">=</span><span class="fu">lm</span>(logcount<span class="sc">~</span>Plot<span class="sc">+</span>Treatment<span class="sc">*</span>Time,<span class="at">data=</span>aphidsBACI)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">anova</span>(lm_aphids)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; Response: logcount</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;                Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; Plot            7 0.8986  0.1284  0.4603 0.833357   </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; Time            1 5.4675  5.4675 19.6038 0.004434 **</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; Treatment:Time  1 0.7397  0.7397  2.6522 0.154527   </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Residuals       6 1.6734  0.2789                    </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Interestingly, this <span class="math inline">\(P\)</span>-value is a
lot smaller.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(lm_aphids)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = logcount ~ Plot + Treatment * Time, data = aphidsBACI)</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; -0.5527 -0.1929  0.0000  0.1929  0.5527 </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;                              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)                    4.6097     0.4175  11.041 3.28e-05 ***</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Plot2                         -0.1559     0.5281  -0.295  0.77776    </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Plot3                          0.3378     0.5281   0.640  0.54600    </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; Plot4                          0.4433     0.5281   0.839  0.43336    </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Plot5                          0.2127     0.5904   0.360  0.73105    </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; Plot6                          0.3530     0.5904   0.598  0.57179    </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; Plot7                          0.6593     0.5904   1.117  0.30685    </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; Plot8                          0.2631     0.5904   0.446  0.67154    </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; Treatmentpresent                   NA         NA      NA       NA    </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; TimeX15.07.                   -1.5992     0.3734  -4.282  0.00519 ** </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; Treatmentpresent:TimeX15.07.   0.8601     0.5281   1.629  0.15453    </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.5281 on 6 degrees of freedom</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8094, Adjusted R-squared:  0.5235 </span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; F-statistic: 2.831 on 9 and 6 DF,  p-value: 0.1091</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="fu">summary</span>(ft_aphids)</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; Formula: logcount ~ Treatment * Time + (1 | Plot)</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;    Data: aphidsBACI</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 20.2</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; -1.2314 -0.4755 -0.2367  0.3187  1.8824 </span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt;  Plot     (Intercept) 0.000    0.0000  </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt;  Residual             0.199    0.4461  </span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; Number of obs: 16, groups:  Plot, 8</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt;                              Estimate Std. Error t value</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; (Intercept)                    4.9817     0.2231  22.334</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; Treatmentpresent              -0.2157     0.3155  -0.684</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; TimeX15.07.                   -1.5992     0.3155  -5.069</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt; Treatmentpresent:TimeX15.07.   0.8601     0.4461   1.928</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt;             (Intr) Trtmnt TX15.0</span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="co">#&gt; Trtmntprsnt -0.707              </span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="co">#&gt; TimeX15.07. -0.707  0.500       </span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="co">#&gt; Tr:TX15.07.  0.500 -0.707 -0.707</span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span></code></pre></div>
<p>We get the same point estimate for the <code>Treatment:Time</code>
effect, but the standard error is slightly smaller in the random effects
model.</p>
</div>
<div id="exercise-6.4-estuary-data-in-different-zones" class="section level2">
<h2>Exercise 6.4: Estuary data in different zones</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">data</span>(estuaryZone)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>cols<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;pink&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">plot</span>(Total<span class="sc">~</span><span class="fu">interaction</span>(Estuary,Zone),<span class="at">data=</span>estuaryZone,<span class="at">col=</span>cols[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>)])</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Mod-Inner&quot;</span>,<span class="st">&quot;Prist-Inner&quot;</span>,<span class="st">&quot;Mod-Outer&quot;</span>,<span class="st">&quot;Pris-Outer&quot;</span>),<span class="at">col=</span>cols,<span class="at">pch=</span><span class="dv">15</span>,<span class="at">pt.cex=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It looks like there is an effect of Modification, not sure if there
is an interaction (the effect seems more striking in Outer than Inner
zones)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="dv">0</span>))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>lme_MZ <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone<span class="sc">*</span>Mod <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone )</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="fu">residuals</span>(lme_MZ)<span class="sc">~</span><span class="fu">fitted</span>(lme_MZ),</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Fitted values&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="fu">residuals</span>(lme_MZ)<span class="sc">~</span><span class="fu">predict</span>(lme_MZ,<span class="at">re.form=</span><span class="cn">NA</span>),</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Fitted values (no random effects)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC225C2/7a2///bkDrbkJDb////AAD/tmb/25D//7b//9v////59dV9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAY1klEQVR4nO2dC3fjupGEOWNPNtZNrI21O4yjkfT//2XENymRYjfQYIFAfefciWILDxZYBLoJ0sWNkIwp0B0gBAkNQLKGBiBZQwOQrKEBSNbQACRraACSNTQAyRoagGQNDUCyhgYgWUMDkKyhAUjW0AAka2gAkjU0AMkaGoBkDQ1AssbdAAVRYzhw1N+BORndB8B97HLF1gCWleUBDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsGxugPnMa74EMgBlFrK1AQqv+hMkjAEos5SNDVB4NpAeQQxAmcXQAGBoACw0ABgaAIveANdjs4no529tye4bHJgRajFE+lNmKWoDlMVH8+HcfZCWbL/C9MQErRpC/SmzEK0Brsde9vLtW1OSzKKUjPobozXA5fDZfTw/T8IcADVKyai/MZwBwHAGwOIQA7SXIMcYgEzRxwDU3xJ9FuhyaLIQz9cfDoADasmovynxbIbLNG8B3gyXqeoDFgZ4/YSxoiM5joXBMXvon6vqA3oDlHed62VoaZmFyPbepfqQLfXPVvUBfRD84+u+DH2/0QA2qINgS/2zVX3ALQ16Pd5DMBrAAqc0qJX+2ao+4Hoj7PT2bWqAbFejjjfCjPTPVfUB5xthp3dbA+Saj3C9EWakf6aqD+hjgFb2y2FmP2LmYrqgjgGovykuWaBmEr4eOQAGOGSBqL8h8dwIyxTwjbDsoQHA0ABYaAAwNAAWGgAMDYCFBgBDA2ChAcDQAFj2bYAEbuNwOzSWXRsghRv5WAOkoKAfezZAElu5oAZIQkE/aAAwNAAWGgAMDYAlWgMsRGeTH6ewgg1kAGFw6/kcawLEaoCFc/vhxwmMXhgDSC8NNECkBliYmxOcsoMYQKpTgnpqoQHA0ABYaAAwNACWzQ0gjc7ma0sh7J0SKAYQru3T01PL1gYQKy7JAqUA1gDp6allYwMYz7kJDB90CZSEgn7s2gApTOBYA6SgoB97NkASIRyDYCzRxgDi1nY+fNAbYUko6EesWSB5azsfvjAGEMqchIJ+RHofQN7c3kcvkAEUBfauoB+7NkAKOQysAVJQ0I99GyABwAbIHhoADA2AhQYAQwNgoQHA0ABYaAAwNAAWGgAMDYCFBgBDA2ChAcDQAFhoADA0ABYaAAwNgIUGAEMDYNmbAZLbuwLdDUr2ZoD0di9CnwcgOzNAgvvXoU+EERoADQ2AhQYAQwNgCWWAQEFYemvbQDFA9i+9lRLIAMFO1OTGlQbAEsYAwaZgzgCiyuqTnw6QsC8DJLi2ZQyAhQYAQwNg0RvgeqwXmMXP3y9KBlqqJDiw6oOR6M8lkBi1Acrio/lw7j7MlvSMwZaKMwaQ6c8gWIrWANdjL3v59q0pqWH5PE9uXJWHI9SfBpCiNcDl8Nl9PD9PwkaaJ7jSWUR5lDL9cxLQkyhngJzGL8gMkJOAnjjEAO0l6HUM4EVO46ePAQT65ySgJ/os0OXQZCGerz9bxADJoT5Mkf4ZCehJpJvh8gnhwmyFyEhATywMUAxYdCkvDCSj/h5EOgNI2/MZ8jjOl0AzgLgEWAR0+/s2gNdKN5JlMtYAaBHQ7bvcBxjm22D3AYR45TpiSZSo7wNY6o8WAd3+QuMvO3Q9zm1CkZQ0J0cD2OqPFgHd/kLja5vh3lW1hSO0ATZZnzpshrPTH30CFrXGOzPA7Vx8Lv0q+KFMz8mwMcA261N9C5b6o1NH+4sB9LVZ8qhXyCzQRldHcBCMNcA+ZwBlbYZsOmPnYAD8Egjb/kLjNMCGjdEANICy+q30ijUGMKwMfgIyBtDXv51ecWaBTCuDn4C8E6xsAK2XOVgDJCiokp0ZwJI4xh5sADTwQcjXAPDZvyFvA+AHIVsDwOO/lqwNEMEg0ABgaAAaAEIE2tv3AH84OiIYhFAGgAc3q+CXnzWBDBC//jX4QQhkAPyBrRPHORLGAHvQvwY+CGEMEMHUtheCGID6i6EBwNAAWGiAAch0nLkBEl0C7WcNOgLT57xjAHw/48kCoa8FoKsmOAuEfyAs0TSoU1FB8XADlqUBwFdgGuCh5Gr5gAOWlAGklxP7LqhAt7/QeLwGCCpYQjGAVCf4CZhuDOBWEmqADLNAcAPAI79oDCC7FnAGkFUm1gl9BUa3H5EBZNcCxgCyysQ6MQsk/Jl7bYqizAKZVcYskKoL6z9zr01TclR+80tTWgaQfh/7Yioa4KFkMfn/AAckEgOIv190/4BgDDAtWSz8320IMumsVQqeAcy7oO0BJPNWTK+0T78f/5/L4eNWzv9JtpWSyk7dHicA9LXBhNVL3NoxBtUfPgNAmIzJqgFOb99/fr3fTsvv5J4tuehs2S9SMcD6cawdo7X+D9+Hv5x2e6ZjsmaA6i+TV+/jnvmz5K9KLl74pIs+/OLQBG8DWOs/UyABmVXoDXC6i1+qBmBx3OVXdvgtQhNMDGCo/3OJJGRWoTPAfe69HN6+LwfVFGxggETwjgFs9Sc3bQxwORQ/vl79WZ65kvs0QJRZIFv9oyP+LJCu5vEHrxgAQJCuec8A6tZkzUYCpJ+6GUBddftJnQVCE+Sq6Z8Fcmiu/hSrzBMgM5UyBnCoe5+kZYB9ELsBXv9V5lcld8iGBlhbg3Ykrz/IAOObH5wBejaLAVbXoF6t7Yp0Y4A9slEWaH0Kdm/MsrJNAMQqyhmgm4aTnIIh6AxA/a3R3gh7+y7fb39+Lf518sWSZB6dAai/NToDVJsRz2/ft1K0HZEDIEETA1B/e1QxQLUX5c///K7/k1VNVpFmgW7UPwiaO8HX48ft8tdXNAPQZQWDN2RP32vNDBCb/ikwOYFWY4BqG+LpI44peNzv3XmgP+11MUBM+qfB9Cmg9TTo6b3KRIiSEAEHYOayX8gI1iUdw2mvTIPGoX9C7G8rhN9pHIkZnA2gb4S8ZGcGMD1tdS6wbXr4l3eCBxA3wlRLoH47CuRGTKh7s6Ipwfg2/ag6VRYo5b1AoK0QqiC4QfZIqvHlbIOLwwszTGdKm7aGmpUzgF7/GJZ9q5hrLGvVwQDqtxL4ApkatwmlnWIAd/0jiYFmgRjALQYYLkHX4/KcbHUoMQzVg06u7libWoRHaqN/SF+7ADJA4bAdun8rQVl8NB/O3YeVkvoOwselQb4+femOpzPNyQCB9A861UnavyFWQLeb5j5ATf9WgurOZMvMvRn/Y4nl7K8w6Et/sj+eZsoYYDP9pXdXdo4+C9SJXe1Naeln5aHe/xA1r89H6h+aFQM8Eu4KVDzkBpesudUMYbI+na/k8VAVCPWXCgVJQ06b30kM0FMW7SXINAYoXqyS138eBJvG5s4whzTogEh/ad8xaUh0+6v69z+bfSj7cVKeLanr0NMun4XKdmgAryyQs/40wMtGVTNAc6E5//iS1a3vzkykGYUBgi0PdFkgJ/33YgBMFmj077oBupfyhdmOO3f2d/WgY4BgGSmVARz130kMAMn66QzQZR2Ur+cWdeTFsS86I6IsqTOaGMBVf6lQSQiqRB4D3Iasw8l6BshQ+B5FFiiY/jmzpv9DDFBdgkrLGKC5FUFq1mMAc/3JiPU0aJ11kP2JKknYFfG5D+naapO2+scG/HRQ3wdQ1zb+NfpoX4IJCE1bjFneWeBBeDADzKS/oz77YSnBQAaIXe0GeBo2mAEenW02HuEGNikD7CTMit0Al8OH2yN5D6lWu7F4MJblKEdoAHf9i+6f1RKRvCkA3IX1n+lqGx2YqcIPgtmuIBOKAcQnFnoNjm4/tAGsry9zN/EMHRBlFsilMqky+CswfKW2aoDq7aylNA83vTbbH1tYA0BY676T/tIlUBIK+rFqgNPb959f7+qHsgPuo5m4bPfDt9Z9N/2FQXASCvqxZoBqL0p1MzLAXiAnJuOKX0H6s9J/V/2FF6AUFPRDYoDTXfwyEgM8tIdeQfojMEBI/RNQ0I/1JdD75fD23T+Ura+NvGR1CUT9gyIIgosfX92udJfayEvWg2DqH5JAd4KJlDB3gokUGgAMDYBl3QD3Ofjt+/T8BoLXtXkGV/nEZqvHCdE/H1YNcP7xVVZBmGgErDYpZJSdWztMiP4ZsWaA6pG86oFsXRrO8wZLTvdnVo4Son9OSO4DVAOguxFDA4gR3AfYXP+ckM4AuoeyaQAxwhlgU/1zQhgD9C/kE9bGGECKLAbYWP+MEGWBikL2UgJmgfRIskDb658PvA8AhvcBsIgN8O8YN8MlgFQy6h+GFQOU7cOo12OUu0ET4LVk1D80rw1QvZS4yj+ci5mX0QtrIy95KRn1D85LA9SbEC+Hz1IfhBEhrySj/uF5aYD6Bvz1+PdCthlXNABMT0x5pYaH/pRZyIoBquzzSTb9LtX2/A0OzYjXBnDVnzJLkRhA+GbWhdpmvsChGRAYQK8/ZRYjMYB0AqYBHBAYQK8/ZRZDAwxE92KsDAwAj1U2NkDMi1NM14IYIGaZJ+D7uWKAmT/Tqa3t8Stoyy8Bumq+NoCz/tHKPCGCmYp7gToiNAC2sg2gASKCBtgeGiAm4osBsJVtQeQxgElt+yG6LBC2sk2Axyo0AJjMDQCHBgBDA2CJxwDwyRAD2ACZqj4QjQGcwqGdDt+421gD7OSvSRqzpv9rRa7H5TszvtZRlsfnEJyYdFvdf0v95X9NMiVW9X8pSNltzj3P7NLd1gARZJFdmHZb231T/XeqoB/r+r8SpHpRU0v5vE2XBhDgZQBb/XeqoB9+Bmj2Z9XMvK1v2xhgp8PnZQBb/bNcAsU5AzgFtIFjgFDxoU8MYKw/PAhGNO8bA7SXINsY4Lkq0Z/59JFvrXA4e/lkgYz1x5//CAd4ZYG6PbpzD+rZHUv4BM9aC+YLrPmhVjdgqj84jwZagvkZ4GXNziVnKwqpzGoL1l1YONeg9wHQURSmfb8l0GrVJqRngKXqaICt2/cLgiV1GxCBAYyXBzTAXPuIJZC9AYbn9uwMUFWFjQGMA8SABpjTX9h3cAwACYL9DPD6MVWrYym2SE9sLL1NDCDUX3xio7cC7S8N+vI9xUYHs8nMvPnFzyYLJNIfvbQRg5mBfDfDLb+mY0cGiOUcUfdAon8sB7dGBP10uCidl/9e1b4NsJNHIgX6R3BiiShqzfdmAGVtrvVssAKaNgKajoNUhg5uhUSwFylOA2xxMX48R0BXzUBpUHRwK2O/BhjtyVKWjIeHc2RXBkhB/9uel0CJDMAYGmB7IohVaICePcUAqeiPj1VogIGdZIEqktEfHqvQAGAyNwCcSLNA+RAoC0SE0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALDQAGBoACw0AhgbAQgOAoQGw0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACw0ABgaAEsoA8Afdt4LgQxA/YUEMgD+dRd7IYwBqL+UMAYoPOvJiCAGoP5iaAAwNAAWGgAMDYCFMQAYxgBYmAUCwywQFs4AYDgDYGEMAIYxABYaAAwNgIUGAEMDYGEMAIYxAJbNs0BMT0xhFgjL1rtBeWl6gDMAlo0NwMXpI4wBsNAAYGgALDQAGBoAC2MAMIwBsGxtAKYnHmAWCMvmBiBTAhmACInWALlcwsAGyEXmRfQGuB6Lmp+/tSU1ZLOIVR+kqf7ZyLyI2gBl0f6N8nPx/MfKzbTMJ42hPUZT/fOReRGtAa7HXvby7VtTUkU+I6M8Rlv985F5Ea0BLofP7uP5eRKmAdQoj9FW/3xkXiTSGSCfxSl0BshH5kUcYoD2EhQ0BlhMTySXtdDHACL9pTolp6cWfRbocmiyEM/Xnw0uJuldsdRHI9I/PZ1CEe19gBf1JzWy3AuEhQYAQwNg0RugvE+/9TK0DJgFWiDBgVUfjET/BHUKhT4I/vF1X4a+30YDUAz49ERSOr21rToIFukv1olBsPBnHU0a7nq8h2C2M8DjkDELNItUf6FOvlet/eN6I+z09m1qgMdJO71L/QKON8Js9K9P/rwd4Hwj7PQe0gD5LGJdb4SZ6J+PzIvoY4BW9sthZj8iDaBGHQNY6p+PzIu4ZIGaSfh6DBgD5DMyDlkgO/25BIroPsA0GmMMsEllDIIdDTDak6UsKSWXgXE7SjP9c5F5kWgNkAtgA2QPDQCGBsBCA4ChAbDQAGBoACzxZIEyBZsFIjQAGBoACw0AhgbAQgOAoQGw0ABgaAAsNAAYGgALDQCGBsBCA4ChAbDQAGBoACw0ABgaAAsNAIYGwEIDgKEBsNAAYGgALJsbIPtHkB4IZADKLGRrA2TzrK+UMAagzFI2NkA+b3uQEsQAlFkMDQCGBsBCA4ChAbAwBgDDGAALs0BgmAXCwvsAYHgfAAsNAIYGwEIDgKEBsNAAYGgALDQAGBoACw0AhgbAQgOAoQGwGBuAqHEfO+pvwZyMpmOSYeEdXIkte2hYVxzdogFoAFBdcXSLBqABQHXF0S0agAYA1RVHt2gAGgBUVxzdogFoAFBdcXSLBqABQHXF0S0agAYA1RVHt2gAGgBUVxzdin/4CAkIDUCyhgYgWUMDkKyhAUjW0AAka2gAkjU0AMkaGoBkjYkBrseiKD7uHy6H6sGzd13psih+fFUfzt0Hh8JOLd85vX07ttyXdm06PF7KLtRlc7R+ss/U5dwtCwNcj/fDKKvW//xNfzzlz9+3c6VD9c9ZKUhf2KXlWzUElXouLQ+lHZsOj5eyS3WZHK2f7HN1OXfLwgB/fn3eWonu/ym5HD4qC73f/6vmkJPKxH1hl5br8pV6Li0PpR2bDo+Xskt1mRytn+xzdbl3yy4GqLxcOh5NJe1gI4fCji2Xb/97V8+15aa080FvgpeyM3WZHK2f7HN1uXfLzgCn+5Gc/t4GA0rKu3maSczByVVht5bvTVYLSMeW29LOB70JXsrO1GVxtH6yz9bl3i0zA5zvzV8OdV+0/TjXXW9Wg+o1YVPYqeVqDq7Uc2u5K+140JvgpexsXQZH6yf7fF3u3bIywHmIwB08fT2+fTvrURV2arm8l3Mfia60U9Ob4aXsTF3NJ6+j9ZN9vi73bhkZ4Dyafpq1nbL8jy/3GbHXUNdy3aDzXNyXdml6Q7yUfa6r+eBztH6yL9Tl3i0bA5Tj5ZdLRuredfeYqD9uXctl+748t5b70i5Nb4iXss91tR88jtZP9oW63LtlYoCy7UFzSDpP92VcsmJ9YZeWa05e+bhTn8yIcAnkpexSXUZH6yf7c13u3bK5D9Bd/+ujUYYivRYu90X6wi4tdxW435FpEhCOTQfHS9mlumyO1k/2mbqcu2VhgHYiqpNkw3wkpi9TOtwZ7wu7tHzrFpAuLQ+lHZsOj5eyS3WZHK2f7HN1uXaLm+FI1tAAJGtoAJI1NADJGhqAZA0NQLKGBiBZsxsDnLq73pfD5+12bv+bsnBXpS6RMUGlux6ddn5JvlYWxUc5t8l51P3LX543EvZjgH7L060Zl5mxoQFmCSqdy5MoMgNUT6HVT6K97NR5fHAO0ADpE1I6J22lBpjt6UObLjPQmP0Z4H74f341c/r9R2X3IFB1W/1ftbDtxqj75/b2+L1ErVn9T1egriMPY4SUrtp/djn889D84Dw8lnX5619F9YxgV0/3lb6x9rt/flW/+ajq7Eajaafr6b2ScU+L9+oXb999J0q/KWCXBhguDvUTf9VevOqBzHOzs6R+dLX6frVBqvrCeBS7AvVQn/NwQEjpqi9eDtXj4NXOtqKq+71tq9uj1tTTfqVvrPvun1/1K0Wq07zdy9m189zTpqaP6odDJzy30+3bAM0Ssd+le2q0KOur0kcdH1W/GI1iXyDC7cvBCChd/cP6n/u3m/3N7QnZ/Gao52P0aMK9sf679Znd/vPZF6zaeeppFxBUPxw64fko0n4M0D36MB7FczdxN3r02ne/qebZySj2BS6HfBwQULphfVQvrz5vo/O4WyR1LdeVdI31360/DP/cbqN2HnranerNL7pOzMbJcvZjgLnL2LlL8JXjUawm3lOzyP35f9PLWF+geZtdFiugkNLV5+TUAO2Z3/zPqJ76R+XUAF2hiQHGSdtJT7sHvurK+k7kbYBu/Te5jN3/3/93y8SHeXy6YDwZ7EbfAQGlW5kBxvXoZoBRb5+eRO4nl7oTWRugl6J9vvRHd4n4R/eaunM3j3/00+pAJvnRgNK1MUBzdj/EAJ+3ST0jj5STGODBAH07Tz0dxwDDh2xigOkotvdImnc19UmI7lpxql9UWl956tcVfVZv9LhPmp99gf6dmRkQUromC9ROA9Ms0Oe0niGV9JAFejBA384kC9T39Hp8r7o/dCLLLNB9mN6+T10yu55Wh2T2rUvS1U/c9UoWxT+7ZHZzXTJ5Hm8PhJSuuQ/QrYPG9wEOj/W0Z/PTfYBHA3TtDFf/cU8rf1bd7zuRy30AEiXwVaRvB2gA4gX61cDZ7AUiceK7F8eTfHaDEhICGoBkDQ1AsoYGIFlDA5Cs+S/31dQL+vGEmwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>There is a suggestion of less total abundance as fitted values
increase, which is super-weird. But it’s not too alarming…</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>lme_MplusZ <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone<span class="sc">+</span>Mod <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone )</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">anova</span>(lme_MplusZ,lme_MZ)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; refitting model(s) with ML (instead of REML)</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Data: estuaryZone</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; lme_MplusZ: Total ~ Zone + Mod + (Zone | Estuary)</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; lme_MZ: Total ~ Zone * Mod + (Zone | Estuary)</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; lme_MplusZ    7 595.91 612.31 -290.95   581.91                     </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; lme_MZ        8 597.14 615.89 -290.57   581.14 0.7618  1     0.3828</span></span></code></pre></div>
<p>No evidence of an interaction between Zone and Modification. Testing
for a <code>Mod</code> main effect:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>lme_Z <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone )</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">anova</span>(lme_Z,lme_MplusZ)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; refitting model(s) with ML (instead of REML)</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Data: estuaryZone</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; lme_Z: Total ~ Zone + (Zone | Estuary)</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; lme_MplusZ: Total ~ Zone + Mod + (Zone | Estuary)</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt;            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; lme_Z         6 608.43 622.50 -298.22   596.43                         </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; lme_MplusZ    7 595.91 612.31 -290.95   581.91 14.529  1   0.000138 ***</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>There is strong evidence that total abundance is different between
Modified and Pristine estuaries. The boxplot suggests abundance is
higher in Modified estuaries, and looking at the data, this appears to
be mostly due to high counts of <code>Balanus.variegatus</code>,
especially in outer modified zones.</p>
</div>
<div id="code-box-6.6-using-the-parametric-bootstrap-to-compute-the-standard-error-of-the-mod-fixed-effect-in-exercise-6.1." class="section level2">
<h2>Code Box 6.6: Using the parametric bootstrap to compute the standard
error of the <code>Mod</code> fixed effect in Exercise 6.1.</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>nBoot<span class="ot">=</span><span class="dv">500</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>bStat<span class="ot">=</span><span class="fu">rep</span>(<span class="cn">NA</span>,nBoot)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>ft_estu <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="cf">for</span>(iBoot <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBoot)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>{</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>   estuaries<span class="sc">$</span>TotalSim<span class="ot">=</span><span class="fu">unlist</span>(<span class="fu">simulate</span>(ft_estu))</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>   ft_i <span class="ot">=</span> <span class="fu">lmer</span>(TotalSim<span class="sc">~</span>Mod<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Estuary),<span class="at">data=</span>estuaries)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>   bStat[iBoot] <span class="ot">=</span> <span class="fu">fixef</span>(ft_i)[<span class="dv">2</span>]</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="fu">sd</span>(bStat) <span class="co">#standard error of Mod effect</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; [1] 4.395154</span></span></code></pre></div>
<p>And if we compare this to the standard error from
<code>summary</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(ft_estu)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; Formula: Total ~ Mod + (1 | Estuary)</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;    Data: estuaries</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 314.4</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; -2.2393 -0.7569  0.1553  0.7372  1.8962 </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;  Estuary  (Intercept)  10.68    3.268  </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt;  Residual             123.72   11.123  </span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; Number of obs: 42, groups:  Estuary, 7</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; (Intercept)   39.053      3.237  12.065</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; ModPristine  -11.243      4.287  -2.622</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt;             (Intr)</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; ModPristine -0.755</span></span></code></pre></div>
<p>we see the estimated standard error is 4.287348, which is pretty
close to the value we got by simulation.</p>
</div>
<div id="code-box-6.7-a-parametric-bootstrap-to-test-for-an-effect-of-estuary-in-exercise-6.1." class="section level2">
<h2>Code Box 6.7: A parametric bootstrap to test for an effect of
Estuary in Exercise 6.1.</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>ft_noestu <span class="ot">=</span> <span class="fu">lm</span>(Total<span class="sc">~</span>Mod,<span class="at">data=</span>estuaries)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">anovaPB</span>(ft_noestu,ft_estu,<span class="at">n.sim=</span><span class="dv">99</span>, <span class="at">ncpus=</span><span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Error in x$terms : $ operator not defined for this S4 class</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; Warning in Ops.factor(1, Estuary): &#39;|&#39; not meaningful for factors</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; ft_noestu: Total ~ Mod</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; ft_estu: Total ~ Mod + (1 | Estuary)</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;           df deviance   LRT Pr(&gt;LRT)</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; ft_noestu  3    322.2               </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; ft_estu    4    314.4 7.832     0.24</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; P-value calculated by simulating 99 samples from ft_noestu.</span></span></code></pre></div>
<p>So we have no evidence of an <code>Estuary</code> effect. (The
<code>ncpus</code> argument was specified here to avoid parallel
processing. This was only done to avoid errors when compiling this file
on computers set to use just one cpu for <code>R</code>.)</p>
</div>
<div id="exercise-6.6-accurate-inferences-about-the-estuary-data" class="section level2">
<h2>Exercise 6.6: Accurate inferences about the estuary data</h2>
<p><em>Use the parametric bootstrap to get a formal test for a
<code>zone:mod</code> interaction.</em></p>
<p>We can just run the old analysis and change from <code>anova</code>
to <code>anovaPB</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>lme_MZ <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone<span class="sc">*</span>Mod <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone, <span class="at">REML=</span><span class="cn">FALSE</span> )</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>lme_MplusZ <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone<span class="sc">+</span>Mod <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone, <span class="at">REML=</span><span class="cn">FALSE</span> )</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">anovaPB</span>(lme_MplusZ,lme_MZ,<span class="at">n.sim=</span><span class="dv">99</span>,<span class="at">ncpus=</span><span class="dv">1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; Warning in Ops.factor(Zone, Estuary): &#39;|&#39; not meaningful for factors</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; unable to evaluate scaled gradient</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; Model failed to converge: degenerate Hessian with 1 negative eigenvalues</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; Data: estuaryZone</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; objectNull: Total ~ Zone + Mod + (Zone | Estuary)</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; object: Total ~ Zone * Mod + (Zone | Estuary)</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt;            npar   AIC   BIC logLik deviance Chisq Pr(&gt;Chisq)</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; objectNull    7 595.9 612.3 -291.0    581.9                 </span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; object        8 597.1 615.9 -290.6    581.1 0.762       0.35</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; P-value calculated by simulating 99 samples from objectNull.</span></span></code></pre></div>
<p>There is no evidence of an interaction.</p>
<p>(Ignore the warnings in the output – this is random stuff that was
thrown up in bootstrap resamples that didn’t get a good fit.)</p>
<p><em>How do results compare to those from when you were using the
<code>anova</code> function?</em></p>
<p>Results are similar to what we saw before. The only thing that is
different is the <span class="math inline">\(P\)</span>-value, but it is
very similar (suggesting there was no need for a parametric bootstrap
here!).</p>
<p><em>This would all have been so much easier if there wasn’t a random
effect in the model… do we really need <code>Estuary</code> in
there?</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>lme_MZ <span class="ot">=</span> <span class="fu">lmer</span>(Total<span class="sc">~</span>Zone<span class="sc">*</span>Mod <span class="sc">+</span> (Zone<span class="sc">|</span>Estuary), <span class="at">data=</span>estuaryZone, <span class="at">REML=</span><span class="cn">FALSE</span> )</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>lme_MZnoest <span class="ot">=</span> <span class="fu">lm</span>(Total<span class="sc">~</span>Zone<span class="sc">+</span>Mod, <span class="at">data=</span>estuaryZone)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">anovaPB</span>(lme_MZnoest,lme_MZ,<span class="at">n.sim=</span><span class="dv">99</span>,<span class="at">ncpus=</span><span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; Error in x$terms : $ operator not defined for this S4 class</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; Warning in Ops.factor(Zone, Estuary): &#39;|&#39; not meaningful for factors</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; lme_MZnoest: Total ~ Zone + Mod</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; lme_MZ: Total ~ Zone * Mod + (Zone | Estuary)</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt;             df deviance   LRT Pr(&gt;LRT)</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; lme_MZnoest  4    582.8               </span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; lme_MZ       8    581.1 1.684     0.33</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; P-value calculated by simulating 99 samples from lme_MZnoest.</span></span></code></pre></div>
<p>We have no evidence of an <code>Estuary</code> effect either!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
