<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-05-30" />

<title>Chapter 9 – Design-based inference – Exercise solutions and Code Boxes</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Chapter 9 – Design-based inference – Exercise solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-05-30</h4>



<div id="exercise-9.1-smoking-in-pregnancy" class="section level2">
<h2>Exercise 9.1: Smoking in pregnancy</h2>
<p><em>Consider again the guinea pig experiment… How can we make inferences about the treatment effect, without assuming normality?</em></p>
<p>Design-based inference allows us to relax distributional assumptions. Specifically, if we use a permutation test as in Code Box 9.1, or a bootstrap test as in Code Box 9.3, we do not assume normality.</p>
</div>
<div id="exercise-9.2-three-example-permutations-of-treatment-labels-in-the-guinea-pig-data" class="section level2">
<h2>Exercise 9.2: Three example permutations of treatment labels in the guinea pig data</h2>
<p><em>Does the observed statistic of 2.67 seem large compared to these values? What does this tell you?</em></p>
<p>The three statistics obtained by permuting data were 0.76, -2.09 and -1.08. These are all smaller than 2.67, suggesting that 2.67 is unusually large compared to what we would expect if there were no treatment effect. However, to say something more precise about how unusual this is we should do many more permutations…</p>
</div>
<div id="code-behind-figure-9.1" class="section level2">
<h2>Code behind Figure 9.1</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">lm</span>(errors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tObs <span class="ot">=</span> <span class="fu">summary</span>(ft_guinea)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#store observed t-statistic</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nPerm <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tStats <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,nPerm)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tStats[<span class="dv">1</span>] <span class="ot">=</span> tObs</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iPerm <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nPerm)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  guineapig<span class="sc">$</span>treatPerm <span class="ot">=</span> <span class="fu">sample</span>(guineapig<span class="sc">$</span>treatment) <span class="co">#permute treatment labels</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  ft_guineaPerm <span class="ot">=</span> <span class="fu">lm</span>(errors<span class="sc">~</span>treatPerm,<span class="at">data=</span>guineapig) <span class="co">#re-fit model</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  tStats[iPerm] <span class="ot">=</span> <span class="fu">summary</span>(ft_guineaPerm)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#store t-stat</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.2</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(tStats,<span class="at">main=</span><span class="st">&quot;Null distribution of t under permutation&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>tObs,<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#put a red line on plot for observed t-stat</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">mean</span>( tStats <span class="sc">&gt;=</span> tObs ) <span class="co">#compute P-value</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.007</span></span></code></pre></div>
</div>
<div id="code-box-9.1-a-permutation-test-for-the-guinea-pig-data-using-mvabund" class="section level2">
<h2>Code Box 9.1: A permutation test for the guinea pig data using <code>mvabund</code></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">manylm</span>(errors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_guinea)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = errors ~ treatment, data = guineapig)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                         </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  7.134  0.006 **</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.2-permutation-test-for-a-relationship-between-latitude-and-plant-height" class="section level2">
<h2>Code Box 9.2: Permutation test for a relationship between latitude and plant height</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ft_height <span class="ot">=</span> <span class="fu">manylm</span>(height<span class="sc">~</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_height)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = height ~ lat, data = globalPlants)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            129       1  9.271  0.002 **</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.3-using-the-mvabund-package-for-a-bootstrap-test-of-guinea-pig-data" class="section level2">
<h2>Code Box 9.3: Using the <code>mvabund</code> package for a bootstrap test of guinea pig data</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">manylm</span>(errors<span class="sc">~</span>treatment, <span class="at">data=</span>guineapig)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_guinea, <span class="at">resamp=</span><span class="st">&quot;residual&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = errors ~ treatment, data = guineapig)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)  </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                        </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  7.134  0.014 *</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual resampling.</span></span></code></pre></div>
</div>
<div id="exercise-9.3-case-resampling-in-the-guinea-pig-data" class="section level2">
<h2>Exercise 9.3: Case resampling in the guinea pig data</h2>
<p><em>We can… resample cases… Below are three examples.</em></p>
<p>C N N N C N N C N N C C N N C C N N N N 10 33 28 33 47 66 33 26 63 66 36 20 38 28 35 15 66 33 43 26</p>
<p>N N N N C N N N N N C C C C N C C C N C 33 89 34 89 35 43 38 33 23 63 10 26 11 10 43 47 10 19 66 35</p>
<p>N N C C N N N C N C N C N N N C C C C C 66 66 19 47 63 43 43 20 33 15 28 26 89 38 43 47 20 20 11 20</p>
<p><em>Count the number of Controls in each case resampled dataset. Did you get the number you expected to?</em></p>
<p>OK so the first one has 8 Control sites, second one has 9 Control sites, third has 10 Control sites. This is not expected in the sense that the original study was planned with 10 Control and 10 Treatment guinea pigs, so we have messed with the design by doing case resampling :(</p>
</div>
<div id="exercise-9.4-global-plant-height-does-rainfall-explain-latitude-effect" class="section level2">
<h2>Exercise 9.4: Global plant height – does rainfall explain latitude effect?</h2>
<p><em>She wants to know: Does latitude explain any variation in plant height beyond that due to rainfall?</em></p>
<p><em>What is the model that should be fitted under the null hypothesis? Does it include any predictor variables?</em></p>
<p>The model under the null hypothesis, as in Code Box, includes rainfall:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ft_heightR<span class="ot">=</span><span class="fu">lm</span>(height<span class="sc">~</span>rain, <span class="at">data=</span>globalPlants)</span></code></pre></div>
<p>and we want to see if there is significant additional variation in plant height that is explained by latitude, beyond that explained by rainfall.</p>
</div>
<div id="code-box-9.4-residual-resampling-using-mvabund-for-exercise-9.4." class="section level2">
<h2>Code Box 9.4: Residual resampling using <code>mvabund</code> for Exercise 9.4.</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ft_heightRL<span class="ot">=</span><span class="fu">manylm</span>(height<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_heightRL, <span class="at">resamp=</span><span class="st">&quot;perm.resid&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = height ~ rain + lat, data = globalPlants)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain           129       1 20.983  0.002 **</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            128       1  0.429  0.512   </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.5-plant-height-data-checking-assumptions" class="section level2">
<h2>Code Box 9.5: Plant height data – checking assumptions</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ft_heightRLlm <span class="ot">=</span> <span class="fu">lm</span>(height<span class="sc">~</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_heightRLlm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAFQCAMAAACBJ1miAAAA2FBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYLDgQ6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv9rjiOQOgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbkJDbtmbbtpDb25Db27bb29vb2//b/7bb///w8+n/tmb/25D/27b//7b//9v////rrQN2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPs0lEQVR4nO2dC2PbthWF4TTeLPeZSsleXWO7e5rZ2mUrt3XdatKR8P//0fAkwacAEeTl45zWiSJDIHQ+4OKSBEnGIVIx6gZsXQBALAAgFgAQCwCIBQDEAgBiAQCxAIBYAEAsACAWABALAIgFAMQCAGIBALEAgFgAQCwAIBYAEAsAiAUAxAIAYgEAsQCAWABALAAgFgAQCwCIBQDEAgBiAQCxaAAkjN2Jv44HdhP82dMDu34q/vHDLxhjn7196vtE5dN/+V7XUKmmUMq0Pn9f21D56cgiAyC/22AAxzfGsJfv/T784c0LLwDs6rEFgPp0ZJEBkENgKADx0srTmaQoeAZAK6LEdzMBogMgvosFIOPIR1/JL5uyqz+8YS++E7/44VN29Zb/85a9fFRlZGf//LHinLDrSkafH24Z21t/RKV7t7ys88/vmKomUaz+4YyAk/jN1ZeFz6m2+MNBDAG7oaJ1SQBpb9EBEDYZAKntc/bl9U8H0w8/td85b4kM4tWVgiMrEu+5AMryRa8WrxsAjnpDL62rBoCEZgGUrVsVgBe/FF9FA3i+ld8uVZ1Y/Hn9nv9X+rLn/xbf963+hTDj50+y5N4B4ESwRNtbAHDKywrEFJGWg8SZA8S/35tiSgbAjwfxty7htm5NIejFt+JbawfN11J/pUV6pLvn9VNpz49/FePhxgFQMa4KwClv6hSFbxoATNm0MLY5B7itWxWA70Wn/dPBMVR5mOqgoskUA0SYdPpG++ILoCxv6nRglwBEDWWo0vXUsqBK69YFQHz5n0lTbCDJZUftAiDznZe///FQAWCnkC+lTUUHrZfvA5CzdgBXr+x+QKV16wKgv6znCNCd/VgFoCdh8ebVr1gZLerlz4yAu0rDUsfitY8AnYE05oB2ALmN4/tGGip2j3ROZT6cs2r5PgCNHZEGgBXPAXq8N7KgzhFw/fThoToH2CTSyWH3XBaqlK8ASGvBPVEEDw7SOoCW1kUVJQDpX2M/oHsOaEzC3HR+FbW/Ul5pVcpXAOTt+wGFr00AbuvyNe0HyO+RM2dP+LfyVW8W9PKPaZGeG5mDcb/Wu8LPgser7w7V8hUAcsf35d+c4P7hG/HRV8WRpBYATuvUpz2POvlqJYejT+++8D4gOi+tBMByBQDEAgBiAQCxAIBYAEAsACAWABALAIgFAMQCAGIBALEAgFgAQCwAIBYAEAsAiAUAxAIAYgEAsQCAWABALAAgFgAQCwCIBQDEAgBiAQCxAIBYAECsyAAYZEQFIG51yxUAEAsAKOREnlEAHA/ywvTeK9U2DYDx0oDxAKT6Tkt37UW2DIA5f44HwFifttzsKLS6tWkaAM+3CkBeDULh2dcKhRFArQnmANnHb7idjgdWtz6NnQVxxeDqUSRCHf5vHIAj7AcQCwCIBQDEAgBiAQCxAIBYAEAsACAWABALAIgFAMQCAGIBALEAgFgAQCwAIBYAEGtUAObEfKzqVqkRzwlrdSzNAgCjcUaAOReMEXBeI4Wg40EuR2kCwLqgukabA5KrR4wAD403CadsDwDnNWIW9Hz7EQCc1Zhp6OmBAQCvrINr+aV3LTGaMlp1c5a7EtQoq/7Wu5qI2gAA0/Era6G1MgCYQIy7nd/9vhkATKDC9waADACmUOl7bQ7IAGASOR2/kgVlADCRWpIfbv0fBkBe9ZIy5zGBlzZv5WpL/7MYABL5eN0bntz0lA6obkvKYgCQV9/lYhc3H/S40E0CyKIBSOSzRwEgUFkcACL2yKP9xwNCUJiyWADUBZCnh0H+bxBAFg1AFG0OQAYApMoAgFRZLAAeC05K5Uw/+L27uq2o7v/4IyBhbP/8xRPuF6TU8H90AGJnWS2LwN1SpJr+D05Dz4Qg1e+fP5YAcL+gNv8HHwtKb/rW/Jib1Jz+xzEC2v0feChiz3Nha5e1UsVhis3fL6jV/uHHgp4/+V79dCrV6U/euS5lIwA6/B8E4PSw58fXj/0A/Ktbtbr8HzYHyPiS7HtDUEh161Wn/UPT0ORGZkKDjkYDgBUORYymHv8BYFyp3Zw+/wdmQb7HgryqW6HUeohe/2OMgGGnhNcMQH21bDc2AKyKaJMMPvKrZRMAwKqIplTw0fF/fABYFdGQWY7IzvofAwBWRdRlD/Hust3ujP9RsiAsTayK6ehzbvqNF4IGN3ddMuugzwYfABhJJvycDT4DAQSdlD9f3Yrkk/1HGgH6RhB554KHwOrWInY2+Y8EwC5K7D0cnYoRos7FdCWr6wPgHX6GArArTfp2xOQJMZ2nbgGA2v1l/u4PHgH6NG/SPQJ0kdODPHO8fgBq9zck/gwEYE70pj1zgB0kcv3E2pelqK/CuHQ/gIDzee8NlS9VKtQ3A9hBwpObtY8Apv/LJgVwXtb27jOXKwGger+YfucGQGRBOgidHlYPINtlwf5jTziWmDryvPM5/hYHwPGwxylJV6FdHyMgrrLQrg8AMXWp/bhVQRxlwXOv1f19Uclly9NxqwIu0x/d/UMJ3N/f41YFw5VdlH4q9zPcqmCwtO/F//72mxdlTZeEoM3fqkB5qDv/zt//+8J+3KpgkIyHOv77ZkGu+0MBRNFiARQeKu/97K+5DwADVPrv2f35vc054wEQMej6Kel6WnxwdQtS6aA2vwmg9oF7J+N3qyj/fckJmavHVE7CgwgsEoDrf2sCVC3edL9Fl52STHtONgZWtxy5vX9nc6A++71qvWw/QALY2o6YE/13+gxMZQqoFvbq/EqXj4Cek/IxtzsPOU5r98szAM3C/u7zAXNA2v1sgKjbnYVq9tv/2+wPcp8POCk/bGHckgBkle5vR4D0v1E01H0+0n7Aqp4jVvHfpP+KQb3gBe7zQQD+1T0Jd5+LX9i6oGqWadIf9Vet4GXu8wsApKZTd3qsdPZQ0SIA1Ky3J993jcZf6j4PByAXRcv8J2esd0es+z4pgdulU73r2+BfH70Xd36lQACqZ4s9gXT1k3Aj9OjEpx49h7nPL1mWIil8xoYdjJ4/gEbqk+nYY64D1hrsPr8AgIwsSX/4ibpdEtWnXjMGmF4JqhXDfX4pgGErIoK2O72ymkz0qaRvkdznlwIYGoDmDKDN/8J+XSSa+xwA6qrbr/e83Jk3XudXAgBX7Z3feRpMZPf5BQBWfJlqM/hIBCrxUc2N7z7HOeFSzeBjQr8eAKO4zwHAqmG/AqDdZ2ws9zkAaLXYn5ngP6r7HACUWv030ef+ftwjtwDQcXtDdfXpvbR/3KZuHkC7/VyHnglOW2wbQLv78lyXDPyTnDbaNIAu+3Xkmea83YYBdNiv+35xA8qxtVkAnfZzfeaaT3TieqMA2u03Gb+2n0+zcGCbAHrcNys3phoAmwTQ4z4r3Z9o5czEAGawLuhc35+0/29vBLS5r9a4sbomatC2ALS5n7WYP+EI3RSAhv1d7k/Yuu0AaO38re5POkFtBUCL+1nWYf+kbdsGgDb3O+yftF18GwD83SeYmdYPoOG+s86K2HyplQMozd8J9+0q89m4z1cOoFzYv+tzf4qmdGp9AApfd4773faP1g7f5kYvSFJdWW/D/pmGnqLB0QvSVFcxtfTfcX+GvV9q0QDachmn91fcb/gfowERtGQArHJ42/5v/K+5v5uh90qLBeDa7jKoJz2l/TGaHV8LBFAGet4AwBqdX+4DxGt2fC0NgOrJxnteHwTG/dpxz6jtjq5RAIxwrwhmzxPq1QpuyHemXtn36yddAjc0tcYZAf33MQisjpklUqrrqz+5xVAqa7s34fztHy0ERbxXBCt+yu7PbQxSJbLFus/HmwNi3CuCGbe5jToFBNv7VbEO95fh/xyXpdhf2m7PSwBO4LGlnRsyL9D+OWZBzPnhvAKD19frdHb+xfg/KoDicWJ91dUHQ2G4fWEGgr1a0dHy3ef0ABivVd0A0HWdRKf7i/KfGgBz/1F7p8HGUY/7i7J/hgAq8b99o33uA4CjywCcuTSrK+lZqP/kWVBfnGmoJ+kBgEu3W/b3s76Oe8k6kcgBtKi1T6/SfT5PAE2t1X1OCMBf5VW7qxQRAG+FbXeppSkqHGW7Sy1NUeEo211qaYoKR9nuUktTVDjKdpdamqLCUba71NIUFY6y3aWWpqhwlO0utTRFhaNsd6mlKSqEwgQAxAIAYgEAsQCAWABALAAgFgAQCwCIBQDEAgBiAQCxAIBYRABOD+zMg3Nrev7E8+laeeBj2b0rvqDRPqIBcHoQJqUBz249HjwfbyYfjJwHEPCu+IJGe4kGwPPtnfgz9f7uue/z5fTKbf9HAnpXzMMb7SfKOcC7p+Zsn/t970CT/CsuPzLwkdd1UQJIAr67L4CPH/0Lh1RcKKTRPiIEkIdMaJ4+6f4Z0ksDAQQ12kd0APKg6WwmAMIa7SMyAIFdaR4hKHr/JwCQ6lw69fsqqc28x5mE/Ss2rYnuP9UISM/cc6IhT59C09AgAMGN9hHVfkBoV/L1KXRHLABAeKN9RAMg1VeRjDFXpoGHIvwBhDfaRzgYRywAIBYAEAsAiAUAxAIAYgEAsQCAWABALAAgFgAQCwCIBQDEAgBiAQCxAIBYAEAsACAWABALAIgFAMQCAGIBALEAgFgAQCwAIBYAEGs+AIpHhb74+8FzFXJ+Jz7VUrZ8Mz+/mNNU0lrRBJoPACl9fYWvF53l7C/0w0f7VzXbsgAgFRmAuVBDX7VxphIAkLIAfnPL1MUQ5QUy+sXx9e/kdb367WdR6Pqngy0nL8pImPqcMfN4MF0/udFvqT+KMl+LmHdXVKJ+Z7cn3x3jaowWzROAvCTd/KgAIh/iejxIG6+fePF2EbrlG9JteWWMfn1X1sbVNQAFgLKM3oCtRP7YitWQOffg2EiaJ4C9ihu6Bwv39IVHuXRrbzu2MVX/6J5+fP2o440BUFwpk2uf5ftOGbuRAkBRcei1w0M0TwDaLG2gMEkHceMWL9623rkxPmesF0C1jHK9AOBUPB2BWQMweakBYNzixdsFABtqRAh/8W05AlpDUKVMDYCtWN8XZctzgDsCuE1jqiPAlHNHgPrbCUHlJHz9ZOuslmkbAVZJ5IvBOjRnAEVm6MwBd07CWJ8DVOjOyxCk0tDTw/V/1IStQ361TBVANROdKC+dMwCVlaieWGZBKuk0b0tTiyzo9HCjOzbbl94ligATqZPg8CRe3VXLmJnXzYJkxWooxL4tSodmDUDl5Wo+tPsB2ln7dlLbD1CXqCZmoCiZsC4KyyMdX+s5oCyj8tLafoAeItEvR+3SvACMpXfTmHmJtgFgxgIAYgEAsQCAWABALAAgFgAQCwCIBQDEAgBiAQCxAIBYAEAsACAWABALAIgFAMQCAGIBALEAgFgAQCwAIBYAEOv/4bDKXsMpYVAAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="exercise-9.5-plant-height-data-log-transformation" class="section level2">
<h2>Exercise 9.5: Plant height data – log transformation</h2>
<p>Refit the linear model to the plant height data, available as the <code>globalPlants</code> dataset in the <code>ecostats</code> package, using a log-transformation of the response. Use residual resampling to test for an effect of latitude after controlling for the effect of rainfall.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>globalPlants<span class="sc">$</span>loght <span class="ot">=</span> <span class="fu">log</span>(globalPlants<span class="sc">$</span>height)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ft_loghtRL<span class="ot">=</span><span class="fu">manylm</span>(loght<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_loghtRL, <span class="at">resamp=</span><span class="st">&quot;perm.resid&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = loght ~ rain + lat, data = globalPlants)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain           129       1  32.01  0.002 **</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            128       1   9.62  0.004 **</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>ft_loghtRLlm <span class="ot">=</span> <span class="fu">lm</span>(loght<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_loghtRLlm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>How do results compare to the analysis without a log-transformation?</em></p>
<p>Now the test statistics are larger and more significant (which I guess because we can better see the signal in data when we are closer to satisfying our assumptions).</p>
<p><em>How do results compare to what you would have got if you used model-based inference, by applying <code>anova</code> to the <code>lm</code> function? Is this what you expected?</em></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_loghtRLlm)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: loght</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain        1  70.761  70.761 34.1497 3.989e-08 ***</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat         1  19.934  19.934  9.6203  0.002368 ** </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 128 265.226   2.072                      </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Results are nearly identical, which is as expected, because there weren’t any violations of distributional assumptions that might have warranted resampling.</p>
</div>
<div id="exercise-9.6-guinea-pig-data-log-transformation" class="section level2">
<h2>Exercise 9.6: Guinea pig data – log transformation</h2>
<p><em>Log-transform number of errors and check assumptions. Does this better satisfy assumptions than the model on untransformed data?</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>guineapig<span class="sc">$</span>logErrors <span class="ot">=</span> <span class="fu">log</span>(guineapig<span class="sc">$</span>errors)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ft_guineaLog <span class="ot">=</span> <span class="fu">lm</span>(logErrors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_guineaLog)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(guineapig<span class="sc">$</span>logErrors,guineapig<span class="sc">$</span>treatment,sd)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; guineapig$treatment: C</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.521912</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; guineapig$treatment: N</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.445521</span></span></code></pre></div>
<p>This looks a <em>lot</em> better. Standard deviations are similar now, no obvious non-normal trend on quantile plot.</p>
<p><em>Repeat the permutation test of Code Box 9.2 on log-transformed data.</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ftMany_guineaLog <span class="ot">=</span> <span class="fu">manylm</span>(logErrors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftMany_guineaLog)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logErrors ~ treatment, data = guineapig)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                         </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  9.434  0.009 **</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p><em>How do results compare to the analysis without a log-transformation? Is this what you expected to happen?</em></p>
<p>Results are similar, but the test statistic is slightly larger and slightly more significant. This is expected because by fitting a model for the data that is closer to satisfying assumptions, it will work better and more clearly see any signal in the data.</p>
</div>
<div id="exercise-9.7-revisiting-linear-models-past" class="section level2">
<h2>Exercise 9.7: Revisiting linear models past</h2>
<p><em>Go back to a couple of linear models (with fixed effects terms only) you have previously fitted, e.g. in the exercises of Chapter 4, and reanalyse using (residual) resampling for inference.</em></p>
<div id="repeating-exercise-4.9" class="section level3">
<h3>Repeating Exercise 4.9:</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">data</span>(snowmelt)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> snowmelt<span class="sc">$</span>logFlow <span class="ot">=</span> <span class="fu">log</span>(snowmelt<span class="sc">$</span>flow)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a> snowmelt<span class="sc">$</span>logFlow[snowmelt<span class="sc">$</span>logFlow<span class="sc">==-</span><span class="cn">Inf</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a> snowReduced <span class="ot">=</span> <span class="fu">na.omit</span>(snowmelt[,<span class="fu">c</span>(<span class="st">&quot;logFlow&quot;</span>,<span class="st">&quot;snow&quot;</span>,<span class="st">&quot;elev&quot;</span>)]) <span class="co">#this line not normally needed, lm can handle NA&#39;s, but seems needed because of a weird conflict with MCMCglmm code in Chapter 11 solutions</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a> ft_logsnow <span class="ot">=</span> <span class="fu">lm</span>(logFlow<span class="sc">~</span>elev<span class="sc">+</span>snow, <span class="at">data=</span>snowReduced)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">plotenvelope</span>(ft_logsnow)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(ft_logsnow)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = logFlow ~ elev + snow, data = snowReduced)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.90161 -0.15794  0.02338  0.15834  1.08662 </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.8805208  0.3193019  12.153  &lt; 2e-16 ***</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev         0.0003357  0.0001226   2.739  0.00651 ** </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        -0.0103172  0.0007551 -13.663  &lt; 2e-16 ***</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2909 on 316 degrees of freedom</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3774, Adjusted R-squared:  0.3735 </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 95.78 on 2 and 316 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">confint</span>(ft_logsnow)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     2.5 %        97.5 %</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.252294e+00  4.5087472418</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev         9.457986e-05  0.0005768232</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        -1.180299e-02 -0.0088315037</span></span></code></pre></div>
<p>Repeating using resampling:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mft_logsnow <span class="ot">=</span> <span class="fu">manylm</span>(logFlow<span class="sc">~</span>elev<span class="sc">+</span>snow, <span class="at">data=</span>snowReduced)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mft_logsnow)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             F value Pr(&gt;F)    </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 147.699  0.001 ***</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev          7.503  0.004 ** </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        186.668  0.001 ***</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: with 999 resampling iterations using residual resampling and response assumed to be uncorrelated </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hooper&#39;s R-squared: 0.3774 </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lawley-Hotelling trace statistic:  95.78, p-value: 0.001 </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: with 999 resampling iterations using residual resampling and response assumed to be uncorrelated</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mft_logsnow)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             2.5 %        97.5 %</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:(Intercept)  3.252294e+00  4.5087472418</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:elev         9.457986e-05  0.0005768232</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:snow        -1.180299e-02 -0.0088315037</span></span></code></pre></div>
<p><em>Did results work out differently? Is this what you expected? (Think about sample size and the normality assumption.)</em></p>
<p><em>P</em>-values are pretty much the same, which is expected, because we didn’t have concerns about normality and the sample size was big enough for CLT to deal with such concerns anyway.</p>
<p>The confidence intervals are identical, because they are computed in the same way irrespective of resampling.</p>
</div>
<div id="now-repeating-exercise-4.10" class="section level3">
<h3>Now repeating Exercise 4.10:</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aphidsBACI)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lm_aphids <span class="ot">=</span> <span class="fu">lm</span>(logcount<span class="sc">~</span>Plot<span class="sc">+</span>Time<span class="sc">+</span>Treatment<span class="sc">:</span>Time,<span class="at">data=</span>aphidsBACI)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_aphids)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: logcount</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plot            7 0.8986  0.1284  0.4603 0.833357   </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time            1 5.4675  5.4675 19.6038 0.004434 **</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Treatment  1 0.7397  0.7397  2.6522 0.154527   </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals       6 1.6734  0.2789                    </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mlm_aphids <span class="ot">=</span> <span class="fu">manylm</span>(logcount<span class="sc">~</span>Plot<span class="sc">+</span>Time<span class="sc">+</span>Treatment<span class="sc">:</span>Time,<span class="at">data=</span>aphidsBACI)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mlm_aphids)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logcount ~ Plot + Time + Treatment:Time, data = aphidsBACI)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        15                         </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plot                8       7  0.130  0.992   </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time                7       1 15.860  0.006 **</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Treatment      6       2  1.105  0.173   </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p>This looks fairly similar, the test statistic is a bit different (but equivalent) and significance levels generally similar. There is slightly more movement in <em>P</em>-values than last time, which may be related to the sample size being smaller (in fact the residual degrees of freedom is only <code>6</code>.)</p>
</div>
</div>
<div id="code-box-9.6-block-resampling-using-mvabund-for-estuary-data" class="section level2">
<h2>Code Box 9.6: Block resampling using <code>mvabund</code> for estuary data</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(estuaries)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  ft_estLM <span class="ot">=</span> <span class="fu">manylm</span>(Total<span class="sc">~</span>Mod,<span class="at">data=</span>estuaries)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(ft_estLM,<span class="at">resamp=</span><span class="st">&quot;case&quot;</span>,<span class="at">block=</span>estuaries<span class="sc">$</span>Estuary)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = Total ~ Mod, data = estuaries)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     41                      </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mod             40       1  9.916  0.472</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via case block resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.7-block-resampling-using-permute-for-raven-data" class="section level2">
<h2>Code Box 9.7: Block resampling using <code>permute</code> for raven data</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ravens)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>crowGun <span class="ot">=</span> ravens[ravens<span class="sc">$</span>treatment <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>crowLong <span class="ot">=</span> <span class="fu">melt</span>(crowGun,<span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">&quot;Before&quot;</span>,<span class="st">&quot;After&quot;</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable.name=</span><span class="st">&quot;time&quot;</span>,<span class="at">value.name=</span><span class="st">&quot;ravens&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(permute)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>CTRL <span class="ot">=</span> <span class="fu">how</span>(<span class="at">blocks=</span>crowLong<span class="sc">$</span>site)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>permIDs <span class="ot">=</span> <span class="fu">shuffleSet</span>(<span class="dv">24</span>,<span class="at">nset=</span><span class="dv">999</span>,<span class="at">control=</span>CTRL)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Set of permutations &lt; &#39;minperm&#39;. Generating entire set.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ravenlm <span class="ot">=</span> <span class="fu">manylm</span>(ravens<span class="sc">~</span>site<span class="sc">+</span>time,<span class="at">data=</span>crowLong)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ravenlm,<span class="at">bootID=</span>permIDs)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using &lt;int&gt; bootID matrix from input.</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = ravens ~ site + time, data = crowLong)</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)  </span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     23                        </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site            12      11   3.27  0.996  </span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time            11       1   6.76  0.025 *</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p><em>How do results compare to what we got previously (Code Box 4.2), using model-based inference?</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ravenlm <span class="ot">=</span> <span class="fu">lm</span>(ravens<span class="sc">~</span>site<span class="sc">+</span>time,<span class="at">data=</span>crowLong)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ravenlm)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: ravens</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site      11 55.458  5.0417    4.84 0.007294 **</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time       1  7.042  7.0417    6.76 0.024694 * </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 11 11.458  1.0417                    </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We are getting almost the same <em>P</em>-value for the <code>time</code> effect. Interestingly, we get a very different <em>P</em>-value for the <code>site</code> effect. This is because the resampling strategy we used permuted data within sites but did not permute data across sites – this does not give a valid test for a <code>site</code> effect, hence the site <em>P</em>-value from the permutation test is not valid.</p>
</div>
<div id="code-box-9.8-moving-block-bootstrap-test-for-species-richness-modelling" class="section level2">
<h2>Code Box 9.8: Moving block bootstrap test for species richness modelling</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a lm:</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mft_richAdd <span class="ot">=</span> <span class="fu">manylm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data=</span>Myrtaceae)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a boot ID matrix: </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>BootID <span class="ot">=</span> <span class="fu">BlockBootID</span>(<span class="at">x =</span> Myrtaceae<span class="sc">$</span>X, <span class="at">y =</span> Myrtaceae<span class="sc">$</span>Y, <span class="at">block_L =</span> <span class="dv">20</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">nBoot =</span> <span class="dv">199</span>, <span class="at">Grid_space =</span> <span class="dv">5</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mft_richAdd,<span class="at">resamp=</span><span class="st">&quot;case&quot;</span>,<span class="at">bootID=</span>BootID)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using &lt;int&gt; bootID matrix from input.</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logrich ~ soil + poly(TMP_MAX, degree = 2) + </span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:     poly(TMP_MIN, degree = 2) + poly(RAIN_ANN, degree = 2), data = Myrtaceae)</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                            Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                   999                         </span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; soil                          991       8 11.971  0.585   </span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MAX, degree = 2)     989       2 18.244  0.420   </span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MIN, degree = 2)     987       2 17.533  0.005 **</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(RAIN_ANN, degree = 2)    985       2  8.208  0.565   </span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 199 iterations via case resampling.</span></span></code></pre></div>
<p><em>How does this compare to what you would get if you just used model-based inference, using the <code>lm</code> function?</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data=</span>Myrtaceae)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_richAdd)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: logrich</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; soil                         8  15.075 1.88438 12.9887 &lt; 2.2e-16 ***</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MAX, degree = 2)    2   5.551 2.77533 19.1299 7.068e-09 ***</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MIN, degree = 2)    2   5.162 2.58082 17.7892 2.573e-08 ***</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(RAIN_ANN, degree = 2)   2   2.382 1.19081  8.2081 0.0002915 ***</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals                  985 142.902 0.14508                      </span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Everything is highly significant here, but much less so when using the moving block bootstrap. This is probably partly because the data are spatially autocorrelated, so we are seeing false significance in the <code>lm</code> results because dependence of observations hasn’t been accounted for. But the difference in results is quite extreme (when considering that the spatial signal wasn’t super-strong) so the moving block bootstrap maybe is being overly conservative here too.</p>
</div>
<div id="code-box-9.9-moving-block-bootstrap-standard-errors-for-species-richness-predictions" class="section level2">
<h2>Code Box 9.9: Moving block bootstrap standard errors for species richness predictions</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>nBoot<span class="ot">=</span><span class="dv">199</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>predMat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(Myrtaceae<span class="sc">$</span>logrich),nBoot)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iBoot <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBoot)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>   ids <span class="ot">=</span> BootID[iBoot,]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>   ft_i <span class="ot">=</span> <span class="fu">update</span>(ft_richAdd,<span class="at">data=</span>Myrtaceae[ids,])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>   predMat[ids,iBoot] <span class="ot">=</span> <span class="fu">predict</span>(ft_i)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>bootSEs <span class="ot">=</span> <span class="fu">apply</span>(predMat,<span class="dv">1</span>,sd,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>lmSEs   <span class="ot">=</span> <span class="fu">predict</span>(ft_richAdd,<span class="at">se.fit=</span><span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(bootSEs,lmSEs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          bootSEs      lmSEs</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.03545110 0.02982530</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.03492126 0.02396074</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.04734406 0.02853756</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.03930774 0.03348368</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.06201326 0.06279115</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.03716947 0.03413518</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.04534179 0.02808283</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.07430718 0.08272950</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.03408825 0.02759009</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.05874818 0.06622908</span></span></code></pre></div>
<p><em>Is this what you expected to see?</em></p>
<p>The bootstrapped standard errors account for spatial autocorrelation in the data, whereas the <code>lm</code> standard errors are not. The effect of ignoring spatial autocorrelation tends to be to have false confidence in your results – <em>P</em>-values and standard errors too small. <em>P</em>-values were too small in Code Box 9.8, and here we see standard errors tend to be too small (although a couple are bigger). On average, they are about 25% bigger (which is less than I expected given what happened to the <em>P</em>-values).</p>
</div>
<div id="exercise-9.8-does-block-length-matter" class="section level2">
<h2>Exercise 9.8: Does block length matter?</h2>
<p><em>For Ian’s species richness data, compute standard errors using a few different block sizes (say 5km, 10km, 20km, 40km) and compare.</em></p>
<p>This will take a while to run – the first three lines will take about three times as long as the relevant line from Code Box 9.8 did :(</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bootSEall <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(bootSEs),<span class="dv">4</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>block_Ls<span class="ot">=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootSEall)<span class="ot">=</span>block_Ls</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>bootSEall[,<span class="dv">3</span>]<span class="ot">=</span>bootSEs <span class="co">#we already did block length 20 in Code Box 9.9</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iLength <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  BootIDi <span class="ot">=</span> <span class="fu">BlockBootID</span>(<span class="at">x =</span> Myrtaceae<span class="sc">$</span>X, <span class="at">y =</span> Myrtaceae<span class="sc">$</span>Y, <span class="at">block_L =</span> block_Ls[iLength],</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">nBoot =</span> <span class="dv">199</span>, <span class="at">Grid_space =</span> <span class="dv">5</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  predMat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(Myrtaceae<span class="sc">$</span>logrich),nBoot)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iBoot <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBoot)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>     ids <span class="ot">=</span> BootIDi[iBoot,]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>     ft_i <span class="ot">=</span> <span class="fu">update</span>(ft_richAdd,<span class="at">data=</span>Myrtaceae[ids,])</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>     predMat[ids,iBoot] <span class="ot">=</span> <span class="fu">predict</span>(ft_i)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  bootSEall[,iLength] <span class="ot">=</span> <span class="fu">apply</span>(predMat,<span class="dv">1</span>,sd,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bootSEall)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               5         10         20         40</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.03173174 0.03952715 0.03545110 0.03103630</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.02812293 0.03154434 0.03492126 0.03491431</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.03364645 0.03668561 0.04734406 0.04464179</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.03452097 0.03909835 0.03930774 0.04039057</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 0.07119225 0.07226783 0.06201326 0.06128535</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 0.03305668 0.04186717 0.03716947 0.03817705</span></span></code></pre></div>
<p><em>Did results change, as you changed block size?</em></p>
<p>Yep, and standard errors tend to be getting a bit bigger as block size increases</p>
<p><em>Compute the mean of the standard errors at each block size. Is there a trend?</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootSEall,<span class="dv">2</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          5         10         20         40 </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04640676 0.04989546 0.05169534 0.05116355</span></span></code></pre></div>
<p>The mean of the standard errors of predictions tends to be getting bigger as block size increases. This makes sense because increasing block size effectively reducing sample size, by reducng the number of units in the spatial domain that are considered as independent.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
