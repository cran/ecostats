<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-06-28" />

<title>Chapter 9 – Design-based inference – Exercise solutions and Code Boxes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 9 – Design-based inference –
Exercise solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-06-28</h4>



<div id="exercise-9.1-smoking-in-pregnancy" class="section level2">
<h2>Exercise 9.1: Smoking in pregnancy</h2>
<p><em>Consider again the guinea pig experiment… How can we make
inferences about the treatment effect, without assuming
normality?</em></p>
<p>Design-based inference allows us to relax distributional assumptions.
Specifically, if we use a permutation test as in Code Box 9.1, or a
bootstrap test as in Code Box 9.3, we do not assume normality.</p>
</div>
<div id="exercise-9.2-three-example-permutations-of-treatment-labels-in-the-guinea-pig-data" class="section level2">
<h2>Exercise 9.2: Three example permutations of treatment labels in the
guinea pig data</h2>
<p><em>Does the observed statistic of 2.67 seem large compared to these
values? What does this tell you?</em></p>
<p>The three statistics obtained by permuting data were 0.76, -2.09 and
-1.08. These are all smaller than 2.67, suggesting that 2.67 is
unusually large compared to what we would expect if there were no
treatment effect. However, to say something more precise about how
unusual this is we should do many more permutations…</p>
</div>
<div id="code-behind-figure-9.1" class="section level2">
<h2>Code behind Figure 9.1</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">lm</span>(errors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tObs <span class="ot">=</span> <span class="fu">summary</span>(ft_guinea)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#store observed t-statistic</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nPerm <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tStats <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,nPerm)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tStats[<span class="dv">1</span>] <span class="ot">=</span> tObs</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iPerm <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nPerm)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  guineapig<span class="sc">$</span>treatPerm <span class="ot">=</span> <span class="fu">sample</span>(guineapig<span class="sc">$</span>treatment) <span class="co">#permute treatment labels</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  ft_guineaPerm <span class="ot">=</span> <span class="fu">lm</span>(errors<span class="sc">~</span>treatPerm,<span class="at">data=</span>guineapig) <span class="co">#re-fit model</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  tStats[iPerm] <span class="ot">=</span> <span class="fu">summary</span>(ft_guineaPerm)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#store t-stat</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.2</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(tStats,<span class="at">main=</span><span class="st">&quot;Null distribution of t under permutation&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>tObs,<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#put a red line on plot for observed t-stat</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">mean</span>( tStats <span class="sc">&gt;=</span> tObs ) <span class="co">#compute P-value</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.007</span></span></code></pre></div>
</div>
<div id="code-box-9.1-a-permutation-test-for-the-guinea-pig-data-using-mvabund" class="section level2">
<h2>Code Box 9.1: A permutation test for the guinea pig data using
<code>mvabund</code></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">manylm</span>(errors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_guinea)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = errors ~ treatment, data = guineapig)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)  </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                        </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  7.134  0.012 *</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.2-permutation-test-for-a-relationship-between-latitude-and-plant-height" class="section level2">
<h2>Code Box 9.2: Permutation test for a relationship between latitude
and plant height</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(globalPlants)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ft_height <span class="ot">=</span> <span class="fu">manylm</span>(height<span class="sc">~</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_height)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = height ~ lat, data = globalPlants)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            129       1  9.271  0.006 **</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.3-using-the-mvabund-package-for-a-bootstrap-test-of-guinea-pig-data" class="section level2">
<h2>Code Box 9.3: Using the <code>mvabund</code> package for a bootstrap
test of guinea pig data</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ft_guinea <span class="ot">=</span> <span class="fu">manylm</span>(errors<span class="sc">~</span>treatment, <span class="at">data=</span>guineapig)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_guinea, <span class="at">resamp=</span><span class="st">&quot;residual&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = errors ~ treatment, data = guineapig)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)  </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                        </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  7.134  0.018 *</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual resampling.</span></span></code></pre></div>
</div>
<div id="exercise-9.3-case-resampling-in-the-guinea-pig-data" class="section level2">
<h2>Exercise 9.3: Case resampling in the guinea pig data</h2>
<p><em>We can… resample cases… Below are three examples.</em></p>
<p>C N N N C N N C N N C C N N C C N N N N 10 33 28 33 47 66 33 26 63 66
36 20 38 28 35 15 66 33 43 26</p>
<p>N N N N C N N N N N C C C C N C C C N C 33 89 34 89 35 43 38 33 23 63
10 26 11 10 43 47 10 19 66 35</p>
<p>N N C C N N N C N C N C N N N C C C C C 66 66 19 47 63 43 43 20 33 15
28 26 89 38 43 47 20 20 11 20</p>
<p><em>Count the number of Controls in each case resampled dataset. Did
you get the number you expected to?</em></p>
<p>OK so the first one has 8 Control sites, second one has 9 Control
sites, third has 10 Control sites. This is not expected in the sense
that the original study was planned with 10 Control and 10 Treatment
guinea pigs, so we have messed with the design by doing case resampling
:(</p>
</div>
<div id="exercise-9.4-global-plant-height-does-rainfall-explain-latitude-effect" class="section level2">
<h2>Exercise 9.4: Global plant height – does rainfall explain latitude
effect?</h2>
<p><em>She wants to know: Does latitude explain any variation in plant
height beyond that due to rainfall?</em></p>
<p><em>What is the model that should be fitted under the null
hypothesis? Does it include any predictor variables?</em></p>
<p>The model under the null hypothesis, as in Code Box, includes
rainfall:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ft_heightR<span class="ot">=</span><span class="fu">lm</span>(height<span class="sc">~</span>rain, <span class="at">data=</span>globalPlants)</span></code></pre></div>
<p>and we want to see if there is significant additional variation in
plant height that is explained by latitude, beyond that explained by
rainfall.</p>
</div>
<div id="code-box-9.4-residual-resampling-using-mvabund-for-exercise-9.4." class="section level2">
<h2>Code Box 9.4: Residual resampling using <code>mvabund</code> for
Exercise 9.4.</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ft_heightRL<span class="ot">=</span><span class="fu">manylm</span>(height<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_heightRL, <span class="at">resamp=</span><span class="st">&quot;perm.resid&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = height ~ rain + lat, data = globalPlants)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain           129       1 20.983  0.002 **</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            128       1  0.429  0.517   </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.5-plant-height-data-checking-assumptions" class="section level2">
<h2>Code Box 9.5: Plant height data – checking assumptions</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ft_heightRLlm <span class="ot">=</span> <span class="fu">lm</span>(height<span class="sc">~</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_heightRLlm, <span class="at">n.sim=</span><span class="dv">99</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>(Note that <code>plotenvelope</code> was run on just <code>99</code>
iterations to save on compilation time)</p>
</div>
<div id="exercise-9.5-plant-height-data-log-transformation" class="section level2">
<h2>Exercise 9.5: Plant height data – log transformation</h2>
<p>Refit the linear model to the plant height data, available as the
<code>globalPlants</code> dataset in the <code>ecostats</code> package,
using a log-transformation of the response. Use residual resampling to
test for an effect of latitude after controlling for the effect of
rainfall.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>globalPlants<span class="sc">$</span>loght <span class="ot">=</span> <span class="fu">log</span>(globalPlants<span class="sc">$</span>height)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ft_loghtRL<span class="ot">=</span><span class="fu">manylm</span>(loght<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_loghtRL, <span class="at">resamp=</span><span class="st">&quot;perm.resid&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = loght ~ rain + lat, data = globalPlants)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    130                         </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain           129       1  32.01  0.002 **</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat            128       1   9.62  0.002 **</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>ft_loghtRLlm <span class="ot">=</span> <span class="fu">lm</span>(loght<span class="sc">~</span>rain<span class="sc">+</span>lat, <span class="at">data=</span>globalPlants)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_loghtRLlm, <span class="at">n.sim=</span><span class="dv">99</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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CACyCACyCACyCACyCACyCACyCACyCACyCACydgPgIHclv5/e632S/1xF7vpVbwLfpPYDwH4ghRdpoFgJQEcRAGRpAGNxPt8IdzT+dFRPvfPb3r+dAMjnJ8bv8i7yMcbEYPpQESYbGwCzSwCmBfCHRacnLvhjpydx0794gncMzx/E4QFsACrCROm0AQL7BjA9s86f1xC1/iBcEH8EbTzy8sWjaA4WAB2h0QNG9doPADkIcgCclM8R5Sn7AHOEP8/rANAR6vabaKj9AAi1gJMamx5tAPwhwIPoHz76p9sCdASxZwq+B9o7ADXscVrA+NeP48HJLXkuyB0nHVrtOVOhfQPQA0z5/LEs0Je7r3ifzKGclAu6lZ7HrvRbGJ/uFcCt6ICnIucVmX856UcfD3wrAlH5GQ95zzcWGJ3OvY4wNYVWe/7UaJ8AxhIeR5lqHjC5HzMPGNT4cnoidixsgYyxP6l5gGga7Xa9qtFuAFyqCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACyCACy/g8FikWZ0be51AAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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2kQwAHJ+F0mIvjK3XIowB2BfaRPhYhywEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACw4gFwPop9x2//cTS8Crl8bJ7y3ctKvlnOX8wpMtFmtILiAUDF768w9WI0nfwFf+zx9FXNMi0CoPIMQNyowe/amMkEAVBJAL99IOxmiPYGGf7i/Pr39L5e/vZLnej+x6NMR2/KyAj7nDDzfBRNP9vxt9gfTZpv6pj32GTCfifLo++GuBtDozgB0FvSxQ8LICWhDlEb75+r5u0mdNM3qNv0zhj++rHNrWL3ADQA2jS8AJkJ/ZEZs0OmXIdAnAAOLG7wFly7x288KqlbB9mwhan8h7f08+snHm8EgOZOmZL7TN9X0shCGgBNxrb3Di9RnAC4WdzA2iQexIVbVfO29E6N8SUhkwC6aZjrDQAl4/UIRA1AjEsFAOFW1bzdAJChpg7ht9+1R4A2BHXS9ADIjPm+KNfcB6hHQCWHMd0jQKRTjwD2txKC2k74/lnm2U2jOwKkMs83g40oZgDNyFDpAx6VAWO/D2Chu2xDEBuGXk73/2UdNg/53TRdAN2R6Erj0pgBsFEJa4ntKIgNOsXb1NRmFHQ57XjDJofWu4wRIPXQqebwXL967KYRPa86CqIZs0PB97YoI4oaABuXs/5QzgO4s/LtrDcPYLeoZuJAYRJhvU5MVzq+4X1Am4aNS3vzAH6IeL8ddUxxAQild+uY6aLrABCxEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACwEACw/g9UlASNochKRgAAAABJRU5ErkJggg==" /><!-- --></p>
<p><em>How do results compare to the analysis without a
log-transformation?</em></p>
<p>Now the test statistics are larger and more significant (which I
guess because we can better see the signal in data when we are closer to
satisfying our assumptions).</p>
<p><em>How do results compare to what you would have got if you used
model-based inference, by applying <code>anova</code> to the
<code>lm</code> function? Is this what you expected?</em></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_loghtRLlm)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: loght</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain        1  70.761  70.761 34.1497 3.989e-08 ***</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat         1  19.934  19.934  9.6203  0.002368 ** </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 128 265.226   2.072                      </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Results are nearly identical, which is as expected, because there
weren’t any violations of distributional assumptions that might have
warranted resampling.</p>
</div>
<div id="exercise-9.6-guinea-pig-data-log-transformation" class="section level2">
<h2>Exercise 9.6: Guinea pig data – log transformation</h2>
<p><em>Log-transform number of errors and check assumptions. Does this
better satisfy assumptions than the model on untransformed
data?</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(guineapig)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>guineapig<span class="sc">$</span>logErrors <span class="ot">=</span> <span class="fu">log</span>(guineapig<span class="sc">$</span>errors)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ft_guineaLog <span class="ot">=</span> <span class="fu">lm</span>(logErrors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotenvelope</span>(ft_guineaLog, <span class="at">n.sim=</span><span class="dv">99</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(guineapig<span class="sc">$</span>logErrors,guineapig<span class="sc">$</span>treatment,sd)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; guineapig$treatment: C</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.521912</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; guineapig$treatment: N</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.445521</span></span></code></pre></div>
<p>This looks a <em>lot</em> better. Standard deviations are similar
now, no obvious non-normal trend on quantile plot.</p>
<p><em>Repeat the permutation test of Code Box 9.2 on log-transformed
data.</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ftMany_guineaLog <span class="ot">=</span> <span class="fu">manylm</span>(logErrors<span class="sc">~</span>treatment,<span class="at">data=</span>guineapig)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ftMany_guineaLog)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logErrors ~ treatment, data = guineapig)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     19                         </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatment       18       1  9.434  0.009 **</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p><em>How do results compare to the analysis without a
log-transformation? Is this what you expected to happen?</em></p>
<p>Results are similar, but the test statistic is slightly larger and
slightly more significant. This is expected because by fitting a model
for the data that is closer to satisfying assumptions, it will work
better and more clearly see any signal in the data.</p>
</div>
<div id="exercise-9.7-revisiting-linear-models-past" class="section level2">
<h2>Exercise 9.7: Revisiting linear models past</h2>
<p><em>Go back to a couple of linear models (with fixed effects terms
only) you have previously fitted, e.g. in the exercises of Chapter 4,
and reanalyse using (residual) resampling for inference.</em></p>
<div id="repeating-exercise-4.9" class="section level3">
<h3>Repeating Exercise 4.9:</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">data</span>(snowmelt)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> snowmelt<span class="sc">$</span>logFlow <span class="ot">=</span> <span class="fu">log</span>(snowmelt<span class="sc">$</span>flow)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a> snowmelt<span class="sc">$</span>logFlow[snowmelt<span class="sc">$</span>logFlow<span class="sc">==-</span><span class="cn">Inf</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a> snowReduced <span class="ot">=</span> <span class="fu">na.omit</span>(snowmelt[,<span class="fu">c</span>(<span class="st">&quot;logFlow&quot;</span>,<span class="st">&quot;snow&quot;</span>,<span class="st">&quot;elev&quot;</span>)]) <span class="co">#this line not normally needed, lm can handle NA&#39;s, but seems needed because of a weird conflict with MCMCglmm code in Chapter 11 solutions</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a> ft_logsnow <span class="ot">=</span> <span class="fu">lm</span>(logFlow<span class="sc">~</span>elev<span class="sc">+</span>snow, <span class="at">data=</span>snowReduced)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">plotenvelope</span>(ft_logsnow, <span class="at">n.sim=</span><span class="dv">99</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(ft_logsnow)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = logFlow ~ elev + snow, data = snowReduced)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.90161 -0.15794  0.02338  0.15834  1.08662 </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.8805208  0.3193019  12.153  &lt; 2e-16 ***</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev         0.0003357  0.0001226   2.739  0.00651 ** </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        -0.0103172  0.0007551 -13.663  &lt; 2e-16 ***</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2909 on 316 degrees of freedom</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3774, Adjusted R-squared:  0.3735 </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 95.78 on 2 and 316 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">confint</span>(ft_logsnow)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     2.5 %        97.5 %</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.252294e+00  4.5087472418</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev         9.457986e-05  0.0005768232</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        -1.180299e-02 -0.0088315037</span></span></code></pre></div>
<p>Repeating using resampling:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mft_logsnow <span class="ot">=</span> <span class="fu">manylm</span>(logFlow<span class="sc">~</span>elev<span class="sc">+</span>snow, <span class="at">data=</span>snowReduced)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mft_logsnow)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             F value Pr(&gt;F)    </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 147.699  0.001 ***</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elev          7.503  0.007 ** </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; snow        186.668  0.001 ***</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: with 999 resampling iterations using residual resampling and response assumed to be uncorrelated </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hooper&#39;s R-squared: 0.3774 </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lawley-Hotelling trace statistic:  95.78, p-value: 0.001 </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: with 999 resampling iterations using residual resampling and response assumed to be uncorrelated</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mft_logsnow)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             2.5 %        97.5 %</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:(Intercept)  3.252294e+00  4.5087472418</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:elev         9.457986e-05  0.0005768232</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logFlow:snow        -1.180299e-02 -0.0088315037</span></span></code></pre></div>
<p><em>Did results work out differently? Is this what you expected?
(Think about sample size and the normality assumption.)</em></p>
<p><em>P</em>-values are pretty much the same, which is expected,
because we didn’t have concerns about normality and the sample size was
big enough for CLT to deal with such concerns anyway.</p>
<p>The confidence intervals are identical, because they are computed in
the same way irrespective of resampling.</p>
</div>
<div id="now-repeating-exercise-4.10" class="section level3">
<h3>Now repeating Exercise 4.10:</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aphidsBACI)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lm_aphids <span class="ot">=</span> <span class="fu">lm</span>(logcount<span class="sc">~</span>Plot<span class="sc">+</span>Time<span class="sc">+</span>Treatment<span class="sc">:</span>Time,<span class="at">data=</span>aphidsBACI)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_aphids)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: logcount</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plot            7 0.8986  0.1284  0.4603 0.833357   </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time            1 5.4675  5.4675 19.6038 0.004434 **</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Treatment  1 0.7397  0.7397  2.6522 0.154527   </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals       6 1.6734  0.2789                    </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mlm_aphids <span class="ot">=</span> <span class="fu">manylm</span>(logcount<span class="sc">~</span>Plot<span class="sc">+</span>Time<span class="sc">+</span>Treatment<span class="sc">:</span>Time,<span class="at">data=</span>aphidsBACI)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mlm_aphids)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logcount ~ Plot + Time + Treatment:Time, data = aphidsBACI)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Res.Df Df.diff val(F) Pr(&gt;F)   </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        15                         </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Plot                8       7  0.130  0.992   </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time                7       1 15.860  0.010 **</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time:Treatment      6       2  1.105  0.144   </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p>This looks fairly similar, the test statistic is a bit different (but
equivalent) and significance levels generally similar. There is slightly
more movement in <em>P</em>-values than last time, which may be related
to the sample size being smaller (in fact the residual degrees of
freedom is only <code>6</code>.)</p>
</div>
</div>
<div id="code-box-9.6-block-resampling-using-mvabund-for-estuary-data" class="section level2">
<h2>Code Box 9.6: Block resampling using <code>mvabund</code> for
estuary data</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(estuaries)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  ft_estLM <span class="ot">=</span> <span class="fu">manylm</span>(Total<span class="sc">~</span>Mod,<span class="at">data=</span>estuaries)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(ft_estLM,<span class="at">resamp=</span><span class="st">&quot;case&quot;</span>,<span class="at">block=</span>estuaries<span class="sc">$</span>Estuary)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = Total ~ Mod, data = estuaries)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     41                      </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mod             40       1  9.916  0.472</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via case block resampling.</span></span></code></pre></div>
</div>
<div id="code-box-9.7-block-resampling-using-permute-for-raven-data" class="section level2">
<h2>Code Box 9.7: Block resampling using <code>permute</code> for raven
data</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ravens)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>crowGun <span class="ot">=</span> ravens[ravens<span class="sc">$</span>treatment <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>crowLong <span class="ot">=</span> <span class="fu">melt</span>(crowGun,<span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">&quot;Before&quot;</span>,<span class="st">&quot;After&quot;</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable.name=</span><span class="st">&quot;time&quot;</span>,<span class="at">value.name=</span><span class="st">&quot;ravens&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(permute)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>CTRL <span class="ot">=</span> <span class="fu">how</span>(<span class="at">blocks=</span>crowLong<span class="sc">$</span>site)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>permIDs <span class="ot">=</span> <span class="fu">shuffleSet</span>(<span class="dv">24</span>,<span class="at">nset=</span><span class="dv">999</span>,<span class="at">control=</span>CTRL)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Set of permutations &lt; &#39;minperm&#39;. Generating entire set.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ravenlm <span class="ot">=</span> <span class="fu">manylm</span>(ravens<span class="sc">~</span>site<span class="sc">+</span>time,<span class="at">data=</span>crowLong)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ravenlm,<span class="at">bootID=</span>permIDs)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using &lt;int&gt; bootID matrix from input.</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = ravens ~ site + time, data = crowLong)</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff val(F) Pr(&gt;F)  </span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     23                        </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site            12      11   3.27  0.991  </span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time            11       1   6.76  0.030 *</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 999 iterations via residual (without replacement) resampling.</span></span></code></pre></div>
<p><em>How do results compare to what we got previously (Code Box 4.2),
using model-based inference?</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ravenlm <span class="ot">=</span> <span class="fu">lm</span>(ravens<span class="sc">~</span>site<span class="sc">+</span>time,<span class="at">data=</span>crowLong)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ravenlm)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: ravens</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site      11 55.458  5.0417    4.84 0.007294 **</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time       1  7.042  7.0417    6.76 0.024694 * </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 11 11.458  1.0417                    </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We are getting almost the same <em>P</em>-value for the
<code>time</code> effect. Interestingly, we get a very different
<em>P</em>-value for the <code>site</code> effect. This is because the
resampling strategy we used permuted data within sites but did not
permute data across sites – this does not give a valid test for a
<code>site</code> effect, hence the site <em>P</em>-value from the
permutation test is not valid.</p>
</div>
<div id="code-box-9.8-moving-block-bootstrap-test-for-species-richness-modelling" class="section level2">
<h2>Code Box 9.8: Moving block bootstrap test for species richness
modelling</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Myrtaceae)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a lm:</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Myrtaceae<span class="sc">$</span>logrich<span class="ot">=</span><span class="fu">log</span>(Myrtaceae<span class="sc">$</span>richness<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mft_richAdd <span class="ot">=</span> <span class="fu">manylm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data=</span>Myrtaceae)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a boot ID matrix: </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>BootID <span class="ot">=</span> <span class="fu">BlockBootID</span>(<span class="at">x =</span> Myrtaceae<span class="sc">$</span>X, <span class="at">y =</span> Myrtaceae<span class="sc">$</span>Y, <span class="at">block_L =</span> <span class="dv">20</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">nBoot =</span> <span class="dv">99</span>, <span class="at">Grid_space =</span> <span class="dv">5</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mft_richAdd,<span class="at">resamp=</span><span class="st">&quot;case&quot;</span>,<span class="at">bootID=</span>BootID)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using &lt;int&gt; bootID matrix from input.</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: manylm(formula = logrich ~ soil + poly(TMP_MAX, degree = 2) + </span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:     poly(TMP_MIN, degree = 2) + poly(RAIN_ANN, degree = 2), data = Myrtaceae)</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Overall test for all response variables</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                            Res.Df Df.diff val(F) Pr(&gt;F)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                   999                      </span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; soil                          991       8 11.971   0.71</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MAX, degree = 2)     989       2 18.244   0.47</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MIN, degree = 2)     987       2 17.533   0.59</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(RAIN_ANN, degree = 2)    985       2  8.208   1.00</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments: P-value calculated using 99 iterations via case resampling.</span></span></code></pre></div>
<p>(Note that <code>BlockBootID</code> was set to only generate
<code>99</code> bootstrap samples to save on compilation time, but you
should use more in practice.)</p>
<p><em>How does this compare to what you would get if you just used
model-based inference, using the <code>lm</code> function?</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data=</span>Myrtaceae)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ft_richAdd)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: logrich</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; soil                         8  15.075 1.88438 12.9887 &lt; 2.2e-16 ***</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MAX, degree = 2)    2   5.551 2.77533 19.1299 7.068e-09 ***</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(TMP_MIN, degree = 2)    2   5.162 2.58082 17.7892 2.573e-08 ***</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; poly(RAIN_ANN, degree = 2)   2   2.382 1.19081  8.2081 0.0002915 ***</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals                  985 142.902 0.14508                      </span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Everything is highly significant here, but much less so when using
the moving block bootstrap. This is probably partly because the data are
spatially autocorrelated, so we are seeing false significance in the
<code>lm</code> results because dependence of observations hasn’t been
accounted for. But the difference in results is quite extreme (when
considering that the spatial signal wasn’t super-strong) so the moving
block bootstrap maybe is being overly conservative here too.</p>
</div>
<div id="code-box-9.9-moving-block-bootstrap-standard-errors-for-species-richness-predictions" class="section level2">
<h2>Code Box 9.9: Moving block bootstrap standard errors for species
richness predictions</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ft_richAdd <span class="ot">=</span> <span class="fu">lm</span>(logrich<span class="sc">~</span>soil<span class="sc">+</span><span class="fu">poly</span>(TMP_MAX,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">poly</span>(TMP_MIN,<span class="at">degree=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">poly</span>(RAIN_ANN,<span class="at">degree=</span><span class="dv">2</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>Myrtaceae)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>nBoot<span class="ot">=</span><span class="fu">nrow</span>(BootID)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>predMat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(Myrtaceae<span class="sc">$</span>logrich),nBoot)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iBoot <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBoot)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>   ids <span class="ot">=</span> BootID[iBoot,]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>   ft_i <span class="ot">=</span> <span class="fu">update</span>(ft_richAdd,<span class="at">data=</span>Myrtaceae[ids,])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>   predMat[ids,iBoot] <span class="ot">=</span> <span class="fu">predict</span>(ft_i)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>bootSEs <span class="ot">=</span> <span class="fu">apply</span>(predMat,<span class="dv">1</span>,sd,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>lmSEs   <span class="ot">=</span> <span class="fu">predict</span>(ft_richAdd,<span class="at">se.fit=</span><span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(bootSEs,lmSEs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          bootSEs      lmSEs</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.03152389 0.02982530</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.02993415 0.02396074</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.04238514 0.02853756</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.04661133 0.03348368</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.08746989 0.06279115</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.04005716 0.03413518</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.05159404 0.02808283</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.07580326 0.08272950</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.03578126 0.02759009</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.06250810 0.06622908</span></span></code></pre></div>
<p><em>Is this what you expected to see?</em></p>
<p>The bootstrapped standard errors account for spatial autocorrelation
in the data, whereas the <code>lm</code> standard errors are not. The
effect of ignoring spatial autocorrelation tends to be to have false
confidence in your results – <em>P</em>-values and standard errors too
small. <em>P</em>-values were too small in Code Box 9.8, and here we see
standard errors tend to be too small (although a couple are bigger). On
average, they are about 25% bigger (which is less than I expected given
what happened to the <em>P</em>-values).</p>
</div>
<div id="exercise-9.8-does-block-length-matter" class="section level2">
<h2>Exercise 9.8: Does block length matter?</h2>
<p><em>For Ian’s species richness data, compute standard errors using a
few different block sizes (say 5km, 10km, 20km, 40km) and
compare.</em></p>
<p>This will take a while to run – the first three lines will take about
three times as long as the relevant line from Code Box 9.8 did :(</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bootSEall <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(bootSEs),<span class="dv">4</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>block_Ls<span class="ot">=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootSEall)<span class="ot">=</span>block_Ls</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>bootSEall[,<span class="dv">3</span>]<span class="ot">=</span>bootSEs <span class="co">#we already did block length 20 in Code Box 9.9</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iLength <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  BootIDi <span class="ot">=</span> <span class="fu">BlockBootID</span>(<span class="at">x =</span> Myrtaceae<span class="sc">$</span>X, <span class="at">y =</span> Myrtaceae<span class="sc">$</span>Y, <span class="at">block_L =</span> block_Ls[iLength],</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">nBoot =</span> <span class="dv">99</span>, <span class="at">Grid_space =</span> <span class="dv">5</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  predMat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(Myrtaceae<span class="sc">$</span>logrich),nBoot)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iBoot <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBoot)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>     ids <span class="ot">=</span> BootIDi[iBoot,]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>     ft_i <span class="ot">=</span> <span class="fu">update</span>(ft_richAdd,<span class="at">data=</span>Myrtaceae[ids,])</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>     predMat[ids,iBoot] <span class="ot">=</span> <span class="fu">predict</span>(ft_i)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  bootSEall[,iLength] <span class="ot">=</span> <span class="fu">apply</span>(predMat,<span class="dv">1</span>,sd,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bootSEall)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               5         10         20         40</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.03048602 0.03276710 0.03152389 0.03495241</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.02850127 0.02969617 0.02993415 0.03136841</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.04047950 0.04235224 0.04238514 0.05103744</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.03678850 0.04673142 0.04661133 0.04693045</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 0.06438874 0.06782334 0.08746989 0.05099318</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 0.03932153 0.04055227 0.04005716 0.03551344</span></span></code></pre></div>
<p><em>Did results change, as you changed block size?</em></p>
<p>Yep, and standard errors tend to be getting a bit bigger as block
size increases</p>
<p><em>Compute the mean of the standard errors at each block size. Is
there a trend?</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootSEall,<span class="dv">2</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          5         10         20         40 </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04572603 0.04822235 0.05215440 0.05211808</span></span></code></pre></div>
<p>The mean of the standard errors of predictions tends to be getting
bigger as block size increases. This makes sense because increasing
block size effectively reducing sample size, by reducng the number of
units in the spatial domain that are considered as independent.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
