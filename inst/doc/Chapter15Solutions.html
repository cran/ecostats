<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Warton" />

<meta name="date" content="2022-05-30" />

<title>Chapter 15 – Predicting multivariate abundances – Exercise solutions and Code Boxes</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Chapter 15 – Predicting multivariate abundances – Exercise solutions and Code Boxes</h1>
<h4 class="author">David Warton</h4>
<h4 class="date">2022-05-30</h4>



<div id="exercise-15.1-predicting-fish-communities-at-wind-farms" class="section level2">
<h2>Exercise 15.1: Predicting fish communities at wind farms?</h2>
<p><em>Consider again Lena’s wind farm study (Exericise 14.3). She would like to predict what fish occur where. What type of model should she use, to get the best predictions?</em></p>
<p>The focus here is prediction so she should be using some model designed to have good predictive performance. One thing that might help is putting random effects on terms, that take different values for different species, to borrow strength across species.</p>
</div>
<div id="exercise-15.2-which-environmental-variables-predict-hunting-spider-communities" class="section level2">
<h2>Exercise 15.2: Which environmental variables predict hunting spider communities?</h2>
<p><em>Petrus set up 28 pitfall traps on sand dunes, in different environmental conditions (in the open, under shrubs, etc) and classified all hunting spiders that fell into the trap to species. He measured six environmental variables characterising each site. He would like to know: Which environmental variables best predict hunting spider communities?</em></p>
<p><em>What analysis approach should he use?</em></p>
<p>This is a variable selection problem, he should be using multivariate model selection techniques. One approach is to construct models designed to be pretty good for prediction, and choose the one with best predictive performance. For example, he could fit mixed models, with random effects for different species, and use cross-validation to see which set of predictors gives the model has best predictive performance.</p>
</div>
<div id="code-box-15.1-predictive-likelihood-for-the-wind-farm-data" class="section level2">
<h2>Code Box 15.1: Predictive likelihood for the wind farm data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecostats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(windFarms)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>) <span class="co"># use this seed to get the same results as below:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>nStations <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>isTestStn <span class="ot">=</span> <span class="fu">sample</span>(nStations,nStations<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windFarms<span class="sc">$</span>X<span class="sc">$</span>Station <span class="sc">%in%</span> <span class="fu">levels</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>windMV <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>windFt_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>windFt_Int_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>prWind_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Train,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>prWind_Int_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_Train, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>predLogL <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>predLogL_Int <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Int_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogL),<span class="fu">sum</span>(predLogL_Int))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -931.5643 -928.3885</span></span></code></pre></div>
<p><em>What do these results tell us about which model is preferred?</em></p>
<p>These results suggest the main effect model is better.</p>
</div>
<div id="exercise-15.3-cross-validation-for-wind-farm-data-and-rare-species" class="section level2">
<h2>Exercise 15.3: Cross-validation for wind farm data and rare species</h2>
<p><em>Repeat the analyses of Code Box 15.1 but after removing rare species (observed less than 10 times), using the following code:</em></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>notRare<span class="ot">=</span><span class="fu">colSums</span>(windMV<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">&gt;</span><span class="dv">10</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>windMVnotRare<span class="ot">=</span><span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund[,notRare])</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>windFt_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>windFt_Int_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>prWind_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_TrainRare,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>prWind_Int_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_TrainRare, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>predLogLRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>predLogL_IntRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_Int_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogLRare),<span class="fu">sum</span>(predLogL_IntRare))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -781.0415 -788.9616</span></span></code></pre></div>
<p><em>Did you get a similar answer?</em></p>
<p>Nope – now the model with an interaction term looks better!</p>
<p><em>Note that so far we have only considered one test sample, and there is randomness in the choice of training/test split. Repeat the analyses of Code Box 15.1 as well as those you have done here, with and without rare species, multiple times (which is a form of cross-validation).</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># use this seed to get the same results as below:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nStations <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>isTestStn <span class="ot">=</span> <span class="fu">sample</span>(nStations,nStations<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windFarms<span class="sc">$</span>X<span class="sc">$</span>Station <span class="sc">%in%</span> <span class="fu">levels</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>windFt_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>windFt_Int_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>prWind_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Train,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>prWind_Int_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_Train, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>predLogL <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>predLogL_Int <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Int_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogL),<span class="fu">sum</span>(predLogL_Int))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -915.8434 -970.8314</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>windFt_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>windFt_Int_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>prWind_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_TrainRare,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>prWind_Int_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_TrainRare, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>predLogLRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>predLogL_IntRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_Int_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogLRare),<span class="fu">sum</span>(predLogL_IntRare))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -734.4901 -780.1963</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>) <span class="co"># use this seed to get the same results as below:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nStations <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>isTestStn <span class="ot">=</span> <span class="fu">sample</span>(nStations,nStations<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windFarms<span class="sc">$</span>X<span class="sc">$</span>Station <span class="sc">%in%</span> <span class="fu">levels</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>windMV <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>windFt_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>windFt_Int_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>prWind_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Train,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>prWind_Int_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_Train, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>predLogL <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>predLogL_Int <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Int_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogL),<span class="fu">sum</span>(predLogL_Int))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -886.4941 -992.3476</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>windFt_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>windFt_Int_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>prWind_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_TrainRare,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>prWind_Int_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_TrainRare, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>predLogLRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>predLogL_IntRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_Int_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogLRare),<span class="fu">sum</span>(predLogL_IntRare))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -756.8341 -865.5058</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># use this seed to get the same results as below:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nStations <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>isTestStn <span class="ot">=</span> <span class="fu">sample</span>(nStations,nStations<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windFarms<span class="sc">$</span>X<span class="sc">$</span>Station <span class="sc">%in%</span> <span class="fu">levels</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>windMV <span class="ot">=</span> <span class="fu">mvabund</span>(windFarms<span class="sc">$</span>abund)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>windFt_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>windFt_Int_Train<span class="ot">=</span><span class="fu">manyglm</span>(windMV[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>prWind_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Train,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>prWind_Int_Test <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_Train, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>predLogL <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>predLogL_Int <span class="ot">=</span> <span class="fu">dpois</span>(windMV[isTest,],<span class="at">lambda=</span>prWind_Int_Test,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogL),<span class="fu">sum</span>(predLogL_Int))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -830.5662 -832.3659</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>windFt_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">+</span>Zone,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>windFt_Int_TrainRare<span class="ot">=</span><span class="fu">manyglm</span>(windMVnotRare[isTest<span class="sc">==</span><span class="cn">FALSE</span>,]<span class="sc">~</span>Year<span class="sc">*</span>Zone,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>windFarms<span class="sc">$</span>X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,],<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>prWind_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_TrainRare,<span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>prWind_Int_TestRare <span class="ot">=</span> <span class="fu">predict.manyglm</span>(windFt_Int_TrainRare, <span class="at">newdata=</span>windFarms<span class="sc">$</span>X[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>predLogLRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>predLogL_IntRare <span class="ot">=</span> <span class="fu">dpois</span>(windMVnotRare[isTest,],<span class="at">lambda=</span>prWind_Int_TestRare,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogLRare),<span class="fu">sum</span>(predLogL_IntRare))</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -734.7738 -738.2911</span></span></code></pre></div>
<p><em>Which set of results tends to be more reliable (less variable) – the ones with or without the rare species? Why do you think this happened?</em></p>
<p>Without the rare species, the results are more reliable, with predictive likelihood usually in the mid -700’s, and the interaction model consistently performing better (although sometimes narrowly so). With rare species, it bounces around a lot more, with the smaller model (main effects only) sometimes having better predictive performance. This is likely because rare species with all absences in one treatment combination can blow up the predictive likelihood (if they are predicted to have a mean of zero, but have some non-zero cases in test data).</p>
</div>
<div id="code-box-15.2-fitting-a-mixed-model-to-the-wind-farm-data" class="section level2">
<h2>Code Box 15.2: Fitting a mixed model to the wind farm data</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>windComp <span class="ot">=</span> <span class="fu">manyglm</span>(windMV<span class="sc">~</span>Zone<span class="sc">*</span>Year,<span class="at">data=</span>windFarms<span class="sc">$</span>X,<span class="at">composition=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>wind_glmm <span class="ot">=</span> <span class="fu">glmmTMB</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone<span class="sc">+</span><span class="fu">diag</span>(Year<span class="sc">*</span>Zone<span class="sc">|</span>cols),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">family=</span><span class="fu">poisson</span>(), <span class="at">data=</span>windComp<span class="sc">$</span>data)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wind_glmm)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: poisson  ( log )</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:          windMV ~ Year * Zone + diag(Year * Zone | cols)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: windComp$data</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   3259.9   3331.4  -1617.9   3235.9     2852 </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional model:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups Name           Variance Std.Dev. Corr                     </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  cols   (Intercept)    5.3421   2.3113                            </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Year2010       1.6302   1.2768   0.00                     </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         ZoneN          0.6807   0.8251   0.00 0.00                </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         ZoneS          3.9012   1.9751   0.00 0.00 0.00           </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Year2010:ZoneN 0.8519   0.9230   0.00 0.00 0.00 0.00      </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Year2010:ZoneS 0.3777   0.6146   0.00 0.00 0.00 0.00 0.00 </span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 2864, groups:  cols, 16</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional model:</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    -3.18913    0.65414  -4.875 1.09e-06 ***</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Year2010       -0.26989    0.45008  -0.600    0.549    </span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ZoneN          -0.15541    0.35209  -0.441    0.659    </span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ZoneS          -0.16619    0.61670  -0.269    0.788    </span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Year2010:ZoneN  0.08998    0.41305   0.218    0.828    </span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Year2010:ZoneS  0.56211    0.37247   1.509    0.131    </span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="exercise-15.4-predictive-likelihood-for-wind-farm-mixed-model" class="section level2">
<h2>Exercise 15.4: Predictive likelihood for wind farm mixed model</h2>
<p><em>Calculate the predictive likelihood for the mixed model fitted to the wind farm data (Code Box 15.2), following the method in Code Box 15.1.</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windComp<span class="sc">$</span>data<span class="sc">$</span>Station <span class="sc">%in%</span> <span class="fu">levels</span>(windComp<span class="sc">$</span>data<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>wind_glmm <span class="ot">=</span> <span class="fu">glmmTMB</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone<span class="sc">+</span><span class="fu">diag</span>(Year<span class="sc">*</span>Zone<span class="sc">|</span>cols),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">poisson</span>(), <span class="at">data=</span>windComp<span class="sc">$</span>data[isTest<span class="sc">==</span><span class="cn">FALSE</span>,])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>prGLMM_Test <span class="ot">=</span> <span class="fu">predict</span>(wind_glmm, <span class="at">newdata=</span>windComp<span class="sc">$</span>data[isTest<span class="sc">==</span><span class="cn">TRUE</span>,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>predGLMM <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(windComp<span class="sc">$</span>data<span class="sc">$</span>windMV[isTest<span class="sc">==</span><span class="cn">TRUE</span>],<span class="at">lambda=</span>prGLMM_Test,<span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(predGLMM,<span class="fu">sum</span>(predLogL))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -744.1239 -830.5662</span></span></code></pre></div>
<p><em>Did this have better predictive performance? Why do you think this happened?</em></p>
<p>This did waaaay better than <code>manyglm</code>. Probably because it was borrowing strength across species to better predict rare ones, not overfitting quite as badly.</p>
</div>
<div id="code-box-15.3-fitting-a-lasso-to-the-wind-farm-data-via-glmnet" class="section level2">
<h2>Code Box 15.3: Fitting a LASSO to the wind farm data via glmnet</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loaded glmnet 4.1-4</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone<span class="sc">*</span>cols,<span class="at">data=</span>windComp<span class="sc">$</span>data)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> windComp<span class="sc">$</span>data<span class="sc">$</span>windMV</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>windLasso <span class="ot">=</span> <span class="fu">glmnet</span>(X,y, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>isTest <span class="ot">=</span> windComp<span class="sc">$</span>data<span class="sc">$</span>Station <span class="sc">%in%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(windComp<span class="sc">$</span>data<span class="sc">$</span>Station)[isTestStn]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>windLassoTrain <span class="ot">=</span> <span class="fu">glmnet</span>(X[isTest<span class="sc">==</span><span class="cn">FALSE</span>,], y[isTest<span class="sc">==</span><span class="cn">FALSE</span>], <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>prLassoTest <span class="ot">=</span> <span class="fu">predict</span>(windLassoTrain,X[isTest,],<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>predLLlasso<span class="ot">=</span><span class="fu">colSums</span>(<span class="fu">dpois</span>(windComp<span class="sc">$</span>data<span class="sc">$</span>windMV[isTest],prLassoTest,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(windLassoTrain<span class="sc">$</span>lambda,predLLlasso,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">log=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAdVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OpA6kLY6kNtmAABmADpmOpBmZgBmZmZmkJBmtrZmtv+QOgCQZgCQkGaQtpCQ2/+2ZgC2kDq225C2/7a2///bkDrb25Db/7bb////tmb/25D//7b//9v///96EQbGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANTElEQVR4nO2dgXqjuBVGPdM4O609026TbkPbYSeO4/d/xAICDHGMDf+VQOKc79skHVNdrHsspGtbbE4AApu5TwDiBoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAwligDSTCXALZNgdzgUAggUAggUAggUAggUAggUAgEa9Ay6hurJ7FCLSwFKPVnSxGoCjAqAsQSAKREMiE9Q5JCGTL6iRCIHtWNRQhkCfWck1DIM+kLhECBSDloQiBQpGoRJ4Een92M4CvP02aS4UEJ0Z+BMo3O/fHoflDai45EiobeRHo/bnVJn94lZtLmPgl8iLQcf/U/Hm4chGLvNssiXs4YgRaDlGK5GsOVA9BzIEmENWQ5GkVdty7Lrgy/iDQXcQgEnWgCFiyRQgUCwuViEJiTCxQIgqJsbGw6xnL+ChZjkQUEqNlGQ4xAsXMAhSikBg3sytEITF2ZlaIOlD8zDoZQqAkmE8hComJMJdCgQuJfKvcH/N0Kcv4dJjlVUkhMSVm6FVGoKQI360UEtMi+GWMQmJqBO5Z6kDJEbZrESg9gl7GEChFAvYuAiVJuO71VAc6V5ypA81CsMuYnxHo/fnqm2BTmoMJBFLI25upW8vmYApB+tjXHOiweRp8HIECEGIQYhKdNP67GYHSxns/+xSo856qRXMwBe93pTE/8AwCLQK/XY1A6eN1EEKgNeBRIQRaB976m1XYSvDV4Qi0Fjz1+BSB3h43m82XlzBxwQo/XT5BIPc55/zGexVWccEML30+XqBmanzt+xbGccEOH50+XqDmS1/XvvFlHBcM8dDrjEBrYhECMQeKGPtuZxW2Lsz7nTrQyrDueARaG3Ml8nzgcb8rZkDXv7VsGxesse36CQJlD69vj9tTduNj80ZxwRzTvp9WByo/Mk8dKFosO3+aQFkhT45A0WL4+aApl7Dtcf/wetxzCYsYs/6fNInefHm5+c1Bq7jgB6sEsIxfK0YZQKDVYpMCT3UgNhpfPrMJdEcdiDsWxoBJDrzUgdjmNw4skuClDsRG45FgkAUvdSBGoEiYR6A76kBsNB4Jeho8LePZaDwOFitQ6OZgInIepl3Chms8pnHBK3MIlD285tvT2+PQh+opJMaCmogpy/jd6VDMbYa+1kMhMR7ETEyrA719+1n9dwWW8TGhfTho2hcLj99fhgSikBgXSjImzIHKEnS2G7qEMQJFhpCNKcv4bFuuxIYWYRQSI2N6OigkQsnkfFBIhBIEAo2pCRkp0B13Aju5UlE5/6GQGBETM+JlBKoEqtZfnQW9a6VlRHMQhGkp8SZQrQ7L+GgILdDAR1pLger3yigkxsOknHgTiBEoPqYkxZNA5Sxne2qm00pcCMdiBDrVn3u9XohGoEUyISu+BDKLCwFBINAYnxYvhUTLuBAS7wKZgUCLZCEC3TFOIdAyGZ0XP3Og9+db1zcEWiYLEeh0cwMzBFooYxPjaxV2uHErDQRaKEsRyCwuhAWBQGNkZnwKxG2/Y8SvQKMKiQgUJeNS47OQiEBxMurjoggEl4zIDpcw+IT70zNhBHIf8jlo97xEoGVjf2XqbK7giszctTlp7k3QtO1dSqgDJY0/gZqZTcYIlDR3ZmjSHKgcgnLmQIlzX4qmTJaqpZh2z10EioC7csQnEuEaCAQa9yRp4iXs4TW7XiQc2RwsljuyNGUS/eUlL2+2IhmEQDHgRaByGV8WEbnt9wq4naZphcRSIAqJK8CHQM0IRCFxDdzM0+Q5UH7jU/NWcWFWfAjkColaIRqBYuFWoqgDwSD2Ag19TOx+ECgWbmRq+sc5NBAoFswFEtfvY+PC3AynasoIxP5Aq8JaoLvglpfpMIdA3PIyJQZz5eUDZdxwLimsBXJf6Bn6SCu3vEyLoWRNqQM5OwbeC2MESgtbgcob7pYMrea55WVS+BmBBr9YyC0vk2IgW9O/1sO78evBVCCbvcYRKCqup4tCItxBaIEoJKbG1Xx5EYhlfHKEFYhCYnIwAoFEWIEoJKbHtYR5WoVRSEyNwAKFbg58g0AgEVggConJcSVjgQuJ53dBxjQHCyCkQCzjEySkQBQSE4QRCCQCz4EoJCbH5ymjkAh3ElSg0M2BfxAIJIIKlBeXr2oadG0rTgSKj09z5mkS/eWlmAaVt4VCoHQIJ5Bbxr8/D2wGjEDxEU6gppCYPbwiUDqEHoEKsi0CpUPIOVCtzXF/7f14BIqPgAK1pej3ZwRKhpAChW4OQvBZ0nwKxH3jEwOBQAKBQAKBQAKBQCK0QAGbgxAgEEggEGh8kjUEgvtBIJBAIJBAIJBAIJBAIJBAIJBAINC4TBsCwQgQCCQQCCQQCCQQCCQQCCQQCCQQCDQu8oZAMAYEAgkEAgkEAgkEAlsQCCQQCCQQCCQQCCQQCCQQCCRmEwgSYSaBPDU5cyAieW/Gc5MzByKS92Y8NzlzICJ5b8ZzkzMHIpL3Zjw3OXMgInlvxnOTMwcikvdmPDc5cyAieW/Gc5MzByKS92Y8NzlzICJ5bwbWCgKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBhC7Q27efl/942Gy+vNR/Zw+vcpDbgfJORK+R3p83m831+1YbRrr2uFWcXqzDxP6TBTruv16e26E4l0N9PoeNjUDDgfLiwYORQYOR3p+LH/lm6z/Stcet4vRidTM2ClWgQtzLc3N3ls+qTj7ubQQaDnTc78r/ZZLW4Uhvj08n56vvSFcet4rTi9XN2DhEgQ6b3cGdW94Z2LudnD/8y0Kg24GsBLonks1gdyvS+XH7OG+/vXRjTX9Z6HMgd2550aNvj3UnuLOrHij+tJoDDQeqHwoT6ZTZXFpuRjIR6LM4tUBNrA9PbwRGAlWXkPYE3OvTzRh2ZpPowUDVOG01tb0RqXpNh4lkKlA3Tm1ME6v/9MZgJJAL7QbCbh/khTymAl0LVPL+HCjSwWgOfUckS4HaOG+PbgOFpwUJVO/p4PqgPzLaCvR5oPoIo2vYjUhm48/t52QrUCfO0i5hbeqqaVo7Jct7XeMxkPu35kXsN1Ju58/N5+RhBHIsbRJ93HdT118UGs+BPg3kOsB4xvD5U8ptXg53RDp5fEZOoPmX8c25uRVQ1ijeK0vZr8I+CVQGcb3gOVK7WvIe6fy4nzi9WLMVEtvnWA6/52ebe3grYzhQZnWlvBGpvipbzrYGOs9WoA9xerGmvhXEm6kggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUCmHH/YfI07HlYjUH8LjJJyL4G7v7d/3Nc71Xz4snq/2cztQXgZq+bD/jNW+xnNyWoEumSUQCVuS5QBsq//+/Fn4QgCrQJzgQo9iktY0SQCJUK17++h3PUle/i1L0eGf+7dJjDlZiZ/9ARqtoep9g98Ov+uNobrbo17/P5HeR2rjz92mnUCnepLWNa0Uz64K5srj/j9sW6tOQPTfWlmIGmBqj0+y13l3593LtPlvp+lN9UuzF2Bqr3Hqv2jnirnmt/Vf8d9tXVXLdC+/P80x3ebLR751Qp0brDa2b4IWO0k12xRdT6DreH+xDOQtkDVVeofD69F6l2md/UupeVLPusIdPz+4i4w7Wa77eblu1O7v2kt0K5zfLfZatTaVoc8tQdUutQ/ntz2Zu2ehMUZtMfFStoCVZn897efhQ4u0+6iU2+2+mEOdNhUg40zp/ntclv/rAV66h1/bvbkFmu75pBDfV07tT/qrRy/vJzPoDkuVtIW6JTt3v766/tLdTeNc6bzS4GKKcnX/5bprW7Gc/7tUu6M6ArUHP9RoGIS7WRtDugL1Gyuez6DNnCkJC5Q/vCf7Sn723M/05cj0DnNJc0+lMXvKyNQe/ylQO5y2R5wYwTqB46QxAV6+/b33Sn/y28vvUzXuyJ3BKo34q7z2Fylit+fzYGeOsf3vCymND9ey5+1o4fLS1g1ByomZc0Z9ANHSOICVQuk6o5lvaEir/71wwhUzF927Z63571vL1dhT53ju81Wq7Bf+23jaHXAB4HqFtszaI+LlcQFqpbL1eu+f61p60Du/Ymd2+U2q7Lq9rttfl/WgZo5UHV8r9lq3rStHa0P+CDQ74/1jLk5gzZwpKQuUGB4MxVgFAgEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEv8Hu70h3jqV0e0AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>isBestLambda <span class="ot">=</span> <span class="fu">which</span>(predLLlasso<span class="sc">==</span><span class="fu">max</span>(predLLlasso))</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(windLasso<span class="sc">$</span>lambda,<span class="fu">t</span>(windLasso<span class="sc">$</span>beta),<span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">log=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(windLasso<span class="sc">$</span>lambda,<span class="fu">t</span>(windLasso<span class="sc">$</span>beta))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-box-15.4-fitting-a-group-lasso-to-the-wind-farm-data" class="section level2">
<h2>Code Box 15.4: Fitting a group-LASSO to the wind farm data</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grplasso)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>windLambdaTrain <span class="ot">=</span> <span class="fu">lambdamax</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone<span class="sc">*</span>cols, <span class="at">data=</span>windComp<span class="sc">$</span>data,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset=</span>isTest<span class="sc">==</span><span class="cn">FALSE</span>, <span class="at">model =</span> <span class="fu">PoissReg</span>()) <span class="sc">*</span> <span class="fl">0.7</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">19</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>windGrplasso <span class="ot">=</span> <span class="fu">grplasso</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone<span class="sc">*</span>cols, <span class="at">data=</span>windComp<span class="sc">$</span>data,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda=</span>windLambdaTrain, <span class="at">subset=</span>isTest<span class="sc">==</span><span class="cn">FALSE</span>, <span class="at">model =</span> <span class="fu">PoissReg</span>())</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 556.505  nr.var: 16 </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 389.5535  nr.var: 31 </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 272.6875  nr.var: 61 </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 190.8812  nr.var: 61 </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 133.6169  nr.var: 61 </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 93.5318  nr.var: 61 </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 65.47226  nr.var: 91 </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 45.83058  nr.var: 91 </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 32.08141  nr.var: 93 </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 22.45699  nr.var: 93 </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 15.71989  nr.var: 93 </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 11.00392  nr.var: 93 </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 7.702746  nr.var: 95 </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 5.391922  nr.var: 96 </span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 3.774346  nr.var: 96 </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 2.642042  nr.var: 96 </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 1.849429  nr.var: 96 </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 1.294601  nr.var: 96 </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.9062204  nr.var: 96 </span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.6343543  nr.var: 96</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>prGrpTest <span class="ot">=</span> <span class="fu">predict</span>(windGrplasso,<span class="at">newdata=</span>windComp<span class="sc">$</span>data[isTest,], <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>predLLgrplasso <span class="ot">=</span> <span class="fu">colSums</span>(<span class="fu">dpois</span>(windComp<span class="sc">$</span>data<span class="sc">$</span>windMV[isTest], prGrpTest,<span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(windGrplasso<span class="sc">$</span>lambda,predLLgrplasso,<span class="at">log=</span><span class="st">&quot;x&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>isBestLambdaGrplasso <span class="ot">=</span> <span class="fu">which</span>(predLLgrplasso<span class="sc">==</span><span class="fu">max</span>(predLLgrplasso))</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(windGrplasso<span class="sc">$</span>lambda,<span class="fu">t</span>(windGrplasso<span class="sc">$</span>coefficients),<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">log=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(windGrplasso<span class="sc">$</span>lambda,<span class="fu">t</span>(windGrplasso<span class="sc">$</span>coefficients))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-15.5-comparing-predictive-likelihoods-for-the-wind-farm-data" class="section level2">
<h2>Exercise 15.5: Comparing predictive likelihoods for the wind farm data</h2>
<p><em>Compare the predictive log-likelihoods from Code Box 15.1 and Figures 15.1c-d. These models were all applied using the same test dataset. Which model seems to fit the data better? Why do you think this is?</em></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(predLogL),<span class="fu">sum</span>(predLogL_Int), <span class="fu">max</span>(predLLlasso), <span class="fu">max</span>(predLLgrplasso))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -830.5662 -832.3659 -742.8537 -743.9416</span></span></code></pre></div>
<p>The LASSO models fit way better, as expected. These models shrink parameters together, borrowing strength across taxa. The two LASSO fits did about as well as each other.</p>
</div>
<div id="code-box-15.5-reduced-rank-regression-for-the-wind-farm-data" class="section level2">
<h2>Code Box 15.5: Reduced rank regression for the wind farm data</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: stats4</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: splines</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;VGAM&#39;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:vegan&#39;:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     calibrate</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:psych&#39;:</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     fisherz, logistic, logit</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:coda&#39;:</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     nvar</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:glmmTMB&#39;:</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     betabinomial</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>wind_RR2<span class="ot">=</span><span class="fu">rrvglm</span>(<span class="fu">as.matrix</span>(windFarms<span class="sc">$</span>abund)<span class="sc">~</span>Year<span class="sc">*</span>Zone, <span class="at">family=</span>poissonff, <span class="at">data=</span>windFarms<span class="sc">$</span>X, <span class="at">Rank=</span><span class="dv">2</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>wind_manyglm <span class="ot">=</span> <span class="fu">manyglm</span>(windMV<span class="sc">~</span>Year<span class="sc">*</span>Zone, <span class="at">data=</span>windFarms<span class="sc">$</span>X, <span class="at">family=</span><span class="fu">poisson</span>())</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">BIC</span>(wind_RR2), <span class="fu">sum</span>(<span class="fu">BIC</span>(wind_manyglm)))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3318.548 3471.901</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>zoneyear <span class="ot">=</span> <span class="fu">interaction</span>(windFarms<span class="sc">$</span>X<span class="sc">$</span>Zone,windFarms<span class="sc">$</span>X<span class="sc">$</span>Year)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">as.numeric</span>(zoneyear),<span class="fu">latvar</span>(wind_RR2),<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>Which model fits better, according to BIC?</em></p>
<p>The reduced rank approach fits better.</p>
</div>
<div id="code-box-15.6-using-the-lasso-for-petruss-spider-data" class="section level2">
<h2>Code Box 15.6: Using the LASSO for Petrus’s spider data</h2>
<p><em>The below code chunk takes up to a minute to run so it has not been evaluated here to shorten vignette compilation time</em></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(spider)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>spid.trait <span class="ot">=</span> <span class="fu">traitglm</span>(spider<span class="sc">$</span>abund,spider<span class="sc">$</span>x,<span class="at">method=</span><span class="st">&quot;cv.glm1path&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">max</span>( <span class="fu">abs</span>(spid.trait<span class="sc">$</span>fourth.corner) )</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>colort <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plot<span class="fl">.4</span>th <span class="ot">=</span> <span class="fu">levelplot</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(spid.trait<span class="sc">$</span>fourth.corner)),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Environmental Variables&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Species&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">col.regions=</span><span class="fu">colort</span>(<span class="dv">100</span>), <span class="at">at=</span><span class="fu">seq</span>(<span class="sc">-</span>a, a, <span class="at">length=</span><span class="dv">100</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="at">scales =</span> <span class="fu">list</span>( <span class="at">x=</span> <span class="fu">list</span>(<span class="at">rot =</span> <span class="dv">45</span>)) )</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot<span class="fl">.4</span>th)</span></code></pre></div>
<p><em>Which environmental variables seem to have the strongest effect on spider abundances?</em></p>
<p><code>soil.dry</code> has some strongly negative coefficients, <code>fallen.leaves</code> and <code>herb.layer</code> also have some strong (but positive) interactions.</p>
</div>
<div id="code-box-15.7-mixed-model-prediction-of-spider-abundances" class="section level2">
<h2>Code Box 15.7: Mixed model prediction of spider abundances</h2>
<p><em>The below code chunk takes up to a minute to run so it has not been evaluated here to shorten vignette compilation time</em></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>spidXY <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(spider<span class="sc">$</span>x),spider<span class="sc">$</span>abund) <span class="co"># scale standardises data!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>spiderLong <span class="ot">=</span> <span class="fu">melt</span>(<span class="at">id=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,spidXY,<span class="at">variable.name=</span><span class="st">&quot;cols&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Xformula <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">colnames</span>(spider<span class="sc">$</span>x),<span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>fullFormula <span class="ot">=</span> <span class="fu">formula</span>(<span class="fu">paste0</span>(<span class="st">&quot;value~cols+&quot;</span>,Xformula,<span class="st">&quot;+(&quot;</span>,Xformula,<span class="st">&quot;|cols)&quot;</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>spid_glmm <span class="ot">=</span> <span class="fu">glmmTMB</span>(fullFormula,<span class="at">family=</span><span class="fu">nbinom2</span>(),<span class="at">data=</span>spiderLong)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spid_glmm)</span></code></pre></div>
<p>There are some convergence warnings here, which is fair enough because there are only 12 species but heaps of correlated terms in this model. Results seem to be reasonably stable on multiple runs, tweaking some settings, so we’ll go with this fit.</p>
<p><em>Which predictors seem to be most important to spider community composition?</em></p>
<p>The largest variance component, by some margin, is for <code>soil.dry</code> (about 1.8), followed by <code>herb.layer</code> and <code>reflection</code>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
